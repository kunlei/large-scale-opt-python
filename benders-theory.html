<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Hands-on Large Scale Optimization in Python - 4&nbsp; Benders Decomposition</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./env-setup.html" rel="prev">
<link href="./logo.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-XM4LXJY2KJ"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-XM4LXJY2KJ', { 'anonymize_ip': true});
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        TeX: { equationNumbers: {autoNumber: "AMS"} },
        tex2jax: {inlineMath: [ ['$','$'], ["\\(","\\)"] ]}
    });
    </script>

<!-- This is what works with Quarto -->
<script>
    MathJax = {
        tex: {
            tags: 'ams'  // should be 'ams', 'none', or 'all'
        }
    };
</script>
<script src="site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="site_libs/quarto-diagram/mermaid.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="twitter:title" content="Hands-on Large Scale Optimization in Python - 4&nbsp; Benders Decomposition">
<meta name="twitter:description" content="">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./benders-theory.html">Benders Decomposition</a></li><li class="breadcrumb-item"><a href="./benders-theory.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Benders Decomposition</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Hands-on Large Scale Optimization in Python</a> 
        <div class="sidebar-tools-main">
    <a href="https://twitter.com/intent/tweet?url=|url|" rel="" title="Twitter" class="quarto-navigation-tool px-1" aria-label="Twitter"><i class="bi bi-twitter"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Environment Setup</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./env-setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Environment Setup</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Benders Decomposition</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./benders-theory.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Benders Decomposition</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-decomposition-logic" id="toc-the-decomposition-logic" class="nav-link active" data-scroll-target="#the-decomposition-logic"><span class="header-section-number">4.1</span> The Decomposition Logic</a></li>
  <li><a href="#a-linear-programming-example" id="toc-a-linear-programming-example" class="nav-link" data-scroll-target="#a-linear-programming-example"><span class="header-section-number">4.2</span> A linear programming example</a>
  <ul class="collapse">
  <li><a href="#the-original-problem-and-its-optimal-solution" id="toc-the-original-problem-and-its-optimal-solution" class="nav-link" data-scroll-target="#the-original-problem-and-its-optimal-solution"><span class="header-section-number">4.2.1</span> The original problem and its optimal solution</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Benders Decomposition</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>In this chapter, we will explain the theories behind Benders decomposition and demonstrate its usage on a trial linear programming problem. Keep in mind that Benders decomposition is not limited to solving linear programming problems. In fact, it is one of the most powerful techniques to solve some large-scale mixed-integer linear programming problems.</p>
<p>In the following sections, we will go through the critical steps during the decomposition process when applying the algorithm on optimization problems represented in standard forms. This is important as it helps build up the intuition of when we should consider applying Benders decomposition to a problem at hand. Often times, recognizing the applicability of Benders decomposition is the most important and challenging step when solving an optimization problem. Once we know that the problem structure is suitable to solve via Benders decomposition, it is straightforward to follow the decomposition steps and put it into work.</p>
<p>Generally speaking, Benders decomposition is a good solution candidate when the resulting problem is much easier to solve if some of the variables in the original problem are fixed. We will illustrate this point using an example in the following sections. In the optimization world, the first candidate that should come to mind when we say a problem is easy to solve is a linear programming formulation, which is indeed the case in Benders decomposition applications.</p>
<section id="the-decomposition-logic" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="the-decomposition-logic"><span class="header-section-number">4.1</span> The Decomposition Logic</h2>
<p>To explain the reasoning of Benders decomposition, let us look at the standard form of linear programming problems that involve two vector variables, <span class="math inline">\(\mathbf{x}\)</span> and <span class="math inline">\(\mathbf{y}\)</span>. Let <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> indicate the dimensions of <span class="math inline">\(\mathbf{x}\)</span> and <span class="math inline">\(\mathbf{y}\)</span>, respectively. Below is the original problem <span class="math inline">\(\mathbf{P}\)</span> we intend to solve.</p>
<p><span class="math display">\[\begin{align}
&amp;(\mathbf{P}) &amp;\quad \text{min.} &amp;\quad \mathbf{c}^T \mathbf{x} + \mathbf{f}^T \mathbf{y} \\
&amp; &amp;\quad \text{s.t.} &amp;\quad \mathbf{A} \mathbf{x} + \mathbf{B} \mathbf{y} = \mathbf{b} \\
&amp; &amp;\quad &amp;\quad \mathbf{x} \geq 0, \mathbf{y} \geq 0
\end{align}\]</span></p>
<p>In this formulation, <span class="math inline">\(\mathbf{c}\)</span> and <span class="math inline">\(\mathbf{f}\)</span> in the objective function represent the cost coefficients associated with decision variables <span class="math inline">\(\mathbf{x}\)</span> and <span class="math inline">\(\mathbf{y}\)</span>, respectively. Both of them are column vectors of corresponding dimensions. In the constraints, matrix <span class="math inline">\(\mathbf{A}\)</span> is of dimension <span class="math inline">\(m \times p\)</span>, and matrix <span class="math inline">\(\mathbf{B}\)</span> is of dimension <span class="math inline">\(m \times q\)</span>. <span class="math inline">\(\mathbf{b}\)</span> is a column vector of dimension <span class="math inline">\(m\)</span>.</p>
<p>Suppose the variable <span class="math inline">\(\mathbf{y}\)</span> is a complicating variable in the sense that the resulting problem is substantially easier to solve if the value of <span class="math inline">\(\mathbf{y}\)</span> is fixed. In this case, we could rewrite problem <span class="math inline">\(\mathbf{P}\)</span> as the following form:</p>
<p><span class="math display">\[\begin{align}
\text{min.} &amp;\quad \mathbf{f}^T \mathbf{y} + g(\mathbf{y}) \\
\text{s.t.} &amp;\quad \mathbf{y} \geq 0
\end{align}\]</span></p>
<p>where <span class="math inline">\(g(\mathbf{y})\)</span> is a function of <span class="math inline">\(\mathbf{y}\)</span> and is defined as the subproblem <span class="math inline">\(\mathbf{SP}\)</span> of the form below:</p>
<p><span class="math display">\[\begin{align}
&amp;(\mathbf{SP}) &amp;\quad \text{min.} &amp;\quad \mathbf{c}^T \mathbf{x} \\
&amp; &amp;\quad \text{s.t.} &amp;\quad \mathbf{A} \mathbf{x}  = \mathbf{b} - \mathbf{B} \mathbf{y} \label{bd-cons1} \\
&amp; &amp;\quad &amp;\quad \mathbf{x} \geq 0
\end{align}\]</span></p>
<p>Note that the <span class="math inline">\(\mathbf{y}\)</span> in constraint <span class="math inline">\(\eqref{bd-cons1}\)</span> takes on some known values when the problem is solved and the only decision variable in the above formulation is <span class="math inline">\(\mathbf{x}\)</span>. The dual problem of <span class="math inline">\(\mathbf{SP}\)</span>, <span class="math inline">\(\mathbf{DSP}\)</span>, is given below.</p>
<p><span class="math display">\[\begin{align}
&amp;(\mathbf{DSP}) &amp;\quad \text{max.} &amp;\quad (\mathbf{b} - \mathbf{B} \mathbf{y})^{T} \mathbf{u} \\
&amp; &amp;\quad \text{s.t.} &amp;\quad \mathbf{A}^T \mathbf{u} \leq \mathbf{c} \label{bd-cons2} \\
&amp; &amp;\quad &amp;\quad \mathbf{u}\  \text{unrestricted}
\end{align}\]</span></p>
<p>A key characteristic of the above <span class="math inline">\(\mathbf{DSP}\)</span> is that its solution space does not depend on the value of <span class="math inline">\(\mathbf{y}\)</span>, which only affects the objective function. According to the Minkowski’s representation theorem, any <span class="math inline">\(\bar{\mathbf{u}}\)</span> satisfying the constraints <span class="math inline">\(\eqref{bd-cons2}\)</span> can be expressed as</p>
<p><span class="math display">\[\begin{align}
\bar{\mathbf{u}} = \sum_{j \in \mathbf{J}} \lambda_j \mathbf{u}_{j}^{point} + \sum_{k \in \mathbf{K}} \mu_k \mathbf{u}_k^{ray}
\end{align}\]</span></p>
<p>where <span class="math inline">\(\mathbf{u}_j^{point}\)</span> and <span class="math inline">\(\mathbf{u}_k^{ray}\)</span> represent an extreme point and extreme ray, respectively. In addition, <span class="math inline">\(\lambda_j \geq 0\)</span> for all <span class="math inline">\(j \in \mathbf{J}\)</span> and <span class="math inline">\(\sum_{j \in \mathbf{J}}\lambda_j = 1\)</span>, and <span class="math inline">\(\mu_k \geq 0\)</span> for all <span class="math inline">\(k \in \mathbf{K}\)</span>. It follows that the <span class="math inline">\(\mathbf{DSP}\)</span> is equivalent to</p>
<p><span class="math display">\[\begin{align}
\text{max.} &amp;\quad (\mathbf{b} - \mathbf{B} \mathbf{y})^{T} (\sum_{j \in \mathbf{J}} \lambda_j \mathbf{u}_{j}^{point} + \sum_{k \in \mathbf{K}} \mu_k \mathbf{u}_k^{ray}) \\
\text{s.t.} &amp;\quad \sum_{j \in \mathbf{J}}\lambda_j = 1 \\
&amp;\quad \lambda_j \geq 0, \ \forall j \in \mathbf{J} \\
&amp;\quad \mu_k \geq 0, \ \forall k \in \mathbf{K}
\end{align}\]</span></p>
<p>We can therefore conclude that</p>
<ul>
<li>The <span class="math inline">\(\mathbf{DSP}\)</span> becomes unbounded if any <span class="math inline">\(\mathbf{u}_k^{ray}\)</span> exists such that <span class="math inline">\((\mathbf{b} - \mathbf{B} \mathbf{y})^{T} \mathbf{u}_k^{ray} &gt; 0\)</span>. Note that an unbounded <span class="math inline">\(\mathbf{DSP}\)</span> implies an infeasible <span class="math inline">\(\mathbf{SP}\)</span> and to prevent this from happening, we have to ensure that <span class="math inline">\((\mathbf{b} - \mathbf{B} \mathbf{y})^{T} \mathbf{u}_k^{ray} \leq 0\)</span> for all <span class="math inline">\(k \in \mathbf{K}\)</span>.</li>
<li>If an optimal solution to <span class="math inline">\(\mathbf{DSP}\)</span> exists, it must occur at one of the extreme points. Let <span class="math inline">\(g\)</span> denote the optimal objective value, it follows that <span class="math inline">\((\mathbf{b} - \mathbf{B} \mathbf{y})^{T} \mathbf{u}_j^{point} \leq g\)</span> for all <span class="math inline">\(j \in \mathbf{J}\)</span>.</li>
</ul>
<p>Based on this idea, the <span class="math inline">\(\mathbf{DSP}\)</span> can be reformulated as follows:</p>
<p><span class="math display">\[\begin{align}
\text{min.} &amp;\quad g \\
\text{s.t.} &amp;\quad (\mathbf{b} - \mathbf{B} \mathbf{y})^{T} \mathbf{u}_k^{ray} \leq 0, \ \forall j \in \mathbf{J} \label{bd-feas} \\
&amp;\quad (\mathbf{b} - \mathbf{B} \mathbf{y})^{T} \mathbf{u}_j^{point} \leq g, \ \forall k \in \mathbf{K} \label{bd-opt} \\
&amp;\quad j \in \mathbf{J}, k \in \mathbf{K}
\end{align}\]</span></p>
<p>Constraints <span class="math inline">\(\eqref{bd-feas}\)</span> are called <strong>Benders feasibility cuts</strong>, while constraints <span class="math inline">\(\eqref{bd-opt}\)</span> are called <strong>Benders optimality cuts</strong>. Now we are ready to define the Benders Master Problem (<span class="math inline">\(\mathbf{BMP}\)</span>) as follows:</p>
<p><span class="math display">\[\begin{align}
&amp;(\mathbf{BMP}) &amp;\quad \text{min.} &amp;\quad \mathbf{f}^T \mathbf{y} + g \\
&amp; &amp;\quad \text{s.t.} &amp;\quad (\mathbf{b} - \mathbf{B} \mathbf{y})^{T} \mathbf{u}_k^{ray} \leq 0, \ \forall j \in \mathbf{J} \\
&amp; &amp;\quad &amp;\quad (\mathbf{b} - \mathbf{B} \mathbf{y})^{T} \mathbf{u}_j^{point} \leq g, \ \forall k \in \mathbf{K} \\
&amp; &amp;\quad &amp;\quad j \in \mathbf{J}, k \in \mathbf{K}, \mathbf{y} \geq 0
\end{align}\]</span></p>
<p>Typically <span class="math inline">\(J\)</span> and <span class="math inline">\(K\)</span> are too large to enumerate upfront and we have to work with subsets of them, denoted by <span class="math inline">\(J_s\)</span> and <span class="math inline">\(K_s\)</span>, respectively. Hence we have the following Restricted Benders Master Problem (<span class="math inline">\(\mathbf{RBMP}\)</span>):</p>
<p><span class="math display">\[\begin{align}
&amp;(\mathbf{RBMP}) &amp;\quad \text{min.} &amp;\quad \mathbf{f}^T \mathbf{y} + g \\
&amp; &amp;\quad \text{s.t.} &amp;\quad (\mathbf{b} - \mathbf{B} \mathbf{y})^{T} \mathbf{u}_k^{ray} \leq 0, \ \forall j \in \mathbf{J}_s \\
&amp; &amp;\quad &amp;\quad (\mathbf{b} - \mathbf{B} \mathbf{y})^{T} \mathbf{u}_j^{point} \leq g, \ \forall k \in \mathbf{K}_s \\
&amp; &amp;\quad &amp;\quad j \in \mathbf{J}, k \in \mathbf{K}, \mathbf{y} \geq 0
\end{align}\]</span></p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-benders-flowchart" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<div>
<pre class="mermaid mermaid-js" data-label="fig-benders-flowchart">flowchart LR
   A[Start] --&gt; B{Is}
    B --&gt;|Yes| C[OK]
    C --&gt; D[Rethink]
    D --&gt; B
    B ----&gt;|No| E[End]
</pre>
</div>
<figcaption class="figure-caption">Figure&nbsp;4.1: Benders decomposition workflow</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="a-linear-programming-example" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="a-linear-programming-example"><span class="header-section-number">4.2</span> A linear programming example</h2>
<p>In this section, we will first present a small linear programming problem and solve it directly using the Gurobi API in Python - <em>gurobipy</em>. Then we will demonstrate the Benders decomposition approach on this artificial problem. Lastly, we will provide an implementation to solve this problem in gurobipy.</p>
<section id="the-original-problem-and-its-optimal-solution" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="the-original-problem-and-its-optimal-solution"><span class="header-section-number">4.2.1</span> The original problem and its optimal solution</h3>
<p>The linear program we examine here is devoid of any practical meaning and is solely used to demonstrate the solution process of Benders decomposition. The problem is stated below, in which <span class="math inline">\(\mathbf{x} = (x_1, x_2, x_3)\)</span> and <span class="math inline">\(\mathbf{y} = (y_1, y_2)\)</span> are the decision variables. We assume that <span class="math inline">\(\mathbf{y}\)</span> is the complicating variable.</p>
<p><span class="math display">\[\begin{align*}
    \text{min.} &amp;\quad 8x_1 + 12x_2 +10x_3 + 15y_1 + 18y_2 \\
    \text{s.t.} &amp;\quad 2x_1 + 3x_2 + 2x_3 + 4y_1 + 5y_2 = 300 \\
    &amp;\quad 4x_1 + 2x_2 + 3x_3 + 2y_1 + 3y_2 = 228.75 \\
    &amp;\quad 1x_1 + 2x_2 + 1x_3 + 1.5y_1 + 2y_2 = 150 \\
    &amp;\quad 3x_1 + 2x_2 + 2x_3 + 1y_1 + 2y_2 = 180 \\
    &amp;\quad x_i \geq 0, \ \forall i = 1, \cdots, 3 \\
    &amp;\quad y_i \geq 0, \ \forall j = 1, 2
\end{align*}\]</span></p>
<p>In this example, <span class="math inline">\(\mathbf{c}^T = (8, 12, 10)\)</span>, <span class="math inline">\(\mathbf{f}^T = (15, 18)\)</span> and <span class="math inline">\(\mathbf{b}^T = (300, 228.75, 150, 180)\)</span>. In addition,</p>
<p><span class="math display">\[\begin{equation*}
\mathbf{A} =
\begin{bmatrix}
    2 &amp; 3 &amp; 2 \\
    4 &amp; 2 &amp; 3 \\
    1 &amp; 2 &amp; 1 \\
    3 &amp; 2 &amp; 2
\end{bmatrix}
\qquad
\mathbf{B} =
\begin{bmatrix}
    4 &amp; 5 \\
    2 &amp; 3 \\
    1.5 &amp; 2 \\
    1 &amp; 2
\end{bmatrix}
\end{equation*}\]</span></p>
<p>We first use Gurobi to identify its optimal solution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> gurobipy <span class="im">as</span> gp</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">from</span> gurobipy <span class="im">import</span> GRB</span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co"># Create a new model</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>env <span class="op">=</span> gp.Env(empty<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-6"><a href="#cb1-6"></a>env.setParam(<span class="st">'OutputFlag'</span>, <span class="dv">0</span>)</span>
<span id="cb1-7"><a href="#cb1-7"></a>env.start()</span>
<span id="cb1-8"><a href="#cb1-8"></a>model <span class="op">=</span> gp.Model(env<span class="op">=</span>env, name<span class="op">=</span><span class="st">"original_problem"</span>)</span>
<span id="cb1-9"><a href="#cb1-9"></a></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co"># Decision variables</span></span>
<span id="cb1-11"><a href="#cb1-11"></a>x1 <span class="op">=</span> model.addVar(vtype<span class="op">=</span>GRB.CONTINUOUS, name<span class="op">=</span><span class="st">'x1'</span>)</span>
<span id="cb1-12"><a href="#cb1-12"></a>x2 <span class="op">=</span> model.addVar(vtype<span class="op">=</span>GRB.CONTINUOUS, name<span class="op">=</span><span class="st">'x2'</span>)</span>
<span id="cb1-13"><a href="#cb1-13"></a>x3 <span class="op">=</span> model.addVar(vtype<span class="op">=</span>GRB.CONTINUOUS, name<span class="op">=</span><span class="st">'x3'</span>)</span>
<span id="cb1-14"><a href="#cb1-14"></a>y1 <span class="op">=</span> model.addVar(vtype<span class="op">=</span>GRB.CONTINUOUS, name<span class="op">=</span><span class="st">'y1'</span>)</span>
<span id="cb1-15"><a href="#cb1-15"></a>y2 <span class="op">=</span> model.addVar(vtype<span class="op">=</span>GRB.CONTINUOUS, name<span class="op">=</span><span class="st">'y2'</span>)</span>
<span id="cb1-16"><a href="#cb1-16"></a></span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="co"># Objective function</span></span>
<span id="cb1-18"><a href="#cb1-18"></a>model.setObjective(<span class="dv">8</span><span class="op">*</span>x1 <span class="op">+</span> <span class="dv">12</span><span class="op">*</span>x2 <span class="op">+</span> <span class="dv">10</span><span class="op">*</span>x3 <span class="op">+</span> <span class="dv">15</span><span class="op">*</span>y1 <span class="op">+</span> <span class="dv">18</span><span class="op">*</span>y2, </span>
<span id="cb1-19"><a href="#cb1-19"></a>                   GRB.MINIMIZE)</span>
<span id="cb1-20"><a href="#cb1-20"></a></span>
<span id="cb1-21"><a href="#cb1-21"></a><span class="co"># Constraints</span></span>
<span id="cb1-22"><a href="#cb1-22"></a>model.addConstr(<span class="dv">2</span><span class="op">*</span>x1 <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>x2 <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>x3 <span class="op">+</span> <span class="dv">4</span><span class="op">*</span>y1 <span class="op">+</span> <span class="dv">5</span><span class="op">*</span>y2 <span class="op">==</span> <span class="dv">300</span>)</span>
<span id="cb1-23"><a href="#cb1-23"></a>model.addConstr(<span class="dv">4</span><span class="op">*</span>x1 <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>x2 <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>x3 <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>y1 <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>y2 <span class="op">==</span> <span class="dv">220</span>)</span>
<span id="cb1-24"><a href="#cb1-24"></a><span class="co"># model.addConstr(1*x1 + 2*x2 + 1*x3 + 1.5*y1 + 2*y2 == 150)</span></span>
<span id="cb1-25"><a href="#cb1-25"></a><span class="co"># model.addConstr(3*x1 + 2*x2 + 2*x3 + 1*y1 + 2*y2 == 180)</span></span>
<span id="cb1-26"><a href="#cb1-26"></a></span>
<span id="cb1-27"><a href="#cb1-27"></a><span class="co"># Optimize the model</span></span>
<span id="cb1-28"><a href="#cb1-28"></a>model.optimize()</span>
<span id="cb1-29"><a href="#cb1-29"></a></span>
<span id="cb1-30"><a href="#cb1-30"></a><span class="co"># Print the results</span></span>
<span id="cb1-31"><a href="#cb1-31"></a><span class="cf">if</span> model.status <span class="op">==</span> GRB.OPTIMAL:</span>
<span id="cb1-32"><a href="#cb1-32"></a>    <span class="bu">print</span>(<span class="st">"Optimal solution found!"</span>)</span>
<span id="cb1-33"><a href="#cb1-33"></a>    <span class="bu">print</span>(<span class="ss">f'x1 = </span><span class="sc">{</span>x1<span class="sc">.</span>X<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb1-34"><a href="#cb1-34"></a>    <span class="bu">print</span>(<span class="ss">f'x2 = </span><span class="sc">{</span>x2<span class="sc">.</span>X<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb1-35"><a href="#cb1-35"></a>    <span class="bu">print</span>(<span class="ss">f'x3 = </span><span class="sc">{</span>x3<span class="sc">.</span>X<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb1-36"><a href="#cb1-36"></a>    <span class="bu">print</span>(<span class="ss">f'y1 = </span><span class="sc">{</span>y1<span class="sc">.</span>X<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb1-37"><a href="#cb1-37"></a>    <span class="bu">print</span>(<span class="ss">f'y2 = </span><span class="sc">{</span>y2<span class="sc">.</span>X<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb1-38"><a href="#cb1-38"></a>    <span class="bu">print</span>(<span class="ss">f"Total cost: </span><span class="sc">{</span>model<span class="sc">.</span>objVal<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb1-39"><a href="#cb1-39"></a><span class="cf">else</span>:</span>
<span id="cb1-40"><a href="#cb1-40"></a>    <span class="bu">print</span>(<span class="st">"No solution found."</span>)</span>
<span id="cb1-41"><a href="#cb1-41"></a></span>
<span id="cb1-42"><a href="#cb1-42"></a><span class="co"># Close the Gurobi environment</span></span>
<span id="cb1-43"><a href="#cb1-43"></a>model.dispose()</span>
<span id="cb1-44"><a href="#cb1-44"></a>env.dispose()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The optimal solution and objective value are as follows.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource {{python}} number-lines code-with-copy"><code class="sourceCode"><span id="cb2-1"><a href="#cb2-1"></a>Optimal solution found!</span>
<span id="cb2-2"><a href="#cb2-2"></a>x1 = 14.29</span>
<span id="cb2-3"><a href="#cb2-3"></a>x2 = 0.00</span>
<span id="cb2-4"><a href="#cb2-4"></a>x3 = 0.00</span>
<span id="cb2-5"><a href="#cb2-5"></a>y1 = 0.00</span>
<span id="cb2-6"><a href="#cb2-6"></a>y2 = 54.29</span>
<span id="cb2-7"><a href="#cb2-7"></a>Total cost: 1091.43</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./env-setup.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Environment Setup</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->



</body></html>