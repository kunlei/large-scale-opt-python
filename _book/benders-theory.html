<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Hands-on Large Scale Optimization in Python - 4&nbsp; Benders Decomposition</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./env-setup.html" rel="prev">
<link href="./logo.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-XM4LXJY2KJ"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-XM4LXJY2KJ', { 'anonymize_ip': true});
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        TeX: { equationNumbers: {autoNumber: "AMS"} },
        tex2jax: {inlineMath: [ ['$','$'], ["\\(","\\)"] ]}
    });
    </script>

<!-- This is what works with Quarto -->
<script>
    MathJax = {
        tex: {
            tags: 'ams'  // should be 'ams', 'none', or 'all'
        }
    };
</script>
<script src="site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="site_libs/quarto-diagram/mermaid.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="twitter:title" content="Hands-on Large Scale Optimization in Python - 4&nbsp; Benders Decomposition">
<meta name="twitter:description" content="">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./benders-theory.html">Benders Decomposition</a></li><li class="breadcrumb-item"><a href="./benders-theory.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Benders Decomposition</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Hands-on Large Scale Optimization in Python</a> 
        <div class="sidebar-tools-main">
    <a href="https://twitter.com/intent/tweet?url=|url|" rel="" title="Twitter" class="quarto-navigation-tool px-1" aria-label="Twitter"><i class="bi bi-twitter"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Environment Setup</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./env-setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Environment Setup</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Benders Decomposition</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./benders-theory.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Benders Decomposition</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-decomposition-logic" id="toc-the-decomposition-logic" class="nav-link active" data-scroll-target="#the-decomposition-logic"><span class="header-section-number">4.1</span> The Decomposition Logic</a></li>
  <li><a href="#solving-linear-programs" id="toc-solving-linear-programs" class="nav-link" data-scroll-target="#solving-linear-programs"><span class="header-section-number">4.2</span> Solving Linear Programs</a>
  <ul class="collapse">
  <li><a href="#solving-the-problem-as-a-whole" id="toc-solving-the-problem-as-a-whole" class="nav-link" data-scroll-target="#solving-the-problem-as-a-whole"><span class="header-section-number">4.2.1</span> Solving the problem as a whole</a></li>
  <li><a href="#the-original-problem-and-its-optimal-solution" id="toc-the-original-problem-and-its-optimal-solution" class="nav-link" data-scroll-target="#the-original-problem-and-its-optimal-solution"><span class="header-section-number">4.2.2</span> The original problem and its optimal solution</a></li>
  <li><a href="#benders-decomposition" id="toc-benders-decomposition" class="nav-link" data-scroll-target="#benders-decomposition"><span class="header-section-number">4.2.3</span> Benders decomposition</a></li>
  <li><a href="#solving-the-problem-step-by-step" id="toc-solving-the-problem-step-by-step" class="nav-link" data-scroll-target="#solving-the-problem-step-by-step"><span class="header-section-number">4.2.4</span> Solving the problem step by step</a></li>
  <li><a href="#putting-it-together" id="toc-putting-it-together" class="nav-link" data-scroll-target="#putting-it-together"><span class="header-section-number">4.2.5</span> Putting it together</a></li>
  <li><a href="#a-generic-solver" id="toc-a-generic-solver" class="nav-link" data-scroll-target="#a-generic-solver"><span class="header-section-number">4.2.6</span> A generic solver</a></li>
  <li><a href="#implementation-with-callbacks" id="toc-implementation-with-callbacks" class="nav-link" data-scroll-target="#implementation-with-callbacks"><span class="header-section-number">4.2.7</span> Implementation with callbacks</a></li>
  <li><a href="#implementation-with-scip" id="toc-implementation-with-scip" class="nav-link" data-scroll-target="#implementation-with-scip"><span class="header-section-number">4.2.8</span> Implementation with SCIP</a></li>
  <li><a href="#testing" id="toc-testing" class="nav-link" data-scroll-target="#testing"><span class="header-section-number">4.2.9</span> Testing</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Benders Decomposition</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>In this chapter, we will explain the theories behind Benders decomposition and demonstrate its usage on a trial linear programming problem. Keep in mind that Benders decomposition is not limited to solving linear programming problems. In fact, it is one of the most powerful techniques to solve some large-scale mixed-integer linear programming problems.</p>
<p>In the following sections, we will go through the critical steps during the decomposition process when applying the algorithm on optimization problems represented in standard forms. This is important as it helps build up the intuition of when we should consider applying Benders decomposition to a problem at hand. Often times, recognizing the applicability of Benders decomposition is the most important and challenging step when solving an optimization problem. Once we know that the problem structure is suitable to solve via Benders decomposition, it is straightforward to follow the decomposition steps and put it into work.</p>
<p>Generally speaking, Benders decomposition is a good solution candidate when the resulting problem is much easier to solve if some of the variables in the original problem are fixed. We will illustrate this point using an example in the following sections. In the optimization world, the first candidate that should come to mind when we say a problem is easy to solve is a linear programming formulation, which is indeed the case in Benders decomposition applications.</p>
<section id="the-decomposition-logic" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="the-decomposition-logic"><span class="header-section-number">4.1</span> The Decomposition Logic</h2>
<p>To explain the reasoning of Benders decomposition, let us look at the standard form of linear programming problems that involve two vector variables, <span class="math inline">\(\mathbf{x}\)</span> and <span class="math inline">\(\mathbf{y}\)</span>. Let <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> indicate the dimensions of <span class="math inline">\(\mathbf{x}\)</span> and <span class="math inline">\(\mathbf{y}\)</span>, respectively. Below is the original problem <span class="math inline">\(\mathbf{P}\)</span> we intend to solve.</p>
<p><span class="math display">\[\begin{align}
&amp;(\mathbf{P}) &amp;\quad \text{min.} &amp;\quad \mathbf{c}^T \mathbf{x} + \mathbf{f}^T \mathbf{y} \\
&amp; &amp;\quad \text{s.t.} &amp;\quad \mathbf{A} \mathbf{x} + \mathbf{B} \mathbf{y} = \mathbf{b} \\
&amp; &amp;\quad &amp;\quad \mathbf{x} \geq 0, \mathbf{y} \geq 0
\end{align}\]</span></p>
<p>In this formulation, <span class="math inline">\(\mathbf{c}\)</span> and <span class="math inline">\(\mathbf{f}\)</span> in the objective function represent the cost coefficients associated with decision variables <span class="math inline">\(\mathbf{x}\)</span> and <span class="math inline">\(\mathbf{y}\)</span>, respectively. Both of them are column vectors of corresponding dimensions. In the constraints, matrix <span class="math inline">\(\mathbf{A}\)</span> is of dimension <span class="math inline">\(m \times p\)</span>, and matrix <span class="math inline">\(\mathbf{B}\)</span> is of dimension <span class="math inline">\(m \times q\)</span>. <span class="math inline">\(\mathbf{b}\)</span> is a column vector of dimension <span class="math inline">\(m\)</span>.</p>
<p>Suppose the variable <span class="math inline">\(\mathbf{y}\)</span> is a complicating variable in the sense that the resulting problem is substantially easier to solve if the value of <span class="math inline">\(\mathbf{y}\)</span> is fixed. In this case, we could rewrite problem <span class="math inline">\(\mathbf{P}\)</span> as the following form:</p>
<p><span class="math display">\[\begin{align}
\text{min.} &amp;\quad \mathbf{f}^T \mathbf{y} + g(\mathbf{y}) \\
\text{s.t.} &amp;\quad \mathbf{y} \geq 0
\end{align}\]</span></p>
<p>where <span class="math inline">\(g(\mathbf{y})\)</span> is a function of <span class="math inline">\(\mathbf{y}\)</span> and is defined as the subproblem <span class="math inline">\(\mathbf{SP}\)</span> of the form below:</p>
<p><span class="math display">\[\begin{align}
&amp;(\mathbf{SP}) &amp;\quad \text{min.} &amp;\quad \mathbf{c}^T \mathbf{x} \\
&amp; &amp;\quad \text{s.t.} &amp;\quad \mathbf{A} \mathbf{x}  = \mathbf{b} - \mathbf{B} \mathbf{y} \label{bd-cons1} \\
&amp; &amp;\quad &amp;\quad \mathbf{x} \geq 0
\end{align}\]</span></p>
<p>Note that the <span class="math inline">\(\mathbf{y}\)</span> in constraint <span class="math inline">\(\eqref{bd-cons1}\)</span> takes on some known values when the problem is solved and the only decision variable in the above formulation is <span class="math inline">\(\mathbf{x}\)</span>. The dual problem of <span class="math inline">\(\mathbf{SP}\)</span>, <span class="math inline">\(\mathbf{DSP}\)</span>, is given below.</p>
<p><span class="math display">\[\begin{align}
&amp;(\mathbf{DSP}) &amp;\quad \text{max.} &amp;\quad (\mathbf{b} - \mathbf{B} \mathbf{y})^{T} \mathbf{u} \\
&amp; &amp;\quad \text{s.t.} &amp;\quad \mathbf{A}^T \mathbf{u} \leq \mathbf{c} \label{bd-cons2} \\
&amp; &amp;\quad &amp;\quad \mathbf{u}\  \text{unrestricted}
\end{align}\]</span></p>
<p>A key characteristic of the above <span class="math inline">\(\mathbf{DSP}\)</span> is that its solution space does not depend on the value of <span class="math inline">\(\mathbf{y}\)</span>, which only affects the objective function. According to the Minkowskiâ€™s representation theorem, any <span class="math inline">\(\bar{\mathbf{u}}\)</span> satisfying the constraints <span class="math inline">\(\eqref{bd-cons2}\)</span> can be expressed as</p>
<p><span class="math display">\[\begin{align}
\bar{\mathbf{u}} = \sum_{j \in \mathbf{J}} \lambda_j \mathbf{u}_{j}^{point} + \sum_{k \in \mathbf{K}} \mu_k \mathbf{u}_k^{ray}
\end{align}\]</span></p>
<p>where <span class="math inline">\(\mathbf{u}_j^{point}\)</span> and <span class="math inline">\(\mathbf{u}_k^{ray}\)</span> represent an extreme point and extreme ray, respectively. In addition, <span class="math inline">\(\lambda_j \geq 0\)</span> for all <span class="math inline">\(j \in \mathbf{J}\)</span> and <span class="math inline">\(\sum_{j \in \mathbf{J}}\lambda_j = 1\)</span>, and <span class="math inline">\(\mu_k \geq 0\)</span> for all <span class="math inline">\(k \in \mathbf{K}\)</span>. It follows that the <span class="math inline">\(\mathbf{DSP}\)</span> is equivalent to</p>
<p><span class="math display">\[\begin{align}
\text{max.} &amp;\quad (\mathbf{b} - \mathbf{B} \mathbf{y})^{T} (\sum_{j \in \mathbf{J}} \lambda_j \mathbf{u}_{j}^{point} + \sum_{k \in \mathbf{K}} \mu_k \mathbf{u}_k^{ray}) \\
\text{s.t.} &amp;\quad \sum_{j \in \mathbf{J}}\lambda_j = 1 \\
&amp;\quad \lambda_j \geq 0, \ \forall j \in \mathbf{J} \\
&amp;\quad \mu_k \geq 0, \ \forall k \in \mathbf{K}
\end{align}\]</span></p>
<p>We can therefore conclude that</p>
<ul>
<li>The <span class="math inline">\(\mathbf{DSP}\)</span> becomes unbounded if any <span class="math inline">\(\mathbf{u}_k^{ray}\)</span> exists such that <span class="math inline">\((\mathbf{b} - \mathbf{B} \mathbf{y})^{T} \mathbf{u}_k^{ray} &gt; 0\)</span>. Note that an unbounded <span class="math inline">\(\mathbf{DSP}\)</span> implies an infeasible <span class="math inline">\(\mathbf{SP}\)</span> and to prevent this from happening, we have to ensure that <span class="math inline">\((\mathbf{b} - \mathbf{B} \mathbf{y})^{T} \mathbf{u}_k^{ray} \leq 0\)</span> for all <span class="math inline">\(k \in \mathbf{K}\)</span>.</li>
<li>If an optimal solution to <span class="math inline">\(\mathbf{DSP}\)</span> exists, it must occur at one of the extreme points. Let <span class="math inline">\(g\)</span> denote the optimal objective value, it follows that <span class="math inline">\((\mathbf{b} - \mathbf{B} \mathbf{y})^{T} \mathbf{u}_j^{point} \leq g\)</span> for all <span class="math inline">\(j \in \mathbf{J}\)</span>.</li>
</ul>
<p>Based on this idea, the <span class="math inline">\(\mathbf{DSP}\)</span> can be reformulated as follows:</p>
<p><span class="math display">\[\begin{align}
\text{min.} &amp;\quad g \\
\text{s.t.} &amp;\quad (\mathbf{b} - \mathbf{B} \mathbf{y})^{T} \mathbf{u}_k^{ray} \leq 0, \ \forall j \in \mathbf{J} \label{bd-feas} \\
&amp;\quad (\mathbf{b} - \mathbf{B} \mathbf{y})^{T} \mathbf{u}_j^{point} \leq g, \ \forall k \in \mathbf{K} \label{bd-opt} \\
&amp;\quad j \in \mathbf{J}, k \in \mathbf{K}
\end{align}\]</span></p>
<p>Constraints <span class="math inline">\(\eqref{bd-feas}\)</span> are called <strong>Benders feasibility cuts</strong>, while constraints <span class="math inline">\(\eqref{bd-opt}\)</span> are called <strong>Benders optimality cuts</strong>. Now we are ready to define the Benders Master Problem (<span class="math inline">\(\mathbf{BMP}\)</span>) as follows:</p>
<p><span class="math display">\[\begin{align}
&amp;(\mathbf{BMP}) &amp;\quad \text{min.} &amp;\quad \mathbf{f}^T \mathbf{y} + g \\
&amp; &amp;\quad \text{s.t.} &amp;\quad (\mathbf{b} - \mathbf{B} \mathbf{y})^{T} \mathbf{u}_k^{ray} \leq 0, \ \forall j \in \mathbf{J} \\
&amp; &amp;\quad &amp;\quad (\mathbf{b} - \mathbf{B} \mathbf{y})^{T} \mathbf{u}_j^{point} \leq g, \ \forall k \in \mathbf{K} \\
&amp; &amp;\quad &amp;\quad j \in \mathbf{J}, k \in \mathbf{K}, \mathbf{y} \geq 0
\end{align}\]</span></p>
<p>Typically <span class="math inline">\(J\)</span> and <span class="math inline">\(K\)</span> are too large to enumerate upfront and we have to work with subsets of them, denoted by <span class="math inline">\(J_s\)</span> and <span class="math inline">\(K_s\)</span>, respectively. Hence we have the following Restricted Benders Master Problem (<span class="math inline">\(\mathbf{RBMP}\)</span>):</p>
<p><span class="math display">\[\begin{align}
&amp;(\mathbf{RBMP}) &amp;\quad \text{min.} &amp;\quad \mathbf{f}^T \mathbf{y} + g \\
&amp; &amp;\quad \text{s.t.} &amp;\quad (\mathbf{b} - \mathbf{B} \mathbf{y})^{T} \mathbf{u}_k^{ray} \leq 0, \ \forall j \in \mathbf{J}_s \\
&amp; &amp;\quad &amp;\quad (\mathbf{b} - \mathbf{B} \mathbf{y})^{T} \mathbf{u}_j^{point} \leq g, \ \forall k \in \mathbf{K}_s \\
&amp; &amp;\quad &amp;\quad j \in \mathbf{J}, k \in \mathbf{K}, \mathbf{y} \geq 0
\end{align}\]</span></p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-benders-flowchart" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<div>
<pre class="mermaid mermaid-js" data-label="fig-benders-flowchart">flowchart LR
   A[Start] --&gt; B{Is}
    B --&gt;|Yes| C[OK]
    C --&gt; D[Rethink]
    D --&gt; B
    B ----&gt;|No| E[End]
</pre>
</div>
<figcaption class="figure-caption">Figure&nbsp;4.1: Benders decomposition workflow</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="solving-linear-programs" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="solving-linear-programs"><span class="header-section-number">4.2</span> Solving Linear Programs</h2>
<p>In this section, we will first present a small linear programming problem and solve it directly using the Gurobi API in Python - <em>gurobipy</em>. Then we will demonstrate the Benders decomposition approach on this artificial problem. Lastly, we will provide an implementation to solve this problem in gurobipy.</p>
<section id="solving-the-problem-as-a-whole" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="solving-the-problem-as-a-whole"><span class="header-section-number">4.2.1</span> Solving the problem as a whole</h3>
<div class="cell" data-execution_count="162">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> gurobipy <span class="im">as</span> gp</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">from</span> gurobipy <span class="im">import</span> GRB</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="im">import</span> scipy.sparse <span class="im">as</span> sp</span>
<span id="cb1-5"><a href="#cb1-5"></a></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="kw">class</span> LpSolverGurobi:</span>
<span id="cb1-7"><a href="#cb1-7"></a>    </span>
<span id="cb1-8"><a href="#cb1-8"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, obj_coeff, constr_mat, rhs):</span>
<span id="cb1-9"><a href="#cb1-9"></a>        <span class="va">self</span>._env <span class="op">=</span> gp.Env(<span class="st">'GurobiEnv'</span>)</span>
<span id="cb1-10"><a href="#cb1-10"></a>        <span class="va">self</span>._model <span class="op">=</span> gp.Model(env<span class="op">=</span><span class="va">self</span>._env, name<span class="op">=</span><span class="st">'GurobiLpSolver'</span>)</span>
<span id="cb1-11"><a href="#cb1-11"></a>        </span>
<span id="cb1-12"><a href="#cb1-12"></a>        <span class="co"># prepare data</span></span>
<span id="cb1-13"><a href="#cb1-13"></a>        <span class="va">self</span>._obj_coeff <span class="op">=</span> obj_coeff</span>
<span id="cb1-14"><a href="#cb1-14"></a>        <span class="bu">print</span>(<span class="va">self</span>._obj_coeff)</span>
<span id="cb1-15"><a href="#cb1-15"></a>        <span class="va">self</span>._constr_mat <span class="op">=</span> constr_mat</span>
<span id="cb1-16"><a href="#cb1-16"></a>        <span class="bu">print</span>(<span class="va">self</span>._constr_mat)</span>
<span id="cb1-17"><a href="#cb1-17"></a>        <span class="va">self</span>._rhs <span class="op">=</span> rhs</span>
<span id="cb1-18"><a href="#cb1-18"></a>        <span class="va">self</span>._num_vars <span class="op">=</span> <span class="bu">len</span>(<span class="va">self</span>._obj_coeff)</span>
<span id="cb1-19"><a href="#cb1-19"></a>        <span class="va">self</span>._num_constrs <span class="op">=</span> <span class="bu">len</span>(<span class="va">self</span>._rhs)</span>
<span id="cb1-20"><a href="#cb1-20"></a>        </span>
<span id="cb1-21"><a href="#cb1-21"></a>        <span class="co"># create decision variables</span></span>
<span id="cb1-22"><a href="#cb1-22"></a>        <span class="va">self</span>._vars <span class="op">=</span> <span class="va">self</span>._model.addMVar(<span class="va">self</span>._num_vars, vtype<span class="op">=</span>GRB.CONTINUOUS, lb<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb1-23"><a href="#cb1-23"></a>        </span>
<span id="cb1-24"><a href="#cb1-24"></a>        <span class="co"># create constraints</span></span>
<span id="cb1-25"><a href="#cb1-25"></a>        <span class="va">self</span>._constrs <span class="op">=</span> <span class="va">self</span>._model.addConstr(<span class="va">self</span>._constr_mat<span class="op">@</span>self._vars <span class="op">==</span> <span class="va">self</span>._rhs)</span>
<span id="cb1-26"><a href="#cb1-26"></a>        </span>
<span id="cb1-27"><a href="#cb1-27"></a>        <span class="co"># create objective</span></span>
<span id="cb1-28"><a href="#cb1-28"></a>        <span class="va">self</span>._model.setObjective(<span class="va">self</span>._obj_coeff <span class="op">@</span> <span class="va">self</span>._vars, GRB.MINIMIZE)</span>
<span id="cb1-29"><a href="#cb1-29"></a>    </span>
<span id="cb1-30"><a href="#cb1-30"></a>    <span class="kw">def</span> optimize(<span class="va">self</span>):</span>
<span id="cb1-31"><a href="#cb1-31"></a>        <span class="va">self</span>._model.update()</span>
<span id="cb1-32"><a href="#cb1-32"></a>        <span class="bu">print</span>(<span class="va">self</span>._model.display())</span>
<span id="cb1-33"><a href="#cb1-33"></a>        <span class="va">self</span>._model.optimize()</span>
<span id="cb1-34"><a href="#cb1-34"></a>    </span>
<span id="cb1-35"><a href="#cb1-35"></a>    <span class="kw">def</span> clean_up(<span class="va">self</span>):</span>
<span id="cb1-36"><a href="#cb1-36"></a>        <span class="va">self</span>._model.dispose()</span>
<span id="cb1-37"><a href="#cb1-37"></a>        <span class="va">self</span>._env.dispose()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="179">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="im">import</span> pyscipopt <span class="im">as</span> scip</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="im">from</span> pyscipopt <span class="im">import</span> SCIP_PARAMSETTING</span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="kw">class</span> LpSolverSCIP:</span>
<span id="cb2-5"><a href="#cb2-5"></a>    </span>
<span id="cb2-6"><a href="#cb2-6"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, obj_coeff, constr_mat, rhs):</span>
<span id="cb2-7"><a href="#cb2-7"></a>        <span class="va">self</span>._model <span class="op">=</span> scip.Model(<span class="st">'LpModel'</span>)</span>
<span id="cb2-8"><a href="#cb2-8"></a>    </span>
<span id="cb2-9"><a href="#cb2-9"></a>        <span class="co"># create variables</span></span>
<span id="cb2-10"><a href="#cb2-10"></a>        <span class="va">self</span>._vars <span class="op">=</span> {</span>
<span id="cb2-11"><a href="#cb2-11"></a>            i: <span class="va">self</span>._model.addVar(lb<span class="op">=</span><span class="dv">0</span>, vtype<span class="op">=</span><span class="st">'C'</span>, name<span class="op">=</span><span class="ss">f'var_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb2-12"><a href="#cb2-12"></a>            <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(obj_coeff))</span>
<span id="cb2-13"><a href="#cb2-13"></a>        }</span>
<span id="cb2-14"><a href="#cb2-14"></a>        </span>
<span id="cb2-15"><a href="#cb2-15"></a>        <span class="co"># create constraints</span></span>
<span id="cb2-16"><a href="#cb2-16"></a>        <span class="cf">for</span> c <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(rhs)):</span>
<span id="cb2-17"><a href="#cb2-17"></a>            expr <span class="op">=</span> [</span>
<span id="cb2-18"><a href="#cb2-18"></a>                constr_mat[c][j] <span class="op">*</span> <span class="va">self</span>._vars.get(j)</span>
<span id="cb2-19"><a href="#cb2-19"></a>                <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(obj_coeff))</span>
<span id="cb2-20"><a href="#cb2-20"></a>            ]</span>
<span id="cb2-21"><a href="#cb2-21"></a>            <span class="va">self</span>._model.addCons(scip.quicksum(expr) <span class="op">==</span> rhs[c])</span>
<span id="cb2-22"><a href="#cb2-22"></a>            </span>
<span id="cb2-23"><a href="#cb2-23"></a>        <span class="co"># create objective</span></span>
<span id="cb2-24"><a href="#cb2-24"></a>        obj_expr <span class="op">=</span> [</span>
<span id="cb2-25"><a href="#cb2-25"></a>            obj_coeff[i] <span class="op">*</span> <span class="va">self</span>._vars.get(i)</span>
<span id="cb2-26"><a href="#cb2-26"></a>            <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(obj_coeff))</span>
<span id="cb2-27"><a href="#cb2-27"></a>        ]</span>
<span id="cb2-28"><a href="#cb2-28"></a>        <span class="va">self</span>._model.setObjective(scip.quicksum(obj_expr), <span class="st">"minimize"</span>)</span>
<span id="cb2-29"><a href="#cb2-29"></a>    </span>
<span id="cb2-30"><a href="#cb2-30"></a>    <span class="kw">def</span> optimize(<span class="va">self</span>):</span>
<span id="cb2-31"><a href="#cb2-31"></a>        <span class="va">self</span>._model.optimize()</span>
<span id="cb2-32"><a href="#cb2-32"></a>        <span class="cf">pass</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="166">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="im">import</span> gurobipy <span class="im">as</span> gp</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="im">from</span> gurobipy <span class="im">import</span> GRB</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-4"><a href="#cb3-4"></a></span>
<span id="cb3-5"><a href="#cb3-5"></a>np.random.seed(<span class="dv">142</span>)</span>
<span id="cb3-6"><a href="#cb3-6"></a>c <span class="op">=</span> np.random.randint(<span class="dv">2</span>, <span class="dv">6</span>, size<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb3-7"><a href="#cb3-7"></a>f <span class="op">=</span> np.random.randint(<span class="dv">1</span>, <span class="dv">15</span>, size<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb3-8"><a href="#cb3-8"></a>A <span class="op">=</span> np.random.randint(<span class="dv">2</span>, <span class="dv">6</span>, size<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">20</span>))</span>
<span id="cb3-9"><a href="#cb3-9"></a>B <span class="op">=</span> np.random.randint(<span class="dv">2</span>, <span class="dv">26</span>, size<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">10</span>))</span>
<span id="cb3-10"><a href="#cb3-10"></a>b <span class="op">=</span> np.random.randint(<span class="dv">20</span>, <span class="dv">50</span>, size<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb3-11"><a href="#cb3-11"></a></span>
<span id="cb3-12"><a href="#cb3-12"></a>obj_coeff <span class="op">=</span> np.concatenate((c, f))</span>
<span id="cb3-13"><a href="#cb3-13"></a>constr_mat <span class="op">=</span> np.concatenate((A, B), axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb3-14"><a href="#cb3-14"></a>rhs <span class="op">=</span> b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="167">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a>lpsolver_gurobi <span class="op">=</span> LpSolverGurobi(obj_coeff<span class="op">=</span>obj_coeff, constr_mat<span class="op">=</span>constr_mat, rhs<span class="op">=</span>rhs)</span>
<span id="cb4-2"><a href="#cb4-2"></a>lpsolver_gurobi.optimize()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Set parameter Username
Set parameter LogFile to value "GurobiEnv"
[ 3  3  5  5  2  4  3  2  3  3  4  2  5  5  2  5  4  4  5  5  3  6  8 12
  3  5  4  4  9  3]
[[ 2  4  3  5  5  2  5  4  5  3  3  4  2  2  2  2  3  2  3  3 11 11 25 20
   9  5  7  8  9  2]
 [ 5  2  2  4  3  5  4  2  3  5  4  3  2  5  2  3  5  4  5  4 23 19 23 19
  12 12 13 15 19 19]
 [ 2  3  2  2  5  5  4  5  5  2  5  2  5  4  5  4  3  5  3  3 11 10  8 20
  17  9 25 25 10 12]
 [ 3  5  4  3  4  2  4  2  4  2  4  2  3  3  2  5  3  2  4  2 16 23 18 20
  20 25 14 10  2  6]
 [ 5  4  3  4  3  4  5  4  4  2  5  4  2  3  2  2  5  2  4  3  3  8 10  4
  22 25 11 15 15  9]
 [ 5  5  5  3  2  5  2  2  3  4  2  5  4  4  2  5  4  5  5  4 21 14 22 19
  15 19 16  8 22 23]
 [ 4  2  2  5  2  5  5  4  2  3  2  3  2  5  4  3  3  4  5  3 18  8 11  2
  19 23 23  8 18 25]
 [ 3  2  4  5  3  2  3  5  3  4  5  2  5  4  2  4  2  4  3  5 20 19 13 24
  19  7  4 15 24  3]
 [ 4  4  2  3  2  2  5  5  2  3  5  5  4  5  3  4  2  2  4  2 19  6 20 16
   5 14 20 18 19  6]
 [ 4  2  3  4  4  4  2  5  2  5  5  2  3  4  4  5  4  4  2  3 25 11 17 14
  15 12  6 23 24  6]
 [ 3  5  2  5  3  2  3  3  5  5  3  2  5  3  4  3  5  5  4  4  3 23  9 16
  22  3 14 16 12 16]
 [ 2  3  4  3  5  5  3  5  4  4  2  5  4  3  5  2  3  4  5  4 13 11  7  2
  15 24 13 16  4  6]
 [ 4  4  2  2  4  4  3  2  2  2  5  5  2  5  3  3  5  2  4  3  9 13 10 16
  25 16 24 21  6 16]
 [ 3  5  5  4  3  2  3  5  2  3  5  3  5  3  3  3  5  5  5  5  3 20  5 18
   8 19 25  2 17  7]
 [ 3  2  5  2  2  3  3  3  4  3  5  5  4  4  4  3  3  4  4  4  9 15  6 23
  14 21 21 22 18 22]
 [ 3  2  2  3  4  3  2  4  5  3  2  2  2  3  5  3  2  2  4  4 19 17 17 17
   4 22 12 18  4 18]
 [ 4  2  2  5  2  3  5  4  2  3  2  5  5  5  5  4  4  4  2  5  2 13 23  8
  22 17 10 24 20 23]
 [ 2  4  2  3  2  2  2  4  4  5  2  4  4  4  2  4  3  4  5  3 10  6 20 21
  16 15 13  3 24 16]
 [ 2  5  4  3  3  3  4  2  5  4  2  4  5  2  2  2  3  5  4  5 12 18 21  8
  19  8 11 20 21 21]
 [ 4  2  2  2  2  2  4  3  4  3  2  2  4  2  4  3  5  2  4  3 11  4  2  9
  13 20 23 16 16 14]]
Minimize
3.0 C0 + 3.0 C1 + 5.0 C2 + 5.0 C3 + 2.0 C4 + 4.0 C5 + 3.0 C6 + 2.0 C7 + 3.0 C8
+ 3.0 C9 + 4.0 C10 + 2.0 C11 + 5.0 C12 + 5.0 C13 + 2.0 C14 + 5.0 C15 + 4.0 C16 + 4.0 C17
+ 5.0 C18 + 5.0 C19 + 3.0 C20 + 6.0 C21 + 8.0 C22 + 12.0 C23 + 3.0 C24 + 5.0 C25
+ 4.0 C26 + 4.0 C27 + 9.0 C28 + 3.0 C29
Subject To
R0: 2.0 C0 + 4.0 C1 + 3.0 C2 + 5.0 C3 + 5.0 C4 + 2.0 C5 + 5.0 C6 + 4.0 C7 + 5.0 C8 +
3.0 C9 + 3.0 C10 + 4.0 C11 + 2.0 C12 + 2.0 C13 + 2.0 C14 + 2.0 C15 + 3.0 C16 + 2.0 C17 +
3.0 C18 + 3.0 C19 + 11.0 C20 + 11.0 C21 + 25.0 C22 + 20.0 C23 + 9.0 C24 + 5.0 C25 + 7.0
 C26 + 8.0 C27 + 9.0 C28 + 2.0 C29 = 21
R1: 5.0 C0 + 2.0 C1 + 2.0 C2 + 4.0 C3 + 3.0 C4 + 5.0 C5 + 4.0 C6 + 2.0 C7 + 3.0 C8 +
5.0 C9 + 4.0 C10 + 3.0 C11 + 2.0 C12 + 5.0 C13 + 2.0 C14 + 3.0 C15 + 5.0 C16 + 4.0 C17 +
5.0 C18 + 4.0 C19 + 23.0 C20 + 19.0 C21 + 23.0 C22 + 19.0 C23 + 12.0 C24 + 12.0 C25 +
 13.0 C26 + 15.0 C27 + 19.0 C28 + 19.0 C29 = 26
R2: 2.0 C0 + 3.0 C1 + 2.0 C2 + 2.0 C3 + 5.0 C4 + 5.0 C5 + 4.0 C6 + 5.0 C7 + 5.0 C8 +
2.0 C9 + 5.0 C10 + 2.0 C11 + 5.0 C12 + 4.0 C13 + 5.0 C14 + 4.0 C15 + 3.0 C16 + 5.0 C17 +
3.0 C18 + 3.0 C19 + 11.0 C20 + 10.0 C21 + 8.0 C22 + 20.0 C23 + 17.0 C24 + 9.0 C25 + 25.0
 C26 + 25.0 C27 + 10.0 C28 + 12.0 C29 = 38
R3: 3.0 C0 + 5.0 C1 + 4.0 C2 + 3.0 C3 + 4.0 C4 + 2.0 C5 + 4.0 C6 + 2.0 C7 + 4.0 C8 +
2.0 C9 + 4.0 C10 + 2.0 C11 + 3.0 C12 + 3.0 C13 + 2.0 C14 + 5.0 C15 + 3.0 C16 + 2.0 C17 +
4.0 C18 + 2.0 C19 + 16.0 C20 + 23.0 C21 + 18.0 C22 + 20.0 C23 + 20.0 C24 + 25.0 C25 +
 14.0 C26 + 10.0 C27 + 2.0 C28 + 6.0 C29 = 42
R4: 5.0 C0 + 4.0 C1 + 3.0 C2 + 4.0 C3 + 3.0 C4 + 4.0 C5 + 5.0 C6 + 4.0 C7 + 4.0 C8 +
2.0 C9 + 5.0 C10 + 4.0 C11 + 2.0 C12 + 3.0 C13 + 2.0 C14 + 2.0 C15 + 5.0 C16 + 2.0 C17 +
4.0 C18 + 3.0 C19 + 3.0 C20 + 8.0 C21 + 10.0 C22 + 4.0 C23 + 22.0 C24 + 25.0 C25 + 11.0
 C26 + 15.0 C27 + 15.0 C28 + 9.0 C29 = 35
R5: 5.0 C0 + 5.0 C1 + 5.0 C2 + 3.0 C3 + 2.0 C4 + 5.0 C5 + 2.0 C6 + 2.0 C7 + 3.0 C8 +
4.0 C9 + 2.0 C10 + 5.0 C11 + 4.0 C12 + 4.0 C13 + 2.0 C14 + 5.0 C15 + 4.0 C16 + 5.0 C17 +
5.0 C18 + 4.0 C19 + 21.0 C20 + 14.0 C21 + 22.0 C22 + 19.0 C23 + 15.0 C24 + 19.0 C25 +
 16.0 C26 + 8.0 C27 + 22.0 C28 + 23.0 C29 = 37
R6: 4.0 C0 + 2.0 C1 + 2.0 C2 + 5.0 C3 + 2.0 C4 + 5.0 C5 + 5.0 C6 + 4.0 C7 + 2.0 C8 +
3.0 C9 + 2.0 C10 + 3.0 C11 + 2.0 C12 + 5.0 C13 + 4.0 C14 + 3.0 C15 + 3.0 C16 + 4.0 C17 +
5.0 C18 + 3.0 C19 + 18.0 C20 + 8.0 C21 + 11.0 C22 + 2.0 C23 + 19.0 C24 + 23.0 C25 + 23.0
 C26 + 8.0 C27 + 18.0 C28 + 25.0 C29 = 28
R7: 3.0 C0 + 2.0 C1 + 4.0 C2 + 5.0 C3 + 3.0 C4 + 2.0 C5 + 3.0 C6 + 5.0 C7 + 3.0 C8 +
4.0 C9 + 5.0 C10 + 2.0 C11 + 5.0 C12 + 4.0 C13 + 2.0 C14 + 4.0 C15 + 2.0 C16 + 4.0 C17 +
3.0 C18 + 5.0 C19 + 20.0 C20 + 19.0 C21 + 13.0 C22 + 24.0 C23 + 19.0 C24 + 7.0 C25 + 4.0
 C26 + 15.0 C27 + 24.0 C28 + 3.0 C29 = 22
R8: 4.0 C0 + 4.0 C1 + 2.0 C2 + 3.0 C3 + 2.0 C4 + 2.0 C5 + 5.0 C6 + 5.0 C7 + 2.0 C8 +
3.0 C9 + 5.0 C10 + 5.0 C11 + 4.0 C12 + 5.0 C13 + 3.0 C14 + 4.0 C15 + 2.0 C16 + 2.0 C17 +
4.0 C18 + 2.0 C19 + 19.0 C20 + 6.0 C21 + 20.0 C22 + 16.0 C23 + 5.0 C24 + 14.0 C25 + 20.0
 C26 + 18.0 C27 + 19.0 C28 + 6.0 C29 = 39
R9: 4.0 C0 + 2.0 C1 + 3.0 C2 + 4.0 C3 + 4.0 C4 + 4.0 C5 + 2.0 C6 + 5.0 C7 + 2.0 C8 +
5.0 C9 + 5.0 C10 + 2.0 C11 + 3.0 C12 + 4.0 C13 + 4.0 C14 + 5.0 C15 + 4.0 C16 + 4.0 C17 +
2.0 C18 + 3.0 C19 + 25.0 C20 + 11.0 C21 + 17.0 C22 + 14.0 C23 + 15.0 C24 + 12.0 C25 +
 6.0 C26 + 23.0 C27 + 24.0 C28 + 6.0 C29 = 33
R10: 3.0 C0 + 5.0 C1 + 2.0 C2 + 5.0 C3 + 3.0 C4 + 2.0 C5 + 3.0 C6 + 3.0 C7 + 5.0 C8 +
5.0 C9 + 3.0 C10 + 2.0 C11 + 5.0 C12 + 3.0 C13 + 4.0 C14 + 3.0 C15 + 5.0 C16 + 5.0 C17 +
4.0 C18 + 4.0 C19 + 3.0 C20 + 23.0 C21 + 9.0 C22 + 16.0 C23 + 22.0 C24 + 3.0 C25 + 14.0
 C26 + 16.0 C27 + 12.0 C28 + 16.0 C29 = 28
R11: 2.0 C0 + 3.0 C1 + 4.0 C2 + 3.0 C3 + 5.0 C4 + 5.0 C5 + 3.0 C6 + 5.0 C7 + 4.0 C8 +
4.0 C9 + 2.0 C10 + 5.0 C11 + 4.0 C12 + 3.0 C13 + 5.0 C14 + 2.0 C15 + 3.0 C16 + 4.0 C17 +
5.0 C18 + 4.0 C19 + 13.0 C20 + 11.0 C21 + 7.0 C22 + 2.0 C23 + 15.0 C24 + 24.0 C25 + 13.0
 C26 + 16.0 C27 + 4.0 C28 + 6.0 C29 = 38
R12: 4.0 C0 + 4.0 C1 + 2.0 C2 + 2.0 C3 + 4.0 C4 + 4.0 C5 + 3.0 C6 + 2.0 C7 + 2.0 C8 +
2.0 C9 + 5.0 C10 + 5.0 C11 + 2.0 C12 + 5.0 C13 + 3.0 C14 + 3.0 C15 + 5.0 C16 + 2.0 C17 +
4.0 C18 + 3.0 C19 + 9.0 C20 + 13.0 C21 + 10.0 C22 + 16.0 C23 + 25.0 C24 + 16.0 C25 +
 24.0 C26 + 21.0 C27 + 6.0 C28 + 16.0 C29 = 47
R13: 3.0 C0 + 5.0 C1 + 5.0 C2 + 4.0 C3 + 3.0 C4 + 2.0 C5 + 3.0 C6 + 5.0 C7 + 2.0 C8 +
3.0 C9 + 5.0 C10 + 3.0 C11 + 5.0 C12 + 3.0 C13 + 3.0 C14 + 3.0 C15 + 5.0 C16 + 5.0 C17 +
5.0 C18 + 5.0 C19 + 3.0 C20 + 20.0 C21 + 5.0 C22 + 18.0 C23 + 8.0 C24 + 19.0 C25 + 25.0
 C26 + 2.0 C27 + 17.0 C28 + 7.0 C29 = 28
R14: 3.0 C0 + 2.0 C1 + 5.0 C2 + 2.0 C3 + 2.0 C4 + 3.0 C5 + 3.0 C6 + 3.0 C7 + 4.0 C8 +
3.0 C9 + 5.0 C10 + 5.0 C11 + 4.0 C12 + 4.0 C13 + 4.0 C14 + 3.0 C15 + 3.0 C16 + 4.0 C17 +
4.0 C18 + 4.0 C19 + 9.0 C20 + 15.0 C21 + 6.0 C22 + 23.0 C23 + 14.0 C24 + 21.0 C25 + 21.0
 C26 + 22.0 C27 + 18.0 C28 + 22.0 C29 = 45
R15: 3.0 C0 + 2.0 C1 + 2.0 C2 + 3.0 C3 + 4.0 C4 + 3.0 C5 + 2.0 C6 + 4.0 C7 + 5.0 C8 +
3.0 C9 + 2.0 C10 + 2.0 C11 + 2.0 C12 + 3.0 C13 + 5.0 C14 + 3.0 C15 + 2.0 C16 + 2.0 C17 +
4.0 C18 + 4.0 C19 + 19.0 C20 + 17.0 C21 + 17.0 C22 + 17.0 C23 + 4.0 C24 + 22.0 C25 +
 12.0 C26 + 18.0 C27 + 4.0 C28 + 18.0 C29 = 34
R16: 4.0 C0 + 2.0 C1 + 2.0 C2 + 5.0 C3 + 2.0 C4 + 3.0 C5 + 5.0 C6 + 4.0 C7 + 2.0 C8 +
3.0 C9 + 2.0 C10 + 5.0 C11 + 5.0 C12 + 5.0 C13 + 5.0 C14 + 4.0 C15 + 4.0 C16 + 4.0 C17 +
2.0 C18 + 5.0 C19 + 2.0 C20 + 13.0 C21 + 23.0 C22 + 8.0 C23 + 22.0 C24 + 17.0 C25 + 10.0
 C26 + 24.0 C27 + 20.0 C28 + 23.0 C29 = 46
R17: 2.0 C0 + 4.0 C1 + 2.0 C2 + 3.0 C3 + 2.0 C4 + 2.0 C5 + 2.0 C6 + 4.0 C7 + 4.0 C8 +
5.0 C9 + 2.0 C10 + 4.0 C11 + 4.0 C12 + 4.0 C13 + 2.0 C14 + 4.0 C15 + 3.0 C16 + 4.0 C17 +
5.0 C18 + 3.0 C19 + 10.0 C20 + 6.0 C21 + 20.0 C22 + 21.0 C23 + 16.0 C24 + 15.0 C25 +
 13.0 C26 + 3.0 C27 + 24.0 C28 + 16.0 C29 = 35
R18: 2.0 C0 + 5.0 C1 + 4.0 C2 + 3.0 C3 + 3.0 C4 + 3.0 C5 + 4.0 C6 + 2.0 C7 + 5.0 C8 +
4.0 C9 + 2.0 C10 + 4.0 C11 + 5.0 C12 + 2.0 C13 + 2.0 C14 + 2.0 C15 + 3.0 C16 + 5.0 C17 +
4.0 C18 + 5.0 C19 + 12.0 C20 + 18.0 C21 + 21.0 C22 + 8.0 C23 + 19.0 C24 + 8.0 C25 + 11.0
 C26 + 20.0 C27 + 21.0 C28 + 21.0 C29 = 46
R19: 4.0 C0 + 2.0 C1 + 2.0 C2 + 2.0 C3 + 2.0 C4 + 2.0 C5 + 4.0 C6 + 3.0 C7 + 4.0 C8 +
3.0 C9 + 2.0 C10 + 2.0 C11 + 4.0 C12 + 2.0 C13 + 4.0 C14 + 3.0 C15 + 5.0 C16 + 2.0 C17 +
4.0 C18 + 3.0 C19 + 11.0 C20 + 4.0 C21 + 2.0 C22 + 9.0 C23 + 13.0 C24 + 20.0 C25 + 23.0
 C26 + 16.0 C27 + 16.0 C28 + 14.0 C29 = 32
None
Gurobi Optimizer version 10.0.3 build v10.0.3rc0 (mac64[arm])

CPU model: Apple M1
Thread count: 8 physical cores, 8 logical processors, using up to 8 threads

Optimize a model with 20 rows, 30 columns and 600 nonzeros
Model fingerprint: 0x05cb70d4
Coefficient statistics:
  Matrix range     [2e+00, 2e+01]
  Objective range  [2e+00, 1e+01]
  Bounds range     [0e+00, 0e+00]
  RHS range        [2e+01, 5e+01]
Presolve time: 0.00s
Presolved: 20 rows, 30 columns, 600 nonzeros

Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0    3.3913043e+00   5.119565e+01   0.000000e+00      0s

Solved in 13 iterations and 0.01 seconds (0.00 work units)
Infeasible model</code></pre>
</div>
</div>
<div class="cell" data-execution_count="180">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a>lpsolver_scip <span class="op">=</span> LpSolverSCIP(obj_coeff<span class="op">=</span>obj_coeff, constr_mat<span class="op">=</span>constr_mat, rhs<span class="op">=</span>rhs)</span>
<span id="cb6-2"><a href="#cb6-2"></a>lpsolver_scip.optimize()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>presolving:
(round 1, fast)       0 del vars, 0 del conss, 0 add conss, 74 chg bounds, 0 chg sides, 0 chg coeffs, 0 upgd conss, 0 impls, 0 clqs
   (0.0s) running MILP presolver
   (0.0s) MILP presolver found nothing
   (0.0s) sparsify finished: 158/600 (26.3%) nonzeros canceled - in total 158 canceled nonzeros, 570 changed coefficients, 0 added nonzeros
(round 2, exhaustive) 0 del vars, 0 del conss, 0 add conss, 74 chg bounds, 0 chg sides, 570 chg coeffs, 0 upgd conss, 0 impls, 0 clqs
   (0.0s) sparsify aborted: 8/442 (1.8%) nonzeros canceled - in total 166 canceled nonzeros, 632 changed coefficients, 0 added nonzeros
(round 3, exhaustive) 0 del vars, 0 del conss, 0 add conss, 74 chg bounds, 0 chg sides, 632 chg coeffs, 0 upgd conss, 0 impls, 0 clqs
(round 4, fast)       0 del vars, 0 del conss, 0 add conss, 77 chg bounds, 0 chg sides, 632 chg coeffs, 0 upgd conss, 0 impls, 0 clqs
   (0.0s) symmetry computation started: requiring (bin +, int +, cont +), (fixed: bin -, int -, cont -)
   (0.0s) no symmetry present (symcode time: 0.00)
presolving (5 rounds: 5 fast, 3 medium, 3 exhaustive):
 0 deleted vars, 0 deleted constraints, 0 added constraints, 77 tightened bounds, 0 added holes, 0 changed sides, 632 changed coefficients
 0 implications, 0 cliques
presolved problem has 30 variables (0 bin, 0 int, 0 impl, 30 cont) and 20 constraints
     20 constraints of type &lt;linear&gt;
Presolving Time: 0.00

 time | node  | left  |LP iter|LP it/n|mem/heur|mdpt |vars |cons |rows |cuts |sepa|confs|strbr|  dualbound   | primalbound  |  gap   | compl. 
  0.0s|     1 |     0 |    13 |     - |  1509k |   0 |  30 |  20 |  20 |   0 |  0 |   0 |   0 |    cutoff    |      --      |   0.00%| unknown
  0.0s|     1 |     0 |    13 |     - |  1509k |   0 |  30 |  20 |  20 |   0 |  0 |   0 |   0 |    cutoff    |      --      |   0.00%| unknown

SCIP Status        : problem is solved [infeasible]
Solving Time (sec) : 0.00
Solving Nodes      : 1
Primal Bound       : +1.00000000000000e+20 (0 solutions)
Dual Bound         : +1.00000000000000e+20
Gap                : 0.00 %</code></pre>
</div>
</div>
</section>
<section id="the-original-problem-and-its-optimal-solution" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="the-original-problem-and-its-optimal-solution"><span class="header-section-number">4.2.2</span> The original problem and its optimal solution</h3>
<p>The linear program we examine here is devoid of any practical meaning and is solely used to demonstrate the solution process of Benders decomposition. The problem is stated below, in which <span class="math inline">\(\mathbf{x} = (x_1, x_2, x_3)\)</span> and <span class="math inline">\(\mathbf{y} = (y_1, y_2)\)</span> are the decision variables. We assume that <span class="math inline">\(\mathbf{y}\)</span> is the complicating variable.</p>
<p><span class="math display">\[\begin{align*}
    \text{min.} &amp;\quad 8x_1 + 12x_2 +10x_3 + 15y_1 + 18y_2 \\
    \text{s.t.} &amp;\quad 2x_1 + 3x_2 + 2x_3 + 4y_1 + 5y_2 = 300 \\
    &amp;\quad 4x_1 + 2x_2 + 3x_3 + 2y_1 + 3y_2 = 220 \\
    &amp;\quad x_i \geq 0, \ \forall i = 1, \cdots, 3 \\
    &amp;\quad y_i \geq 0, \ \forall j = 1, 2
\end{align*}\]</span></p>
<p>In this example, <span class="math inline">\(\mathbf{c}^T = (8, 12, 10)\)</span>, <span class="math inline">\(\mathbf{f}^T = (15, 18)\)</span> and <span class="math inline">\(\mathbf{b}^T = (300, 220)\)</span>. In addition,</p>
<p><span class="math display">\[\begin{equation*}
\mathbf{A} =
\begin{bmatrix}
    2 &amp; 3 &amp; 2 \\
    4 &amp; 2 &amp; 3 \\
\end{bmatrix}
\qquad
\mathbf{B} =
\begin{bmatrix}
    4 &amp; 5 \\
    2 &amp; 3 \\
\end{bmatrix}
\end{equation*}\]</span></p>
<p>We first use Gurobi to identify its optimal solution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a><span class="im">import</span> gurobipy <span class="im">as</span> gp</span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="im">from</span> gurobipy <span class="im">import</span> GRB</span>
<span id="cb8-3"><a href="#cb8-3"></a></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co"># Create a new model</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>env <span class="op">=</span> gp.Env(empty<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-6"><a href="#cb8-6"></a>env.setParam(<span class="st">'OutputFlag'</span>, <span class="dv">0</span>)</span>
<span id="cb8-7"><a href="#cb8-7"></a>env.start()</span>
<span id="cb8-8"><a href="#cb8-8"></a>model <span class="op">=</span> gp.Model(env<span class="op">=</span>env, name<span class="op">=</span><span class="st">"original_problem"</span>)</span>
<span id="cb8-9"><a href="#cb8-9"></a></span>
<span id="cb8-10"><a href="#cb8-10"></a><span class="co"># Decision variables</span></span>
<span id="cb8-11"><a href="#cb8-11"></a>x1 <span class="op">=</span> model.addVar(vtype<span class="op">=</span>GRB.CONTINUOUS, name<span class="op">=</span><span class="st">'x1'</span>)</span>
<span id="cb8-12"><a href="#cb8-12"></a>x2 <span class="op">=</span> model.addVar(vtype<span class="op">=</span>GRB.CONTINUOUS, name<span class="op">=</span><span class="st">'x2'</span>)</span>
<span id="cb8-13"><a href="#cb8-13"></a>x3 <span class="op">=</span> model.addVar(vtype<span class="op">=</span>GRB.CONTINUOUS, name<span class="op">=</span><span class="st">'x3'</span>)</span>
<span id="cb8-14"><a href="#cb8-14"></a>y1 <span class="op">=</span> model.addVar(vtype<span class="op">=</span>GRB.CONTINUOUS, name<span class="op">=</span><span class="st">'y1'</span>)</span>
<span id="cb8-15"><a href="#cb8-15"></a>y2 <span class="op">=</span> model.addVar(vtype<span class="op">=</span>GRB.CONTINUOUS, name<span class="op">=</span><span class="st">'y2'</span>)</span>
<span id="cb8-16"><a href="#cb8-16"></a></span>
<span id="cb8-17"><a href="#cb8-17"></a><span class="co"># Objective function</span></span>
<span id="cb8-18"><a href="#cb8-18"></a>model.setObjective(<span class="dv">8</span><span class="op">*</span>x1 <span class="op">+</span> <span class="dv">12</span><span class="op">*</span>x2 <span class="op">+</span> <span class="dv">10</span><span class="op">*</span>x3 <span class="op">+</span> <span class="dv">15</span><span class="op">*</span>y1 <span class="op">+</span> <span class="dv">18</span><span class="op">*</span>y2, </span>
<span id="cb8-19"><a href="#cb8-19"></a>                   GRB.MINIMIZE)</span>
<span id="cb8-20"><a href="#cb8-20"></a></span>
<span id="cb8-21"><a href="#cb8-21"></a><span class="co"># Constraints</span></span>
<span id="cb8-22"><a href="#cb8-22"></a>model.addConstr(<span class="dv">2</span><span class="op">*</span>x1 <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>x2 <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>x3 <span class="op">+</span> <span class="dv">4</span><span class="op">*</span>y1 <span class="op">+</span> <span class="dv">5</span><span class="op">*</span>y2 <span class="op">==</span> <span class="dv">300</span>)</span>
<span id="cb8-23"><a href="#cb8-23"></a>model.addConstr(<span class="dv">4</span><span class="op">*</span>x1 <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>x2 <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>x3 <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>y1 <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>y2 <span class="op">==</span> <span class="dv">220</span>)</span>
<span id="cb8-24"><a href="#cb8-24"></a></span>
<span id="cb8-25"><a href="#cb8-25"></a><span class="co"># Optimize the model</span></span>
<span id="cb8-26"><a href="#cb8-26"></a>model.optimize()</span>
<span id="cb8-27"><a href="#cb8-27"></a></span>
<span id="cb8-28"><a href="#cb8-28"></a><span class="co"># Print the results</span></span>
<span id="cb8-29"><a href="#cb8-29"></a><span class="cf">if</span> model.status <span class="op">==</span> GRB.OPTIMAL:</span>
<span id="cb8-30"><a href="#cb8-30"></a>    <span class="bu">print</span>(<span class="st">"Optimal solution found!"</span>)</span>
<span id="cb8-31"><a href="#cb8-31"></a>    <span class="bu">print</span>(<span class="ss">f'x1 = </span><span class="sc">{</span>x1<span class="sc">.</span>X<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb8-32"><a href="#cb8-32"></a>    <span class="bu">print</span>(<span class="ss">f'x2 = </span><span class="sc">{</span>x2<span class="sc">.</span>X<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb8-33"><a href="#cb8-33"></a>    <span class="bu">print</span>(<span class="ss">f'x3 = </span><span class="sc">{</span>x3<span class="sc">.</span>X<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb8-34"><a href="#cb8-34"></a>    <span class="bu">print</span>(<span class="ss">f'y1 = </span><span class="sc">{</span>y1<span class="sc">.</span>X<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb8-35"><a href="#cb8-35"></a>    <span class="bu">print</span>(<span class="ss">f'y2 = </span><span class="sc">{</span>y2<span class="sc">.</span>X<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb8-36"><a href="#cb8-36"></a>    <span class="bu">print</span>(<span class="ss">f"Total cost: </span><span class="sc">{</span>model<span class="sc">.</span>objVal<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb8-37"><a href="#cb8-37"></a><span class="cf">else</span>:</span>
<span id="cb8-38"><a href="#cb8-38"></a>    <span class="bu">print</span>(<span class="st">"No solution found."</span>)</span>
<span id="cb8-39"><a href="#cb8-39"></a></span>
<span id="cb8-40"><a href="#cb8-40"></a><span class="co"># Close the Gurobi environment</span></span>
<span id="cb8-41"><a href="#cb8-41"></a>model.dispose()</span>
<span id="cb8-42"><a href="#cb8-42"></a>env.dispose()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The optimal solution and objective value are as follows.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode numberSource {{python}} number-lines code-with-copy"><code class="sourceCode"><span id="cb9-1"><a href="#cb9-1"></a>Optimal solution found!</span>
<span id="cb9-2"><a href="#cb9-2"></a>x1 = 14.29</span>
<span id="cb9-3"><a href="#cb9-3"></a>x2 = 0.00</span>
<span id="cb9-4"><a href="#cb9-4"></a>x3 = 0.00</span>
<span id="cb9-5"><a href="#cb9-5"></a>y1 = 0.00</span>
<span id="cb9-6"><a href="#cb9-6"></a>y2 = 54.29</span>
<span id="cb9-7"><a href="#cb9-7"></a>Total cost: 1091.43</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="benders-decomposition" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="benders-decomposition"><span class="header-section-number">4.2.3</span> Benders decomposition</h3>
<p>We first state the subproblem as follows:</p>
<p><span class="math display">\[\begin{align*}
    &amp;(\mathbf{SP}) &amp;\quad \text{min.} &amp;\quad 8x_1 + 12x_2 +10x_3 \\
    &amp;&amp;\quad \text{s.t.} &amp;\quad 2x_1 + 3x_2 + 2x_3 = 300 - 4y_1 - 5y_2 \\
    &amp;&amp;&amp;\quad 4x_1 + 2x_2 + 3x_3 = 220 - 2y_1 - 3y_2 \\
    &amp;&amp;&amp;\quad x_i \geq 0, \ \forall i = 1, \cdots, 3
\end{align*}\]</span></p>
<p>We define two dual variables <span class="math inline">\(u_1\)</span> and <span class="math inline">\(u_2\)</span> to associate with the two constraints in the subproblem. The dual subproblem could then be stated as follows:</p>
<p><span class="math display">\[\begin{align*}
    &amp;(\mathbf{DSP}) &amp;\quad \text{max.} &amp;\quad (300 - 4y_1 - 5y_2) u_1 + (220 - 2y_1 - 3y_2) u_2 \\
    &amp;&amp;\quad \text{s.t.} &amp;\quad 2u_1 + 4u_2 \leq 8\\
    &amp;&amp;&amp;\quad 3u_1 + 2u_2 \leq 12 \\
    &amp;&amp;&amp;\quad 2u_1 + 3u_2 \leq 10 \\
    &amp;&amp;&amp;\quad u_1, u_2\  \text{unrestricted}
\end{align*}\]</span></p>
<p>The <em>RBMP</em> can be stated as:</p>
<p><span class="math display">\[\begin{align*}
    &amp;(\mathbf{RBMP}) &amp;\quad \text{min.} &amp;\quad 15 y_1 + 18 y_2 + g \\
    &amp;&amp;\quad \text{s.t.} &amp;\quad  y_1, y_2 \geq 0 \\
    &amp;&amp;&amp;\quad g \leq 0
\end{align*}\]</span></p>
</section>
<section id="solving-the-problem-step-by-step" class="level3" data-number="4.2.4">
<h3 data-number="4.2.4" class="anchored" data-anchor-id="solving-the-problem-step-by-step"><span class="header-section-number">4.2.4</span> Solving the problem step by step</h3>
<p>In this section, we will solve the linear program step by step using Gurobi. To this end, we first import the necessary libraries and create an environment <code>env</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a><span class="co">#ï½œ output: false</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="im">import</span> gurobipy <span class="im">as</span> gp</span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="im">from</span> gurobipy <span class="im">import</span> GRB</span>
<span id="cb10-5"><a href="#cb10-5"></a></span>
<span id="cb10-6"><a href="#cb10-6"></a>env <span class="op">=</span> gp.Env(<span class="st">'benders'</span>)</span>
<span id="cb10-7"><a href="#cb10-7"></a>env.setParam(<span class="st">'OutputFlag'</span>, <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we initialize several algorithm parameters, specifically, we use <code>lb</code> and <code>ub</code> to represent the lower and upper bounds of the solution. The <code>eps</code> is defined as a small number to decide whether the searching process should stop.</p>
<p>The remaining codes aim to create the restricted master Benders problem indicated by <code>rbmp</code>. Note that it only has the <span class="math inline">\(y\)</span> and <span class="math inline">\(g\)</span> variables and the objective function, there is no constraint added to the model yet.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># parameters</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>lb <span class="op">=</span> <span class="op">-</span>GRB.INFINITY</span>
<span id="cb11-3"><a href="#cb11-3"></a>ub <span class="op">=</span> GRB.INFINITY</span>
<span id="cb11-4"><a href="#cb11-4"></a>eps <span class="op">=</span> <span class="fl">1.0e-5</span></span>
<span id="cb11-5"><a href="#cb11-5"></a></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="co"># create restricted Benders master problem</span></span>
<span id="cb11-7"><a href="#cb11-7"></a>rbmp <span class="op">=</span> gp.Model(env<span class="op">=</span>env, name<span class="op">=</span><span class="st">'RBMP'</span>)</span>
<span id="cb11-8"><a href="#cb11-8"></a></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="co"># create decision variables</span></span>
<span id="cb11-10"><a href="#cb11-10"></a>y1 <span class="op">=</span> rbmp.addVar(vtype<span class="op">=</span>GRB.CONTINUOUS, lb<span class="op">=</span><span class="dv">0</span>, name<span class="op">=</span><span class="st">'y1'</span>)</span>
<span id="cb11-11"><a href="#cb11-11"></a>y2 <span class="op">=</span> rbmp.addVar(vtype<span class="op">=</span>GRB.CONTINUOUS, lb<span class="op">=</span><span class="dv">0</span>, name<span class="op">=</span><span class="st">'y2'</span>)</span>
<span id="cb11-12"><a href="#cb11-12"></a>g <span class="op">=</span> rbmp.addVar(vtype<span class="op">=</span>GRB.CONTINUOUS, lb<span class="op">=</span><span class="dv">0</span>, name<span class="op">=</span><span class="st">'g'</span>)</span>
<span id="cb11-13"><a href="#cb11-13"></a></span>
<span id="cb11-14"><a href="#cb11-14"></a><span class="co"># create objective</span></span>
<span id="cb11-15"><a href="#cb11-15"></a>rbmp.setObjective(<span class="dv">15</span><span class="op">*</span>y1 <span class="op">+</span> <span class="dv">18</span><span class="op">*</span>y2 <span class="op">+</span> g, GRB.MINIMIZE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We then define the model in Gurobi to solve the dual subproblem, represented by <code>dsp</code>. It consists of two decision variables <code>u1</code> and <code>u2</code>. The constraints are created in lines 12 - 14.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># create dual subproblem</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>dsp <span class="op">=</span> gp.Model(env<span class="op">=</span>env, name<span class="op">=</span><span class="st">'DSP'</span>)</span>
<span id="cb12-3"><a href="#cb12-3"></a></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="co"># create decision variables</span></span>
<span id="cb12-5"><a href="#cb12-5"></a>u1 <span class="op">=</span> dsp.addVar(vtype<span class="op">=</span>GRB.CONTINUOUS, name<span class="op">=</span><span class="st">'u1'</span>)</span>
<span id="cb12-6"><a href="#cb12-6"></a>u2 <span class="op">=</span> dsp.addVar(vtype<span class="op">=</span>GRB.CONTINUOUS, name<span class="op">=</span><span class="st">'u2'</span>)</span>
<span id="cb12-7"><a href="#cb12-7"></a></span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="co"># create objective function</span></span>
<span id="cb12-9"><a href="#cb12-9"></a>dsp.setObjective(<span class="dv">300</span><span class="op">*</span>u1 <span class="op">+</span> <span class="dv">220</span><span class="op">*</span>u2)</span>
<span id="cb12-10"><a href="#cb12-10"></a></span>
<span id="cb12-11"><a href="#cb12-11"></a><span class="co"># create constraints</span></span>
<span id="cb12-12"><a href="#cb12-12"></a>dsp.addConstr(<span class="dv">2</span><span class="op">*</span>u1 <span class="op">+</span> <span class="dv">4</span><span class="op">*</span>u2 <span class="op">&lt;=</span> <span class="dv">8</span>, name<span class="op">=</span><span class="st">'c1'</span>)</span>
<span id="cb12-13"><a href="#cb12-13"></a>dsp.addConstr(<span class="dv">3</span><span class="op">*</span>u1 <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>u2 <span class="op">&lt;=</span> <span class="dv">12</span>, name<span class="op">=</span><span class="st">'c2'</span>)</span>
<span id="cb12-14"><a href="#cb12-14"></a>dsp.addConstr(<span class="dv">2</span><span class="op">*</span>u1 <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>u2 <span class="op">&lt;=</span> <span class="dv">10</span>, name<span class="op">=</span><span class="st">'c3'</span>)</span>
<span id="cb12-15"><a href="#cb12-15"></a></span>
<span id="cb12-16"><a href="#cb12-16"></a>dsp.update()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In the very first iteration, we solve the <strong>RBMP</strong>, as shown in the following code snippet.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a>rbmp.optimize()</span>
<span id="cb13-2"><a href="#cb13-2"></a></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="cf">if</span> rbmp.status <span class="op">==</span> GRB.OPTIMAL:</span>
<span id="cb13-4"><a href="#cb13-4"></a>    <span class="bu">print</span>(<span class="ss">f'optimal solution found!'</span>)</span>
<span id="cb13-5"><a href="#cb13-5"></a>    </span>
<span id="cb13-6"><a href="#cb13-6"></a>    y1_opt <span class="op">=</span> y1.X</span>
<span id="cb13-7"><a href="#cb13-7"></a>    y2_opt <span class="op">=</span> y2.X</span>
<span id="cb13-8"><a href="#cb13-8"></a>    g_opt <span class="op">=</span> g.X</span>
<span id="cb13-9"><a href="#cb13-9"></a>    lb <span class="op">=</span> np.<span class="bu">max</span>([lb, rbmp.objVal])</span>
<span id="cb13-10"><a href="#cb13-10"></a>    </span>
<span id="cb13-11"><a href="#cb13-11"></a>    <span class="bu">print</span>(<span class="ss">f'optimal obj: </span><span class="sc">{</span>rbmp<span class="sc">.</span>objVal<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb13-12"><a href="#cb13-12"></a>    <span class="bu">print</span>(<span class="ss">f'y1 = </span><span class="sc">{</span>y1_opt<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb13-13"><a href="#cb13-13"></a>    <span class="bu">print</span>(<span class="ss">f'y2 = </span><span class="sc">{</span>y2_opt<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb13-14"><a href="#cb13-14"></a>    <span class="bu">print</span>(<span class="ss">f'g = </span><span class="sc">{</span>g_opt<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb13-15"><a href="#cb13-15"></a>    <span class="bu">print</span>(<span class="ss">f'lb=</span><span class="sc">{</span>lb<span class="sc">}</span><span class="ss">, ub=</span><span class="sc">{</span>ub<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb13-16"><a href="#cb13-16"></a><span class="cf">elif</span> rbmp.status <span class="op">==</span> GRB.INFEASIBLE:</span>
<span id="cb13-17"><a href="#cb13-17"></a>    <span class="bu">print</span>(<span class="ss">f'original problem is infeasible!'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we have obtained an optimal solution <span class="math inline">\((\bar{y_1}, \bar{y_2}, \bar{g}) = (0, 0, 0)\)</span>, which also provides a new lower bound to our problem. We now feed the values of <span class="math inline">\(\bar{y_1}\)</span> and <span class="math inline">\(\bar{y_2}\)</span> into the Benders subproblem <strong>(SP)</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a></span>
<span id="cb14-2"><a href="#cb14-2"></a>dsp.setObjective((<span class="dv">300</span><span class="op">-</span><span class="dv">4</span><span class="op">*</span>y1_opt<span class="op">-</span><span class="dv">5</span><span class="op">*</span>y2_opt)<span class="op">*</span>u1 <span class="op">+</span> </span>
<span id="cb14-3"><a href="#cb14-3"></a>                 (<span class="dv">220</span><span class="op">-</span><span class="dv">2</span><span class="op">*</span>y1_opt<span class="op">-</span><span class="dv">3</span><span class="op">*</span>y2_opt)<span class="op">*</span>u2, </span>
<span id="cb14-4"><a href="#cb14-4"></a>                 GRB.MAXIMIZE)</span>
<span id="cb14-5"><a href="#cb14-5"></a>dsp.update()</span>
<span id="cb14-6"><a href="#cb14-6"></a>dsp.optimize()</span>
<span id="cb14-7"><a href="#cb14-7"></a></span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="cf">if</span> dsp.status <span class="op">==</span> GRB.OPTIMAL:</span>
<span id="cb14-9"><a href="#cb14-9"></a>    u1_opt <span class="op">=</span> u1.X</span>
<span id="cb14-10"><a href="#cb14-10"></a>    u2_opt <span class="op">=</span> u2.X</span>
<span id="cb14-11"><a href="#cb14-11"></a>    </span>
<span id="cb14-12"><a href="#cb14-12"></a>    <span class="bu">print</span>(<span class="ss">f'optimal obj = </span><span class="sc">{</span>dsp<span class="sc">.</span>objVal<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb14-13"><a href="#cb14-13"></a>    <span class="bu">print</span>(<span class="ss">f'u1 = </span><span class="sc">{</span>u1_opt<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb14-14"><a href="#cb14-14"></a>    <span class="bu">print</span>(<span class="ss">f'u2 = </span><span class="sc">{</span>u2_opt<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb14-15"><a href="#cb14-15"></a>    ub <span class="op">=</span> np.<span class="bu">min</span>([ub, <span class="dv">15</span><span class="op">*</span>y1_opt <span class="op">+</span> <span class="dv">18</span><span class="op">*</span>y2_opt <span class="op">+</span> dsp.objVal])</span>
<span id="cb14-16"><a href="#cb14-16"></a>    <span class="bu">print</span>(<span class="ss">f'lb=</span><span class="sc">{</span>lb<span class="sc">}</span><span class="ss">, ub=</span><span class="sc">{</span>ub<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb14-17"><a href="#cb14-17"></a><span class="cf">elif</span> dsp.Status <span class="op">==</span> GRB.UNBOUNDED:</span>
<span id="cb14-18"><a href="#cb14-18"></a>    <span class="co"># add feasibility cut</span></span>
<span id="cb14-19"><a href="#cb14-19"></a>    <span class="cf">pass</span></span>
<span id="cb14-20"><a href="#cb14-20"></a><span class="cf">else</span>:</span>
<span id="cb14-21"><a href="#cb14-21"></a>    <span class="cf">pass</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We see that the dual subproblem has an optimal solution. Note that in line 15, the upper bound of the problem is updated.</p>
<p>Since the optimal objective value of the subproblem turns out to be 1200 and is greater than <span class="math inline">\(\bar{g} = 0\)</span>, which implies that an optimality cut is needed to make sure that the variable <span class="math inline">\(g\)</span> in the restricted Benders master problem reflects this newly obtained information from the subproblem.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a>rbmp.addConstr((<span class="dv">300</span><span class="op">-</span><span class="dv">4</span><span class="op">*</span>y2<span class="op">-</span><span class="dv">5</span><span class="op">*</span>y2)<span class="op">*</span>u1_opt </span>
<span id="cb15-2"><a href="#cb15-2"></a>               <span class="op">+</span> (<span class="dv">220</span><span class="op">-</span><span class="dv">2</span><span class="op">*</span>y1<span class="op">-</span><span class="dv">3</span><span class="op">*</span>y2)<span class="op">*</span>u2_opt <span class="op">&lt;=</span> g, </span>
<span id="cb15-3"><a href="#cb15-3"></a>               name<span class="op">=</span><span class="st">'c3'</span>)</span>
<span id="cb15-4"><a href="#cb15-4"></a>rbmp.update()</span>
<span id="cb15-5"><a href="#cb15-5"></a>rbmp.optimize()</span>
<span id="cb15-6"><a href="#cb15-6"></a></span>
<span id="cb15-7"><a href="#cb15-7"></a><span class="cf">if</span> rbmp.status <span class="op">==</span> GRB.OPTIMAL:</span>
<span id="cb15-8"><a href="#cb15-8"></a>    <span class="bu">print</span>(<span class="ss">f'optimal solution found!'</span>)</span>
<span id="cb15-9"><a href="#cb15-9"></a>    </span>
<span id="cb15-10"><a href="#cb15-10"></a>    y1_opt <span class="op">=</span> y1.X</span>
<span id="cb15-11"><a href="#cb15-11"></a>    y2_opt <span class="op">=</span> y2.X</span>
<span id="cb15-12"><a href="#cb15-12"></a>    g_opt <span class="op">=</span> g.X</span>
<span id="cb15-13"><a href="#cb15-13"></a>    lb <span class="op">=</span> np.<span class="bu">max</span>([lb, rbmp.objVal])</span>
<span id="cb15-14"><a href="#cb15-14"></a>    </span>
<span id="cb15-15"><a href="#cb15-15"></a>    <span class="bu">print</span>(<span class="ss">f'optimal obj: </span><span class="sc">{</span>rbmp<span class="sc">.</span>objVal<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb15-16"><a href="#cb15-16"></a>    <span class="bu">print</span>(<span class="ss">f'y1 = </span><span class="sc">{</span>y1_opt<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb15-17"><a href="#cb15-17"></a>    <span class="bu">print</span>(<span class="ss">f'y2 = </span><span class="sc">{</span>y2_opt<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb15-18"><a href="#cb15-18"></a>    <span class="bu">print</span>(<span class="ss">f'g = </span><span class="sc">{</span>g_opt<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb15-19"><a href="#cb15-19"></a>    <span class="bu">print</span>(<span class="ss">f'lb=</span><span class="sc">{</span>lb<span class="sc">}</span><span class="ss">, ub=</span><span class="sc">{</span>ub<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb15-20"><a href="#cb15-20"></a><span class="cf">elif</span> rbmp.status <span class="op">==</span> GRB.INFEASIBLE:</span>
<span id="cb15-21"><a href="#cb15-21"></a>    <span class="bu">print</span>(<span class="ss">f'original problem is infeasible!'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we solve the subproblem again with the newly obtained solution <span class="math inline">\((\bar{y_1}, \bar{y_2}, \bar{g}) = (0, 33.33, 0)\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a>dsp.setObjective((<span class="dv">300</span> <span class="op">-</span> <span class="dv">4</span><span class="op">*</span>y1_opt <span class="op">-</span> <span class="dv">5</span><span class="op">*</span>y2_opt) <span class="op">*</span> u1 </span>
<span id="cb16-2"><a href="#cb16-2"></a>                 <span class="op">+</span> (<span class="dv">220</span> <span class="op">-</span> <span class="dv">2</span><span class="op">*</span>y1_opt <span class="op">-</span> <span class="dv">3</span><span class="op">*</span>y2_opt) <span class="op">*</span> u2, </span>
<span id="cb16-3"><a href="#cb16-3"></a>                 GRB.MAXIMIZE)</span>
<span id="cb16-4"><a href="#cb16-4"></a>dsp.update()</span>
<span id="cb16-5"><a href="#cb16-5"></a>dsp.optimize()</span>
<span id="cb16-6"><a href="#cb16-6"></a></span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="cf">if</span> dsp.status <span class="op">==</span> GRB.OPTIMAL:</span>
<span id="cb16-8"><a href="#cb16-8"></a>    u1_opt <span class="op">=</span> u1.X</span>
<span id="cb16-9"><a href="#cb16-9"></a>    u2_opt <span class="op">=</span> u2.X</span>
<span id="cb16-10"><a href="#cb16-10"></a>    </span>
<span id="cb16-11"><a href="#cb16-11"></a>    <span class="bu">print</span>(<span class="ss">f'optimal obj = </span><span class="sc">{</span>dsp<span class="sc">.</span>objVal<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb16-12"><a href="#cb16-12"></a>    <span class="bu">print</span>(<span class="ss">f'u1 = </span><span class="sc">{</span>u1_opt<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb16-13"><a href="#cb16-13"></a>    <span class="bu">print</span>(<span class="ss">f'u2 = </span><span class="sc">{</span>u2_opt<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb16-14"><a href="#cb16-14"></a>    ub <span class="op">=</span> np.<span class="bu">min</span>([ub, <span class="dv">15</span><span class="op">*</span>y1_opt <span class="op">+</span> <span class="dv">18</span><span class="op">*</span>y2_opt <span class="op">+</span> dsp.objVal])</span>
<span id="cb16-15"><a href="#cb16-15"></a>    <span class="bu">print</span>(<span class="ss">f'lb=</span><span class="sc">{</span>lb<span class="sc">}</span><span class="ss">, ub=</span><span class="sc">{</span>ub<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb16-16"><a href="#cb16-16"></a><span class="cf">elif</span> dsp.status <span class="op">==</span> GRB.UNBOUNDED:</span>
<span id="cb16-17"><a href="#cb16-17"></a>    <span class="bu">print</span>(<span class="ss">f'dual subproblem is unbounded!'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Since the optimal objective value of the subproblem, 533.33, is still bigger than <span class="math inline">\(\bar{g} = 0\)</span>, an optimality cut is needed. In the below code snippet, we add the new cut and solve the restricted Benders master problem again.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a>rbmp.addConstr((<span class="dv">300</span> <span class="op">-</span> <span class="dv">4</span><span class="op">*</span>y1 <span class="op">-</span> <span class="dv">5</span><span class="op">*</span>y2) <span class="op">*</span> u1_opt <span class="op">+</span> (<span class="dv">220</span> <span class="op">-</span> <span class="dv">2</span><span class="op">*</span>y1 <span class="op">-</span> <span class="dv">3</span><span class="op">*</span>y2) <span class="op">*</span> u2_opt <span class="op">&lt;=</span> g, name<span class="op">=</span><span class="st">'c3'</span>)</span>
<span id="cb17-2"><a href="#cb17-2"></a>rbmp.update()</span>
<span id="cb17-3"><a href="#cb17-3"></a>rbmp.optimize()</span>
<span id="cb17-4"><a href="#cb17-4"></a></span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="cf">if</span> rbmp.status <span class="op">==</span> GRB.OPTIMAL:</span>
<span id="cb17-6"><a href="#cb17-6"></a>    <span class="bu">print</span>(<span class="ss">f'optimal solution found!'</span>)</span>
<span id="cb17-7"><a href="#cb17-7"></a>    </span>
<span id="cb17-8"><a href="#cb17-8"></a>    y1_opt <span class="op">=</span> y1.X</span>
<span id="cb17-9"><a href="#cb17-9"></a>    y2_opt <span class="op">=</span> y2.X</span>
<span id="cb17-10"><a href="#cb17-10"></a>    g_opt <span class="op">=</span> g.X</span>
<span id="cb17-11"><a href="#cb17-11"></a>    lb <span class="op">=</span> np.<span class="bu">max</span>([lb, rbmp.objVal])</span>
<span id="cb17-12"><a href="#cb17-12"></a>    </span>
<span id="cb17-13"><a href="#cb17-13"></a>    <span class="bu">print</span>(<span class="ss">f'optimal obj: </span><span class="sc">{</span>rbmp<span class="sc">.</span>objVal<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb17-14"><a href="#cb17-14"></a>    <span class="bu">print</span>(<span class="ss">f'y1 = </span><span class="sc">{</span>y1_opt<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb17-15"><a href="#cb17-15"></a>    <span class="bu">print</span>(<span class="ss">f'y2 = </span><span class="sc">{</span>y2_opt<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb17-16"><a href="#cb17-16"></a>    <span class="bu">print</span>(<span class="ss">f'g = </span><span class="sc">{</span>g_opt<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb17-17"><a href="#cb17-17"></a>    <span class="bu">print</span>(<span class="ss">f'lb=</span><span class="sc">{</span>lb<span class="sc">}</span><span class="ss">, ub=</span><span class="sc">{</span>ub<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb17-18"><a href="#cb17-18"></a><span class="cf">elif</span> rbmp.status <span class="op">==</span> GRB.INFEASIBLE:</span>
<span id="cb17-19"><a href="#cb17-19"></a>    <span class="bu">print</span>(<span class="ss">f'original problem is infeasible!'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that a new lower bound is obtained after solving the master problem. Since there is still a large gap between the lower bound and upper bound, we continue solving the subproblem.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a>dsp.setObjective((<span class="dv">300</span> <span class="op">-</span> <span class="dv">4</span><span class="op">*</span>y1_opt <span class="op">-</span> <span class="dv">5</span><span class="op">*</span>y2_opt) <span class="op">*</span> u1 <span class="op">+</span> (<span class="dv">220</span> <span class="op">-</span> <span class="dv">2</span><span class="op">*</span>y1_opt <span class="op">-</span> <span class="dv">3</span><span class="op">*</span>y2_opt) <span class="op">*</span> u2, GRB.MAXIMIZE)</span>
<span id="cb18-2"><a href="#cb18-2"></a>dsp.update()</span>
<span id="cb18-3"><a href="#cb18-3"></a>dsp.optimize()</span>
<span id="cb18-4"><a href="#cb18-4"></a></span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="cf">if</span> dsp.status <span class="op">==</span> GRB.OPTIMAL:</span>
<span id="cb18-6"><a href="#cb18-6"></a>    u1_opt <span class="op">=</span> u1.X</span>
<span id="cb18-7"><a href="#cb18-7"></a>    u2_opt <span class="op">=</span> u2.X</span>
<span id="cb18-8"><a href="#cb18-8"></a>    </span>
<span id="cb18-9"><a href="#cb18-9"></a>    <span class="bu">print</span>(<span class="ss">f'optimal obj = </span><span class="sc">{</span>dsp<span class="sc">.</span>objVal<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb18-10"><a href="#cb18-10"></a>    <span class="bu">print</span>(<span class="ss">f'u1 = </span><span class="sc">{</span>u1_opt<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb18-11"><a href="#cb18-11"></a>    <span class="bu">print</span>(<span class="ss">f'u2 = </span><span class="sc">{</span>u2_opt<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb18-12"><a href="#cb18-12"></a>    ub <span class="op">=</span> np.<span class="bu">min</span>([ub, <span class="dv">15</span><span class="op">*</span>y1_opt <span class="op">+</span> <span class="dv">18</span><span class="op">*</span>y2_opt <span class="op">+</span> dsp.objVal])</span>
<span id="cb18-13"><a href="#cb18-13"></a>    <span class="bu">print</span>(<span class="ss">f'lb=</span><span class="sc">{</span>lb<span class="sc">}</span><span class="ss">, ub=</span><span class="sc">{</span>ub<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb18-14"><a href="#cb18-14"></a><span class="cf">elif</span> dsp.status <span class="op">==</span> GRB.UNBOUNDED:</span>
<span id="cb18-15"><a href="#cb18-15"></a>    <span class="bu">print</span>(<span class="ss">f'dual subproblem is unbounded!'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now the upper bound is reduced to 1133.33, but the subproblem optimal solution is still bigger than the value of <span class="math inline">\(\bar{g} = 0\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a>rbmp.addConstr((<span class="dv">300</span> <span class="op">-</span> <span class="dv">4</span><span class="op">*</span>y1 <span class="op">-</span> <span class="dv">5</span><span class="op">*</span>y2) <span class="op">*</span> u1_opt <span class="op">+</span> (<span class="dv">220</span> <span class="op">-</span> <span class="dv">2</span><span class="op">*</span>y1 <span class="op">-</span> <span class="dv">3</span><span class="op">*</span>y2) <span class="op">*</span> u2_opt <span class="op">&lt;=</span> g, name<span class="op">=</span><span class="st">'c3'</span>)</span>
<span id="cb19-2"><a href="#cb19-2"></a>rbmp.update()</span>
<span id="cb19-3"><a href="#cb19-3"></a>rbmp.optimize()</span>
<span id="cb19-4"><a href="#cb19-4"></a></span>
<span id="cb19-5"><a href="#cb19-5"></a><span class="cf">if</span> rbmp.status <span class="op">==</span> GRB.OPTIMAL:</span>
<span id="cb19-6"><a href="#cb19-6"></a>    <span class="bu">print</span>(<span class="ss">f'optimal solution found!'</span>)</span>
<span id="cb19-7"><a href="#cb19-7"></a>    </span>
<span id="cb19-8"><a href="#cb19-8"></a>    y1_opt <span class="op">=</span> y1.X</span>
<span id="cb19-9"><a href="#cb19-9"></a>    y2_opt <span class="op">=</span> y2.X</span>
<span id="cb19-10"><a href="#cb19-10"></a>    g_opt <span class="op">=</span> g.X</span>
<span id="cb19-11"><a href="#cb19-11"></a>    lb <span class="op">=</span> np.<span class="bu">max</span>([lb, rbmp.objVal])</span>
<span id="cb19-12"><a href="#cb19-12"></a>    </span>
<span id="cb19-13"><a href="#cb19-13"></a>    <span class="bu">print</span>(<span class="ss">f'optimal obj: </span><span class="sc">{</span>rbmp<span class="sc">.</span>objVal<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb19-14"><a href="#cb19-14"></a>    <span class="bu">print</span>(<span class="ss">f'y1 = </span><span class="sc">{</span>y1_opt<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb19-15"><a href="#cb19-15"></a>    <span class="bu">print</span>(<span class="ss">f'y2 = </span><span class="sc">{</span>y2_opt<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb19-16"><a href="#cb19-16"></a>    <span class="bu">print</span>(<span class="ss">f'g = </span><span class="sc">{</span>g_opt<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb19-17"><a href="#cb19-17"></a>    <span class="bu">print</span>(<span class="ss">f'lb=</span><span class="sc">{</span>lb<span class="sc">}</span><span class="ss">, ub=</span><span class="sc">{</span>ub<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb19-18"><a href="#cb19-18"></a><span class="cf">elif</span> rbmp.status <span class="op">==</span> GRB.INFEASIBLE:</span>
<span id="cb19-19"><a href="#cb19-19"></a>    <span class="bu">print</span>(<span class="ss">f'original problem is infeasible!'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a>dsp.setObjective((<span class="dv">300</span> <span class="op">-</span> <span class="dv">4</span><span class="op">*</span>y1_opt <span class="op">-</span> <span class="dv">5</span><span class="op">*</span>y2_opt) <span class="op">*</span> u1 <span class="op">+</span> (<span class="dv">220</span> <span class="op">-</span> <span class="dv">2</span><span class="op">*</span>y1_opt <span class="op">-</span> <span class="dv">3</span><span class="op">*</span>y2_opt) <span class="op">*</span> u2, GRB.MAXIMIZE)</span>
<span id="cb20-2"><a href="#cb20-2"></a>dsp.update()</span>
<span id="cb20-3"><a href="#cb20-3"></a>dsp.optimize()</span>
<span id="cb20-4"><a href="#cb20-4"></a></span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="cf">if</span> dsp.status <span class="op">==</span> GRB.OPTIMAL:</span>
<span id="cb20-6"><a href="#cb20-6"></a>    u1_opt <span class="op">=</span> u1.X</span>
<span id="cb20-7"><a href="#cb20-7"></a>    u2_opt <span class="op">=</span> u2.X</span>
<span id="cb20-8"><a href="#cb20-8"></a>    </span>
<span id="cb20-9"><a href="#cb20-9"></a>    <span class="bu">print</span>(<span class="ss">f'optimal obj = </span><span class="sc">{</span>dsp<span class="sc">.</span>objVal<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb20-10"><a href="#cb20-10"></a>    <span class="bu">print</span>(<span class="ss">f'u1 = </span><span class="sc">{</span>u1_opt<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb20-11"><a href="#cb20-11"></a>    <span class="bu">print</span>(<span class="ss">f'u2 = </span><span class="sc">{</span>u2_opt<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb20-12"><a href="#cb20-12"></a>    ub <span class="op">=</span> np.<span class="bu">min</span>([ub, <span class="dv">15</span><span class="op">*</span>y1_opt <span class="op">+</span> <span class="dv">18</span><span class="op">*</span>y2_opt <span class="op">+</span> dsp.objVal])</span>
<span id="cb20-13"><a href="#cb20-13"></a>    <span class="bu">print</span>(<span class="ss">f'lb=</span><span class="sc">{</span>lb<span class="sc">}</span><span class="ss">, ub=</span><span class="sc">{</span>ub<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb20-14"><a href="#cb20-14"></a><span class="cf">elif</span> dsp.status <span class="op">==</span> GRB.UNBOUNDED:</span>
<span id="cb20-15"><a href="#cb20-15"></a>    <span class="bu">print</span>(<span class="ss">f'dual subproblem is unbounded!'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now the gap between the lower bound and upper bound is reduced to 0, the problem completes.</p>
</section>
<section id="putting-it-together" class="level3" data-number="4.2.5">
<h3 data-number="4.2.5" class="anchored" data-anchor-id="putting-it-together"><span class="header-section-number">4.2.5</span> Putting it together</h3>
<p>Certainly we donâ€™t want to manually control the interaction between the master problem and subproblem to find the optimal solution. Therefore, in this section, we will put every together to come up with a control flow to help us identify the optimal solution automatically.</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1"></a><span class="im">import</span> gurobipy <span class="im">as</span> gp</span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="im">from</span> gurobipy <span class="im">import</span> GRB</span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb21-4"><a href="#cb21-4"></a><span class="im">from</span> enum <span class="im">import</span> Enum</span>
<span id="cb21-5"><a href="#cb21-5"></a></span>
<span id="cb21-6"><a href="#cb21-6"></a><span class="kw">class</span> OptStatus(Enum):</span>
<span id="cb21-7"><a href="#cb21-7"></a>    OPTIMAL <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb21-8"><a href="#cb21-8"></a>    UNBOUNDED <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb21-9"><a href="#cb21-9"></a>    INFEASIBLE <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb21-10"><a href="#cb21-10"></a>    ERROR <span class="op">=</span> <span class="dv">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a><span class="kw">class</span> MasterSolver:</span>
<span id="cb22-2"><a href="#cb22-2"></a>    </span>
<span id="cb22-3"><a href="#cb22-3"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, env):</span>
<span id="cb22-4"><a href="#cb22-4"></a>        <span class="va">self</span>._model <span class="op">=</span> gp.Model(env<span class="op">=</span>env, name<span class="op">=</span><span class="st">'RBMP'</span>)</span>
<span id="cb22-5"><a href="#cb22-5"></a>        </span>
<span id="cb22-6"><a href="#cb22-6"></a>        <span class="co"># create decision variables</span></span>
<span id="cb22-7"><a href="#cb22-7"></a>        <span class="va">self</span>._y1 <span class="op">=</span> <span class="va">self</span>._model.addVar(vtype<span class="op">=</span>GRB.CONTINUOUS, lb<span class="op">=</span><span class="dv">0</span>, name<span class="op">=</span><span class="st">'y1'</span>)</span>
<span id="cb22-8"><a href="#cb22-8"></a>        <span class="va">self</span>._y2 <span class="op">=</span> <span class="va">self</span>._model.addVar(vtype<span class="op">=</span>GRB.CONTINUOUS, lb<span class="op">=</span><span class="dv">0</span>, name<span class="op">=</span><span class="st">'y2'</span>)</span>
<span id="cb22-9"><a href="#cb22-9"></a>        <span class="va">self</span>._g <span class="op">=</span> <span class="va">self</span>._model.addVar(vtype<span class="op">=</span>GRB.CONTINUOUS, lb<span class="op">=</span><span class="dv">0</span>, name<span class="op">=</span><span class="st">'g'</span>)</span>
<span id="cb22-10"><a href="#cb22-10"></a></span>
<span id="cb22-11"><a href="#cb22-11"></a>        <span class="co"># create objective</span></span>
<span id="cb22-12"><a href="#cb22-12"></a>        <span class="va">self</span>._model.setObjective(<span class="dv">15</span><span class="op">*</span><span class="va">self</span>._y1 <span class="op">+</span> <span class="dv">18</span><span class="op">*</span><span class="va">self</span>._y2 <span class="op">+</span> <span class="va">self</span>._g, GRB.MINIMIZE)</span>
<span id="cb22-13"><a href="#cb22-13"></a>        </span>
<span id="cb22-14"><a href="#cb22-14"></a>        <span class="va">self</span>._opt_obj <span class="op">=</span> <span class="va">None</span></span>
<span id="cb22-15"><a href="#cb22-15"></a>        <span class="va">self</span>._opt_y1 <span class="op">=</span> <span class="va">None</span></span>
<span id="cb22-16"><a href="#cb22-16"></a>        <span class="va">self</span>._opt_y2 <span class="op">=</span> <span class="va">None</span></span>
<span id="cb22-17"><a href="#cb22-17"></a>        <span class="va">self</span>._opt_g <span class="op">=</span> <span class="va">None</span></span>
<span id="cb22-18"><a href="#cb22-18"></a>        </span>
<span id="cb22-19"><a href="#cb22-19"></a>    <span class="kw">def</span> solve(<span class="va">self</span>) <span class="op">-&gt;</span> OptStatus:</span>
<span id="cb22-20"><a href="#cb22-20"></a>        <span class="bu">print</span>(<span class="st">'-'</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb22-21"><a href="#cb22-21"></a>        <span class="bu">print</span>(<span class="ss">f'Start solving master problem.'</span>)</span>
<span id="cb22-22"><a href="#cb22-22"></a>        <span class="va">self</span>._model.optimize()</span>
<span id="cb22-23"><a href="#cb22-23"></a>        </span>
<span id="cb22-24"><a href="#cb22-24"></a>        opt_status <span class="op">=</span> <span class="va">None</span></span>
<span id="cb22-25"><a href="#cb22-25"></a>        <span class="cf">if</span> <span class="va">self</span>._model.status <span class="op">==</span> GRB.OPTIMAL:</span>
<span id="cb22-26"><a href="#cb22-26"></a>            opt_status <span class="op">=</span> OptStatus.OPTIMAL</span>
<span id="cb22-27"><a href="#cb22-27"></a>            <span class="va">self</span>._opt_obj <span class="op">=</span> <span class="va">self</span>._model.objVal</span>
<span id="cb22-28"><a href="#cb22-28"></a>            <span class="va">self</span>._opt_y1 <span class="op">=</span> <span class="va">self</span>._y1.X</span>
<span id="cb22-29"><a href="#cb22-29"></a>            <span class="va">self</span>._opt_y2 <span class="op">=</span> <span class="va">self</span>._y2.X</span>
<span id="cb22-30"><a href="#cb22-30"></a>            <span class="va">self</span>._opt_g <span class="op">=</span> <span class="va">self</span>._g.X</span>
<span id="cb22-31"><a href="#cb22-31"></a>            <span class="bu">print</span>(<span class="ss">f'</span><span class="ch">\t</span><span class="ss">master problem is optimal.'</span>)</span>
<span id="cb22-32"><a href="#cb22-32"></a>            <span class="bu">print</span>(<span class="ss">f'</span><span class="ch">\t</span><span class="ss">opt_obj=</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>_opt_obj<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb22-33"><a href="#cb22-33"></a>            <span class="bu">print</span>(<span class="ss">f'</span><span class="ch">\t</span><span class="ss">opt_y1=</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>_opt_y1<span class="sc">:.2f}</span><span class="ss">, opt_y2=</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>_opt_y2<span class="sc">:.2f}</span><span class="ss">, opt_g=</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>_opt_g<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb22-34"><a href="#cb22-34"></a>        <span class="cf">elif</span> <span class="va">self</span>._model.status <span class="op">==</span> GRB.INFEASIBLE:</span>
<span id="cb22-35"><a href="#cb22-35"></a>            <span class="bu">print</span>(<span class="ss">f'</span><span class="ch">\t</span><span class="ss">master problem is infeasible.'</span>)</span>
<span id="cb22-36"><a href="#cb22-36"></a>            opt_status <span class="op">=</span> OptStatus.INFEASIBLE</span>
<span id="cb22-37"><a href="#cb22-37"></a>        <span class="cf">else</span>:</span>
<span id="cb22-38"><a href="#cb22-38"></a>            <span class="bu">print</span>(<span class="ss">f'</span><span class="ch">\t</span><span class="ss">master problem encountered error.'</span>)</span>
<span id="cb22-39"><a href="#cb22-39"></a>            opt_status <span class="op">=</span> OptStatus.ERROR</span>
<span id="cb22-40"><a href="#cb22-40"></a>        </span>
<span id="cb22-41"><a href="#cb22-41"></a>        <span class="bu">print</span>(<span class="ss">f'Finish solving master problem.'</span>) </span>
<span id="cb22-42"><a href="#cb22-42"></a>        <span class="bu">print</span>(<span class="st">'-'</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb22-43"><a href="#cb22-43"></a>        <span class="cf">return</span> opt_status</span>
<span id="cb22-44"><a href="#cb22-44"></a>    </span>
<span id="cb22-45"><a href="#cb22-45"></a>    <span class="kw">def</span> add_feasibility_cut(<span class="va">self</span>, opt_u1, opt_u2) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb22-46"><a href="#cb22-46"></a>        <span class="va">self</span>._model.addConstr((<span class="dv">300</span> <span class="op">-</span> <span class="dv">4</span><span class="op">*</span><span class="va">self</span>._y1 <span class="op">-</span> <span class="dv">5</span><span class="op">*</span><span class="va">self</span>._y2) <span class="op">*</span> opt_u1 <span class="op">+</span> </span>
<span id="cb22-47"><a href="#cb22-47"></a>                              (<span class="dv">220</span> <span class="op">-</span> <span class="dv">2</span><span class="op">*</span><span class="va">self</span>._y1 <span class="op">-</span> <span class="dv">3</span><span class="op">*</span><span class="va">self</span>._y2) <span class="op">*</span> opt_u2 <span class="op">&lt;=</span> <span class="dv">0</span>)</span>
<span id="cb22-48"><a href="#cb22-48"></a>        <span class="bu">print</span>(<span class="ss">f'Benders feasibility cut added!'</span>)</span>
<span id="cb22-49"><a href="#cb22-49"></a>    </span>
<span id="cb22-50"><a href="#cb22-50"></a>    <span class="kw">def</span> add_optimality_cut(<span class="va">self</span>, opt_u1, opt_u2) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb22-51"><a href="#cb22-51"></a>        <span class="va">self</span>._model.addConstr((<span class="dv">300</span> <span class="op">-</span> <span class="dv">4</span><span class="op">*</span><span class="va">self</span>._y1 <span class="op">-</span> <span class="dv">5</span><span class="op">*</span><span class="va">self</span>._y2) <span class="op">*</span> opt_u1 <span class="op">+</span> </span>
<span id="cb22-52"><a href="#cb22-52"></a>                              (<span class="dv">220</span> <span class="op">-</span> <span class="dv">2</span><span class="op">*</span><span class="va">self</span>._y1 <span class="op">-</span> <span class="dv">3</span><span class="op">*</span><span class="va">self</span>._y2) <span class="op">*</span> opt_u2 <span class="op">&lt;=</span> <span class="va">self</span>._g)</span>
<span id="cb22-53"><a href="#cb22-53"></a>        <span class="bu">print</span>(<span class="ss">f'Benders optimality cut added!'</span>)</span>
<span id="cb22-54"><a href="#cb22-54"></a>    </span>
<span id="cb22-55"><a href="#cb22-55"></a>    <span class="kw">def</span> clean_up(<span class="va">self</span>):</span>
<span id="cb22-56"><a href="#cb22-56"></a>        <span class="va">self</span>._model.dispose()</span>
<span id="cb22-57"><a href="#cb22-57"></a>        </span>
<span id="cb22-58"><a href="#cb22-58"></a>    <span class="at">@property</span></span>
<span id="cb22-59"><a href="#cb22-59"></a>    <span class="kw">def</span> opt_obj(<span class="va">self</span>):</span>
<span id="cb22-60"><a href="#cb22-60"></a>        <span class="cf">return</span> <span class="va">self</span>._opt_obj</span>
<span id="cb22-61"><a href="#cb22-61"></a>    </span>
<span id="cb22-62"><a href="#cb22-62"></a>    <span class="at">@property</span></span>
<span id="cb22-63"><a href="#cb22-63"></a>    <span class="kw">def</span> opt_y1(<span class="va">self</span>):</span>
<span id="cb22-64"><a href="#cb22-64"></a>        <span class="cf">return</span> <span class="va">self</span>._opt_y1</span>
<span id="cb22-65"><a href="#cb22-65"></a>    </span>
<span id="cb22-66"><a href="#cb22-66"></a>    <span class="at">@property</span></span>
<span id="cb22-67"><a href="#cb22-67"></a>    <span class="kw">def</span> opt_y2(<span class="va">self</span>):</span>
<span id="cb22-68"><a href="#cb22-68"></a>        <span class="cf">return</span> <span class="va">self</span>._opt_y2</span>
<span id="cb22-69"><a href="#cb22-69"></a>    </span>
<span id="cb22-70"><a href="#cb22-70"></a>    <span class="at">@property</span></span>
<span id="cb22-71"><a href="#cb22-71"></a>    <span class="kw">def</span> opt_g(<span class="va">self</span>):</span>
<span id="cb22-72"><a href="#cb22-72"></a>        <span class="cf">return</span> <span class="va">self</span>._g</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1"></a><span class="kw">class</span> DualSubprobSolver:</span>
<span id="cb23-2"><a href="#cb23-2"></a>    </span>
<span id="cb23-3"><a href="#cb23-3"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, env):</span>
<span id="cb23-4"><a href="#cb23-4"></a>        <span class="va">self</span>._model <span class="op">=</span> gp.Model(env<span class="op">=</span>env, name<span class="op">=</span><span class="st">'DSP'</span>)</span>
<span id="cb23-5"><a href="#cb23-5"></a>        </span>
<span id="cb23-6"><a href="#cb23-6"></a>        <span class="co"># create decision variables</span></span>
<span id="cb23-7"><a href="#cb23-7"></a>        <span class="va">self</span>._u1 <span class="op">=</span> <span class="va">self</span>._model.addVar(vtype<span class="op">=</span>GRB.CONTINUOUS, name<span class="op">=</span><span class="st">'u1'</span>)</span>
<span id="cb23-8"><a href="#cb23-8"></a>        <span class="va">self</span>._u2 <span class="op">=</span> <span class="va">self</span>._model.addVar(vtype<span class="op">=</span>GRB.CONTINUOUS, name<span class="op">=</span><span class="st">'u2'</span>)</span>
<span id="cb23-9"><a href="#cb23-9"></a>        </span>
<span id="cb23-10"><a href="#cb23-10"></a>        <span class="co"># create constraints</span></span>
<span id="cb23-11"><a href="#cb23-11"></a>        <span class="va">self</span>._model.addConstr(<span class="dv">2</span><span class="op">*</span><span class="va">self</span>._u1 <span class="op">+</span> <span class="dv">4</span><span class="op">*</span><span class="va">self</span>._u2 <span class="op">&lt;=</span> <span class="dv">8</span>, name<span class="op">=</span><span class="st">'c1'</span>)</span>
<span id="cb23-12"><a href="#cb23-12"></a>        <span class="va">self</span>._model.addConstr(<span class="dv">3</span><span class="op">*</span><span class="va">self</span>._u1 <span class="op">+</span> <span class="dv">2</span><span class="op">*</span><span class="va">self</span>._u2 <span class="op">&lt;=</span> <span class="dv">12</span>, name<span class="op">=</span><span class="st">'c2'</span>)</span>
<span id="cb23-13"><a href="#cb23-13"></a>        <span class="va">self</span>._model.addConstr(<span class="dv">2</span><span class="op">*</span><span class="va">self</span>._u1 <span class="op">+</span> <span class="dv">3</span><span class="op">*</span><span class="va">self</span>._u2 <span class="op">&lt;=</span> <span class="dv">10</span>, name<span class="op">=</span><span class="st">'c3'</span>)</span>
<span id="cb23-14"><a href="#cb23-14"></a>        </span>
<span id="cb23-15"><a href="#cb23-15"></a>        <span class="va">self</span>._model.setObjective(<span class="dv">1</span>, GRB.MAXIMIZE)</span>
<span id="cb23-16"><a href="#cb23-16"></a>        <span class="va">self</span>._model.update()</span>
<span id="cb23-17"><a href="#cb23-17"></a>        </span>
<span id="cb23-18"><a href="#cb23-18"></a>        <span class="va">self</span>._opt_obj <span class="op">=</span> <span class="va">None</span></span>
<span id="cb23-19"><a href="#cb23-19"></a>        <span class="va">self</span>._opt_u1 <span class="op">=</span> <span class="va">None</span></span>
<span id="cb23-20"><a href="#cb23-20"></a>        <span class="va">self</span>._opt_u2 <span class="op">=</span> <span class="va">None</span></span>
<span id="cb23-21"><a href="#cb23-21"></a>    </span>
<span id="cb23-22"><a href="#cb23-22"></a>    <span class="kw">def</span> solve(<span class="va">self</span>):</span>
<span id="cb23-23"><a href="#cb23-23"></a>        <span class="bu">print</span>(<span class="st">'-'</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb23-24"><a href="#cb23-24"></a>        <span class="bu">print</span>(<span class="ss">f'Start solving dual subproblem.'</span>)</span>
<span id="cb23-25"><a href="#cb23-25"></a>        <span class="va">self</span>._model.optimize()</span>
<span id="cb23-26"><a href="#cb23-26"></a>        </span>
<span id="cb23-27"><a href="#cb23-27"></a>        status <span class="op">=</span> <span class="va">None</span></span>
<span id="cb23-28"><a href="#cb23-28"></a>        <span class="cf">if</span> <span class="va">self</span>._model.status <span class="op">==</span> GRB.OPTIMAL:</span>
<span id="cb23-29"><a href="#cb23-29"></a>            <span class="va">self</span>._opt_obj <span class="op">=</span> <span class="va">self</span>._model.objVal</span>
<span id="cb23-30"><a href="#cb23-30"></a>            <span class="va">self</span>._opt_u1 <span class="op">=</span> <span class="va">self</span>._u1.X</span>
<span id="cb23-31"><a href="#cb23-31"></a>            <span class="va">self</span>._opt_u2 <span class="op">=</span> <span class="va">self</span>._u2.X</span>
<span id="cb23-32"><a href="#cb23-32"></a>            status <span class="op">=</span> OptStatus.OPTIMAL</span>
<span id="cb23-33"><a href="#cb23-33"></a>            <span class="bu">print</span>(<span class="ss">f'</span><span class="ch">\t</span><span class="ss">dual subproblem is optimal.'</span>)</span>
<span id="cb23-34"><a href="#cb23-34"></a>            <span class="bu">print</span>(<span class="ss">f'</span><span class="ch">\t</span><span class="ss">opt_obj=</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>_opt_obj<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb23-35"><a href="#cb23-35"></a>            <span class="bu">print</span>(<span class="ss">f'</span><span class="ch">\t</span><span class="ss">opt_y1=</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>_opt_u1<span class="sc">:.2f}</span><span class="ss">, opt_y2=</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>_opt_u2<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb23-36"><a href="#cb23-36"></a>        <span class="cf">elif</span> <span class="va">self</span>._model.status <span class="op">==</span> GRB.UNBOUNDED:</span>
<span id="cb23-37"><a href="#cb23-37"></a>            status <span class="op">=</span> OptStatus.UNBOUNDED</span>
<span id="cb23-38"><a href="#cb23-38"></a>        <span class="cf">else</span>:</span>
<span id="cb23-39"><a href="#cb23-39"></a>            status <span class="op">=</span> OptStatus.ERROR</span>
<span id="cb23-40"><a href="#cb23-40"></a>        </span>
<span id="cb23-41"><a href="#cb23-41"></a>        <span class="bu">print</span>(<span class="ss">f'Finish solving dual subproblem.'</span>)</span>
<span id="cb23-42"><a href="#cb23-42"></a>        <span class="bu">print</span>(<span class="st">'-'</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb23-43"><a href="#cb23-43"></a>        <span class="cf">return</span> status</span>
<span id="cb23-44"><a href="#cb23-44"></a>    </span>
<span id="cb23-45"><a href="#cb23-45"></a>    <span class="kw">def</span> update_objective(<span class="va">self</span>, opt_y1, opt_y2):</span>
<span id="cb23-46"><a href="#cb23-46"></a>        <span class="va">self</span>._model.setObjective((<span class="dv">300</span><span class="op">-</span><span class="dv">4</span><span class="op">*</span>opt_y1<span class="op">-</span><span class="dv">5</span><span class="op">*</span>opt_y2)<span class="op">*</span><span class="va">self</span>._u1 <span class="op">+</span> (<span class="dv">220</span><span class="op">-</span><span class="dv">2</span><span class="op">*</span>opt_y1<span class="op">-</span><span class="dv">3</span><span class="op">*</span>opt_y2)<span class="op">*</span><span class="va">self</span>._u2, GRB.MAXIMIZE)</span>
<span id="cb23-47"><a href="#cb23-47"></a>        <span class="bu">print</span>(<span class="ss">f'dual subproblem objective updated!'</span>)</span>
<span id="cb23-48"><a href="#cb23-48"></a>    </span>
<span id="cb23-49"><a href="#cb23-49"></a>    <span class="kw">def</span> clean_up(<span class="va">self</span>):</span>
<span id="cb23-50"><a href="#cb23-50"></a>        <span class="va">self</span>._model.dispose()</span>
<span id="cb23-51"><a href="#cb23-51"></a>        </span>
<span id="cb23-52"><a href="#cb23-52"></a>    <span class="at">@property</span></span>
<span id="cb23-53"><a href="#cb23-53"></a>    <span class="kw">def</span> opt_obj(<span class="va">self</span>):</span>
<span id="cb23-54"><a href="#cb23-54"></a>        <span class="cf">return</span> <span class="va">self</span>._opt_obj</span>
<span id="cb23-55"><a href="#cb23-55"></a>    </span>
<span id="cb23-56"><a href="#cb23-56"></a>    <span class="at">@property</span></span>
<span id="cb23-57"><a href="#cb23-57"></a>    <span class="kw">def</span> opt_u1(<span class="va">self</span>):</span>
<span id="cb23-58"><a href="#cb23-58"></a>        <span class="cf">return</span> <span class="va">self</span>._opt_u1</span>
<span id="cb23-59"><a href="#cb23-59"></a>    </span>
<span id="cb23-60"><a href="#cb23-60"></a>    <span class="at">@property</span></span>
<span id="cb23-61"><a href="#cb23-61"></a>    <span class="kw">def</span> opt_u2(<span class="va">self</span>):</span>
<span id="cb23-62"><a href="#cb23-62"></a>        <span class="cf">return</span> <span class="va">self</span>._opt_u2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a><span class="kw">class</span> BendersDecomposition:</span>
<span id="cb24-2"><a href="#cb24-2"></a>    </span>
<span id="cb24-3"><a href="#cb24-3"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, master_solver, dual_subprob_solver):</span>
<span id="cb24-4"><a href="#cb24-4"></a>        <span class="va">self</span>._master_solver <span class="op">=</span> master_solver</span>
<span id="cb24-5"><a href="#cb24-5"></a>        <span class="va">self</span>._dual_subprob_solver <span class="op">=</span> dual_subprob_solver</span>
<span id="cb24-6"><a href="#cb24-6"></a>        </span>
<span id="cb24-7"><a href="#cb24-7"></a>    </span>
<span id="cb24-8"><a href="#cb24-8"></a>    <span class="kw">def</span> optimize(<span class="va">self</span>) <span class="op">-&gt;</span> OptStatus:</span>
<span id="cb24-9"><a href="#cb24-9"></a>        eps <span class="op">=</span> <span class="fl">1.0e-5</span></span>
<span id="cb24-10"><a href="#cb24-10"></a>        lb <span class="op">=</span> <span class="op">-</span>np.inf</span>
<span id="cb24-11"><a href="#cb24-11"></a>        ub <span class="op">=</span> np.inf</span>
<span id="cb24-12"><a href="#cb24-12"></a>        </span>
<span id="cb24-13"><a href="#cb24-13"></a>        <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb24-14"><a href="#cb24-14"></a>            <span class="co"># solve master problem</span></span>
<span id="cb24-15"><a href="#cb24-15"></a>            master_status <span class="op">=</span> <span class="va">self</span>._master_solver.solve()</span>
<span id="cb24-16"><a href="#cb24-16"></a>            <span class="cf">if</span> master_status <span class="op">==</span> OptStatus.INFEASIBLE:</span>
<span id="cb24-17"><a href="#cb24-17"></a>                <span class="cf">return</span> OptStatus.INFEASIBLE</span>
<span id="cb24-18"><a href="#cb24-18"></a>            </span>
<span id="cb24-19"><a href="#cb24-19"></a>            <span class="co"># update lower bound</span></span>
<span id="cb24-20"><a href="#cb24-20"></a>            lb <span class="op">=</span> np.<span class="bu">max</span>([lb, <span class="va">self</span>._master_solver.opt_obj])</span>
<span id="cb24-21"><a href="#cb24-21"></a>            <span class="bu">print</span>(<span class="ss">f'Bounds: lb=</span><span class="sc">{</span>lb<span class="sc">:.2f}</span><span class="ss">, ub=</span><span class="sc">{</span>ub<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb24-22"><a href="#cb24-22"></a>            </span>
<span id="cb24-23"><a href="#cb24-23"></a>            opt_y1 <span class="op">=</span> <span class="va">self</span>._master_solver.opt_y1</span>
<span id="cb24-24"><a href="#cb24-24"></a>            opt_y2 <span class="op">=</span> <span class="va">self</span>._master_solver.opt_y2</span>
<span id="cb24-25"><a href="#cb24-25"></a>            </span>
<span id="cb24-26"><a href="#cb24-26"></a>            <span class="co"># solve subproblem</span></span>
<span id="cb24-27"><a href="#cb24-27"></a>            <span class="va">self</span>._dual_subprob_solver.update_objective(opt_y1, opt_y2)</span>
<span id="cb24-28"><a href="#cb24-28"></a>            dsp_status <span class="op">=</span> <span class="va">self</span>._dual_subprob_solver.solve()</span>
<span id="cb24-29"><a href="#cb24-29"></a>            </span>
<span id="cb24-30"><a href="#cb24-30"></a>            <span class="cf">if</span> dsp_status <span class="op">==</span> OptStatus.OPTIMAL:</span>
<span id="cb24-31"><a href="#cb24-31"></a>                <span class="co"># update upper bound</span></span>
<span id="cb24-32"><a href="#cb24-32"></a>                opt_obj <span class="op">=</span> <span class="va">self</span>._dual_subprob_solver.opt_obj</span>
<span id="cb24-33"><a href="#cb24-33"></a>                ub <span class="op">=</span> np.<span class="bu">min</span>([ub, <span class="dv">15</span><span class="op">*</span>opt_y1 <span class="op">+</span> <span class="dv">18</span><span class="op">*</span>opt_y2 <span class="op">+</span> opt_obj])</span>
<span id="cb24-34"><a href="#cb24-34"></a>                <span class="bu">print</span>(<span class="ss">f'Bounds: lb=</span><span class="sc">{</span>lb<span class="sc">:.2f}</span><span class="ss">, ub=</span><span class="sc">{</span>ub<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb24-35"><a href="#cb24-35"></a>                </span>
<span id="cb24-36"><a href="#cb24-36"></a>                <span class="cf">if</span> ub <span class="op">-</span> lb <span class="op">&lt;=</span> eps:</span>
<span id="cb24-37"><a href="#cb24-37"></a>                    <span class="cf">break</span></span>
<span id="cb24-38"><a href="#cb24-38"></a>                </span>
<span id="cb24-39"><a href="#cb24-39"></a>                opt_u1 <span class="op">=</span> <span class="va">self</span>._dual_subprob_solver.opt_u1</span>
<span id="cb24-40"><a href="#cb24-40"></a>                opt_u2 <span class="op">=</span> <span class="va">self</span>._dual_subprob_solver.opt_u2</span>
<span id="cb24-41"><a href="#cb24-41"></a>                <span class="va">self</span>._master_solver.add_optimality_cut(opt_u1, opt_u2) </span>
<span id="cb24-42"><a href="#cb24-42"></a>            <span class="cf">elif</span> dsp_status <span class="op">==</span> OptStatus.UNBOUNDED:</span>
<span id="cb24-43"><a href="#cb24-43"></a>                opt_u1 <span class="op">=</span> <span class="va">self</span>._dual_subprob_solver.opt_u1</span>
<span id="cb24-44"><a href="#cb24-44"></a>                opt_u2 <span class="op">=</span> <span class="va">self</span>._dual_subprob_solver.opt_u2</span>
<span id="cb24-45"><a href="#cb24-45"></a>                <span class="va">self</span>._master_solver.add_feasibility_cut(opt_u1, opt_u2) </span>
<span id="cb24-46"><a href="#cb24-46"></a>            </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1"></a>env <span class="op">=</span> gp.Env(<span class="st">'benders'</span>)</span>
<span id="cb25-2"><a href="#cb25-2"></a>env.setParam(<span class="st">"OutputFlag"</span>,<span class="dv">0</span>)</span>
<span id="cb25-3"><a href="#cb25-3"></a>master_solver <span class="op">=</span> MasterSolver(env)</span>
<span id="cb25-4"><a href="#cb25-4"></a>dual_subprob_solver <span class="op">=</span> DualSubprobSolver(env)</span>
<span id="cb25-5"><a href="#cb25-5"></a></span>
<span id="cb25-6"><a href="#cb25-6"></a>benders_decomposition <span class="op">=</span> BendersDecomposition(master_solver, dual_subprob_solver)</span>
<span id="cb25-7"><a href="#cb25-7"></a>benders_decomposition.optimize()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Set parameter Username
Set parameter LogFile to value "benders"
--------------------------------------------------
Start solving master problem.
    master problem is optimal.
    opt_obj=0.00
    opt_y1=0.00, opt_y2=0.00, opt_g=0.00
Finish solving master problem.
--------------------------------------------------
Bounds: lb=0.00, ub=inf
dual subproblem objective updated!
--------------------------------------------------
Start solving dual subproblem.
    dual subproblem is optimal.
    opt_obj=1200.00
    opt_y1=4.00, opt_y2=0.00
Finish solving dual subproblem.
--------------------------------------------------
Bounds: lb=0.00, ub=1200.00
Benders optimality cut added!
--------------------------------------------------
Start solving master problem.
    master problem is optimal.
    opt_obj=1080.00
    opt_y1=0.00, opt_y2=60.00, opt_g=0.00
Finish solving master problem.
--------------------------------------------------
Bounds: lb=1080.00, ub=1200.00
dual subproblem objective updated!
--------------------------------------------------
Start solving dual subproblem.
    dual subproblem is optimal.
    opt_obj=80.00
    opt_y1=0.00, opt_y2=2.00
Finish solving dual subproblem.
--------------------------------------------------
Bounds: lb=1080.00, ub=1160.00
Benders optimality cut added!
--------------------------------------------------
Start solving master problem.
    master problem is optimal.
    opt_obj=1091.43
    opt_y1=0.00, opt_y2=54.29, opt_g=114.29
Finish solving master problem.
--------------------------------------------------
Bounds: lb=1091.43, ub=1160.00
dual subproblem objective updated!
--------------------------------------------------
Start solving dual subproblem.
    dual subproblem is optimal.
    opt_obj=114.29
    opt_y1=0.00, opt_y2=2.00
Finish solving dual subproblem.
--------------------------------------------------
Bounds: lb=1091.43, ub=1091.43</code></pre>
</div>
</div>
</section>
<section id="a-generic-solver" class="level3" data-number="4.2.6">
<h3 data-number="4.2.6" class="anchored" data-anchor-id="a-generic-solver"><span class="header-section-number">4.2.6</span> A generic solver</h3>
<p>In this section, we will create a more generic Benders decomposition based solver for linear programming problems.</p>
<div class="cell" data-execution_count="155">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1"></a><span class="kw">class</span> GenericLpMasterSolver:</span>
<span id="cb27-2"><a href="#cb27-2"></a>    </span>
<span id="cb27-3"><a href="#cb27-3"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, f: np.array, B: np.array, b: np.array):</span>
<span id="cb27-4"><a href="#cb27-4"></a>        <span class="co"># save data</span></span>
<span id="cb27-5"><a href="#cb27-5"></a>        <span class="va">self</span>._f <span class="op">=</span> f</span>
<span id="cb27-6"><a href="#cb27-6"></a>        <span class="va">self</span>._B <span class="op">=</span> B</span>
<span id="cb27-7"><a href="#cb27-7"></a>        <span class="va">self</span>._b <span class="op">=</span> b </span>
<span id="cb27-8"><a href="#cb27-8"></a>        </span>
<span id="cb27-9"><a href="#cb27-9"></a>        <span class="co"># env and model</span></span>
<span id="cb27-10"><a href="#cb27-10"></a>        <span class="va">self</span>._env <span class="op">=</span> gp.Env(<span class="st">'MasterEnv'</span>)</span>
<span id="cb27-11"><a href="#cb27-11"></a>        <span class="co"># self._env.setParam("OutputFlag",0)</span></span>
<span id="cb27-12"><a href="#cb27-12"></a>        <span class="va">self</span>._model <span class="op">=</span> gp.Model(env<span class="op">=</span><span class="va">self</span>._env, name<span class="op">=</span><span class="st">'MasterSolver'</span>)</span>
<span id="cb27-13"><a href="#cb27-13"></a>        </span>
<span id="cb27-14"><a href="#cb27-14"></a>        <span class="co"># create variables</span></span>
<span id="cb27-15"><a href="#cb27-15"></a>        <span class="va">self</span>._num_y_vars <span class="op">=</span> <span class="bu">len</span>(f)</span>
<span id="cb27-16"><a href="#cb27-16"></a>        <span class="va">self</span>._y <span class="op">=</span> <span class="va">self</span>._model.addVars(<span class="va">self</span>._num_y_vars, lb<span class="op">=</span><span class="dv">0</span>, vtype<span class="op">=</span>GRB.CONTINUOUS, name<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb27-17"><a href="#cb27-17"></a>        <span class="va">self</span>._g <span class="op">=</span> <span class="va">self</span>._model.addVar(vtype<span class="op">=</span>GRB.CONTINUOUS, lb<span class="op">=</span><span class="dv">0</span>, name<span class="op">=</span><span class="st">'g'</span>)</span>
<span id="cb27-18"><a href="#cb27-18"></a>        </span>
<span id="cb27-19"><a href="#cb27-19"></a>        <span class="co"># create objective</span></span>
<span id="cb27-20"><a href="#cb27-20"></a>        <span class="va">self</span>._model.setObjective(gp.quicksum(<span class="va">self</span>._f[i] <span class="op">*</span> <span class="va">self</span>._y.get(i) </span>
<span id="cb27-21"><a href="#cb27-21"></a>                                             <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>._num_y_vars)) <span class="op">+</span> <span class="va">self</span>._g, </span>
<span id="cb27-22"><a href="#cb27-22"></a>                                 GRB.MINIMIZE)</span>
<span id="cb27-23"><a href="#cb27-23"></a>        <span class="va">self</span>._model.update()</span>
<span id="cb27-24"><a href="#cb27-24"></a>        </span>
<span id="cb27-25"><a href="#cb27-25"></a>        <span class="va">self</span>._opt_obj <span class="op">=</span> <span class="va">None</span></span>
<span id="cb27-26"><a href="#cb27-26"></a>        <span class="va">self</span>._opt_obj_y <span class="op">=</span> <span class="va">None</span></span>
<span id="cb27-27"><a href="#cb27-27"></a>        <span class="va">self</span>._opt_y <span class="op">=</span> <span class="va">None</span></span>
<span id="cb27-28"><a href="#cb27-28"></a>        <span class="va">self</span>._opt_g <span class="op">=</span> <span class="va">None</span></span>
<span id="cb27-29"><a href="#cb27-29"></a>        </span>
<span id="cb27-30"><a href="#cb27-30"></a>    <span class="kw">def</span> solve(<span class="va">self</span>) <span class="op">-&gt;</span> OptStatus:</span>
<span id="cb27-31"><a href="#cb27-31"></a>        <span class="bu">print</span>(<span class="st">'-'</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb27-32"><a href="#cb27-32"></a>        <span class="bu">print</span>(<span class="ss">f'Start solving master problem.'</span>)</span>
<span id="cb27-33"><a href="#cb27-33"></a>        <span class="bu">print</span>(<span class="va">self</span>._model.display())</span>
<span id="cb27-34"><a href="#cb27-34"></a>        <span class="va">self</span>._model.optimize()</span>
<span id="cb27-35"><a href="#cb27-35"></a>        </span>
<span id="cb27-36"><a href="#cb27-36"></a>        opt_status <span class="op">=</span> <span class="va">None</span></span>
<span id="cb27-37"><a href="#cb27-37"></a>        <span class="cf">if</span> <span class="va">self</span>._model.status <span class="op">==</span> GRB.OPTIMAL:</span>
<span id="cb27-38"><a href="#cb27-38"></a>            opt_status <span class="op">=</span> OptStatus.OPTIMAL</span>
<span id="cb27-39"><a href="#cb27-39"></a>            <span class="va">self</span>._opt_obj <span class="op">=</span> <span class="va">self</span>._model.objVal</span>
<span id="cb27-40"><a href="#cb27-40"></a>            <span class="va">self</span>._opt_y <span class="op">=</span> {</span>
<span id="cb27-41"><a href="#cb27-41"></a>                i: <span class="va">self</span>._y.get(i).X</span>
<span id="cb27-42"><a href="#cb27-42"></a>                <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>._num_y_vars)</span>
<span id="cb27-43"><a href="#cb27-43"></a>            }</span>
<span id="cb27-44"><a href="#cb27-44"></a>            <span class="va">self</span>._opt_g <span class="op">=</span> <span class="va">self</span>._g.X</span>
<span id="cb27-45"><a href="#cb27-45"></a>            <span class="va">self</span>._opt_obj_y <span class="op">=</span> <span class="va">self</span>._opt_obj <span class="op">-</span> <span class="va">self</span>._opt_g</span>
<span id="cb27-46"><a href="#cb27-46"></a>            <span class="bu">print</span>(<span class="ss">f'</span><span class="ch">\t</span><span class="ss">master problem is optimal.'</span>)</span>
<span id="cb27-47"><a href="#cb27-47"></a>            <span class="bu">print</span>(<span class="ss">f'</span><span class="ch">\t</span><span class="ss">opt_obj=</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>_opt_obj<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb27-48"><a href="#cb27-48"></a>            <span class="bu">print</span>(<span class="ss">f'</span><span class="ch">\t</span><span class="ss">opt_g=</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>_opt_g<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb27-49"><a href="#cb27-49"></a>            <span class="co"># for i in range(self._num_y_vars):</span></span>
<span id="cb27-50"><a href="#cb27-50"></a>            <span class="co">#     print(f'\topt_y{i}={self._opt_y.get(i)}')</span></span>
<span id="cb27-51"><a href="#cb27-51"></a>        <span class="cf">elif</span> <span class="va">self</span>._model.status <span class="op">==</span> GRB.INFEASIBLE:</span>
<span id="cb27-52"><a href="#cb27-52"></a>            <span class="bu">print</span>(<span class="ss">f'</span><span class="ch">\t</span><span class="ss">master problem is infeasible.'</span>)</span>
<span id="cb27-53"><a href="#cb27-53"></a>            opt_status <span class="op">=</span> OptStatus.INFEASIBLE</span>
<span id="cb27-54"><a href="#cb27-54"></a>        <span class="cf">else</span>:</span>
<span id="cb27-55"><a href="#cb27-55"></a>            <span class="bu">print</span>(<span class="ss">f'</span><span class="ch">\t</span><span class="ss">master problem encountered error.'</span>)</span>
<span id="cb27-56"><a href="#cb27-56"></a>            opt_status <span class="op">=</span> OptStatus.ERROR</span>
<span id="cb27-57"><a href="#cb27-57"></a>        </span>
<span id="cb27-58"><a href="#cb27-58"></a>        <span class="bu">print</span>(<span class="ss">f'Finish solving master problem.'</span>) </span>
<span id="cb27-59"><a href="#cb27-59"></a>        <span class="bu">print</span>(<span class="st">'-'</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb27-60"><a href="#cb27-60"></a>        <span class="cf">return</span> opt_status</span>
<span id="cb27-61"><a href="#cb27-61"></a>    </span>
<span id="cb27-62"><a href="#cb27-62"></a>    <span class="kw">def</span> add_feasibility_cut(<span class="va">self</span>, opt_u: <span class="bu">dict</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb27-63"><a href="#cb27-63"></a>        constr_expr <span class="op">=</span> [</span>
<span id="cb27-64"><a href="#cb27-64"></a>            opt_u.get(u_idx) <span class="op">*</span> (<span class="va">self</span>._b[u_idx] <span class="op">-</span> gp.quicksum(<span class="va">self</span>._B[u_idx][j] <span class="op">*</span> <span class="va">self</span>._y.get(j) </span>
<span id="cb27-65"><a href="#cb27-65"></a>                                                   <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>._num_y_vars)))</span>
<span id="cb27-66"><a href="#cb27-66"></a>            <span class="cf">for</span> u_idx <span class="kw">in</span> opt_u.keys()</span>
<span id="cb27-67"><a href="#cb27-67"></a>        ]</span>
<span id="cb27-68"><a href="#cb27-68"></a>        <span class="va">self</span>._model.addConstr(gp.quicksum(constr_expr) <span class="op">&lt;=</span> <span class="dv">0</span>)</span>
<span id="cb27-69"><a href="#cb27-69"></a>        <span class="bu">print</span>(<span class="ss">f'Benders feasibility cut added!'</span>)</span>
<span id="cb27-70"><a href="#cb27-70"></a>    </span>
<span id="cb27-71"><a href="#cb27-71"></a>    <span class="kw">def</span> add_optimality_cut(<span class="va">self</span>, opt_u: <span class="bu">dict</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb27-72"><a href="#cb27-72"></a>        constr_expr <span class="op">=</span> [</span>
<span id="cb27-73"><a href="#cb27-73"></a>            opt_u.get(u_idx) <span class="op">*</span> (<span class="va">self</span>._b[u_idx] <span class="op">-</span> gp.quicksum(<span class="va">self</span>._B[u_idx][j] <span class="op">*</span> <span class="va">self</span>._y.get(j) </span>
<span id="cb27-74"><a href="#cb27-74"></a>                                                   <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>._num_y_vars)))</span>
<span id="cb27-75"><a href="#cb27-75"></a>            <span class="cf">for</span> u_idx <span class="kw">in</span> opt_u.keys()</span>
<span id="cb27-76"><a href="#cb27-76"></a>        ]</span>
<span id="cb27-77"><a href="#cb27-77"></a>        <span class="va">self</span>._model.addConstr(gp.quicksum(constr_expr) <span class="op">&lt;=</span> <span class="va">self</span>._g)</span>
<span id="cb27-78"><a href="#cb27-78"></a>        <span class="va">self</span>._model.update()</span>
<span id="cb27-79"><a href="#cb27-79"></a>        <span class="bu">print</span>(<span class="va">self</span>._model.display())</span>
<span id="cb27-80"><a href="#cb27-80"></a>        <span class="bu">print</span>(<span class="ss">f'Benders optimality cut added!'</span>)</span>
<span id="cb27-81"><a href="#cb27-81"></a>    </span>
<span id="cb27-82"><a href="#cb27-82"></a>    <span class="kw">def</span> clean_up(<span class="va">self</span>):</span>
<span id="cb27-83"><a href="#cb27-83"></a>        <span class="va">self</span>._model.dispose()</span>
<span id="cb27-84"><a href="#cb27-84"></a>        <span class="va">self</span>._env.dispose()</span>
<span id="cb27-85"><a href="#cb27-85"></a>        </span>
<span id="cb27-86"><a href="#cb27-86"></a>    <span class="at">@property</span></span>
<span id="cb27-87"><a href="#cb27-87"></a>    <span class="kw">def</span> f(<span class="va">self</span>):</span>
<span id="cb27-88"><a href="#cb27-88"></a>        <span class="cf">return</span> <span class="va">self</span>._f</span>
<span id="cb27-89"><a href="#cb27-89"></a>        </span>
<span id="cb27-90"><a href="#cb27-90"></a>    <span class="at">@property</span></span>
<span id="cb27-91"><a href="#cb27-91"></a>    <span class="kw">def</span> opt_obj(<span class="va">self</span>):</span>
<span id="cb27-92"><a href="#cb27-92"></a>        <span class="cf">return</span> <span class="va">self</span>._opt_obj</span>
<span id="cb27-93"><a href="#cb27-93"></a>    </span>
<span id="cb27-94"><a href="#cb27-94"></a>    <span class="at">@property</span></span>
<span id="cb27-95"><a href="#cb27-95"></a>    <span class="kw">def</span> opt_obj_y(<span class="va">self</span>):</span>
<span id="cb27-96"><a href="#cb27-96"></a>        <span class="cf">return</span> <span class="va">self</span>._opt_obj_y</span>
<span id="cb27-97"><a href="#cb27-97"></a>    </span>
<span id="cb27-98"><a href="#cb27-98"></a>    <span class="at">@property</span></span>
<span id="cb27-99"><a href="#cb27-99"></a>    <span class="kw">def</span> opt_y(<span class="va">self</span>):</span>
<span id="cb27-100"><a href="#cb27-100"></a>        <span class="cf">return</span> <span class="va">self</span>._opt_y</span>
<span id="cb27-101"><a href="#cb27-101"></a>    </span>
<span id="cb27-102"><a href="#cb27-102"></a>    <span class="at">@property</span></span>
<span id="cb27-103"><a href="#cb27-103"></a>    <span class="kw">def</span> opt_g(<span class="va">self</span>):</span>
<span id="cb27-104"><a href="#cb27-104"></a>        <span class="cf">return</span> <span class="va">self</span>._g</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="129">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1"></a><span class="kw">class</span> GenericLpSubprobSolver:</span>
<span id="cb28-2"><a href="#cb28-2"></a>    </span>
<span id="cb28-3"><a href="#cb28-3"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, A: np.array, c: np.array, B: np.array, b: np.array):</span>
<span id="cb28-4"><a href="#cb28-4"></a>        <span class="co"># save data</span></span>
<span id="cb28-5"><a href="#cb28-5"></a>        <span class="va">self</span>._A <span class="op">=</span> A </span>
<span id="cb28-6"><a href="#cb28-6"></a>        <span class="va">self</span>._c <span class="op">=</span> c </span>
<span id="cb28-7"><a href="#cb28-7"></a>        <span class="va">self</span>._b <span class="op">=</span> b </span>
<span id="cb28-8"><a href="#cb28-8"></a>        <span class="va">self</span>._B <span class="op">=</span> B</span>
<span id="cb28-9"><a href="#cb28-9"></a>        </span>
<span id="cb28-10"><a href="#cb28-10"></a>        <span class="co"># env and model</span></span>
<span id="cb28-11"><a href="#cb28-11"></a>        <span class="va">self</span>._env <span class="op">=</span> gp.Env(<span class="st">'SubprobEnv'</span>)</span>
<span id="cb28-12"><a href="#cb28-12"></a>        <span class="va">self</span>._env.setParam(<span class="st">"OutputFlag"</span>,<span class="dv">0</span>)</span>
<span id="cb28-13"><a href="#cb28-13"></a>        <span class="va">self</span>._model <span class="op">=</span> gp.Model(env<span class="op">=</span><span class="va">self</span>._env, name<span class="op">=</span><span class="st">'SubprobSolver'</span>)</span>
<span id="cb28-14"><a href="#cb28-14"></a></span>
<span id="cb28-15"><a href="#cb28-15"></a>        <span class="co"># create variables</span></span>
<span id="cb28-16"><a href="#cb28-16"></a>        <span class="va">self</span>._num_vars <span class="op">=</span> <span class="bu">len</span>(b)</span>
<span id="cb28-17"><a href="#cb28-17"></a>        <span class="va">self</span>._u <span class="op">=</span> <span class="va">self</span>._model.addVars(<span class="va">self</span>._num_vars, vtype<span class="op">=</span>GRB.CONTINUOUS, name<span class="op">=</span><span class="st">'u'</span>)</span>
<span id="cb28-18"><a href="#cb28-18"></a></span>
<span id="cb28-19"><a href="#cb28-19"></a>        <span class="co"># create constraints</span></span>
<span id="cb28-20"><a href="#cb28-20"></a>        <span class="cf">for</span> c_idx <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(c)):</span>
<span id="cb28-21"><a href="#cb28-21"></a>            <span class="va">self</span>._model.addConstr(gp.quicksum(A[:,c_idx][i] <span class="op">*</span> <span class="va">self</span>._u.get(i) </span>
<span id="cb28-22"><a href="#cb28-22"></a>                                              <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(b))) <span class="op">&lt;=</span> c[c_idx])</span>
<span id="cb28-23"><a href="#cb28-23"></a>        </span>
<span id="cb28-24"><a href="#cb28-24"></a>        <span class="va">self</span>._opt_obj <span class="op">=</span> <span class="va">None</span></span>
<span id="cb28-25"><a href="#cb28-25"></a>        <span class="va">self</span>._opt_u <span class="op">=</span> <span class="va">None</span></span>
<span id="cb28-26"><a href="#cb28-26"></a>        <span class="va">self</span>._extreme_ray <span class="op">=</span> <span class="va">None</span></span>
<span id="cb28-27"><a href="#cb28-27"></a>        </span>
<span id="cb28-28"><a href="#cb28-28"></a>    <span class="kw">def</span> solve(<span class="va">self</span>):</span>
<span id="cb28-29"><a href="#cb28-29"></a>        <span class="bu">print</span>(<span class="st">'-'</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb28-30"><a href="#cb28-30"></a>        <span class="bu">print</span>(<span class="ss">f'Start solving dual subproblem.'</span>)</span>
<span id="cb28-31"><a href="#cb28-31"></a>        <span class="va">self</span>._model.setParam(GRB.Param.DualReductions, <span class="dv">0</span>)</span>
<span id="cb28-32"><a href="#cb28-32"></a>        <span class="va">self</span>._model.setParam(GRB.Param.InfUnbdInfo, <span class="dv">1</span>)</span>
<span id="cb28-33"><a href="#cb28-33"></a>        <span class="va">self</span>._model.optimize()</span>
<span id="cb28-34"><a href="#cb28-34"></a>        </span>
<span id="cb28-35"><a href="#cb28-35"></a>        status <span class="op">=</span> <span class="va">None</span></span>
<span id="cb28-36"><a href="#cb28-36"></a>        <span class="cf">if</span> <span class="va">self</span>._model.status <span class="op">==</span> GRB.OPTIMAL:</span>
<span id="cb28-37"><a href="#cb28-37"></a>            <span class="va">self</span>._opt_obj <span class="op">=</span> <span class="va">self</span>._model.objVal</span>
<span id="cb28-38"><a href="#cb28-38"></a>            <span class="va">self</span>._opt_u <span class="op">=</span> {</span>
<span id="cb28-39"><a href="#cb28-39"></a>                i: <span class="va">self</span>._u.get(i).X</span>
<span id="cb28-40"><a href="#cb28-40"></a>                <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>._num_vars)</span>
<span id="cb28-41"><a href="#cb28-41"></a>            }</span>
<span id="cb28-42"><a href="#cb28-42"></a>            status <span class="op">=</span> OptStatus.OPTIMAL</span>
<span id="cb28-43"><a href="#cb28-43"></a>            <span class="bu">print</span>(<span class="ss">f'</span><span class="ch">\t</span><span class="ss">dual subproblem is optimal.'</span>)</span>
<span id="cb28-44"><a href="#cb28-44"></a>            <span class="bu">print</span>(<span class="ss">f'</span><span class="ch">\t</span><span class="ss">opt_obj=</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>_opt_obj<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb28-45"><a href="#cb28-45"></a>            <span class="co"># for i in range(self._num_vars):</span></span>
<span id="cb28-46"><a href="#cb28-46"></a>            <span class="co">#     print(f'\topt_u{i}={self._opt_u.get(i)}')</span></span>
<span id="cb28-47"><a href="#cb28-47"></a>        <span class="cf">elif</span> <span class="va">self</span>._model.status <span class="op">==</span> GRB.UNBOUNDED:</span>
<span id="cb28-48"><a href="#cb28-48"></a>            status <span class="op">=</span> OptStatus.UNBOUNDED</span>
<span id="cb28-49"><a href="#cb28-49"></a>            <span class="va">self</span>._extreme_ray <span class="op">=</span> {</span>
<span id="cb28-50"><a href="#cb28-50"></a>                i: <span class="va">self</span>._u.get(i).UnbdRay</span>
<span id="cb28-51"><a href="#cb28-51"></a>                <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>._num_vars)</span>
<span id="cb28-52"><a href="#cb28-52"></a>            }</span>
<span id="cb28-53"><a href="#cb28-53"></a>            <span class="bu">print</span>(<span class="ss">f'dual subproblem is unbounded'</span>)</span>
<span id="cb28-54"><a href="#cb28-54"></a>            <span class="co"># for i in range(self._num_vars):</span></span>
<span id="cb28-55"><a href="#cb28-55"></a>            <span class="co">#     print(f'\topt_u{i}={self._extreme_ray.get(i)}')</span></span>
<span id="cb28-56"><a href="#cb28-56"></a>        <span class="cf">else</span>:</span>
<span id="cb28-57"><a href="#cb28-57"></a>            status <span class="op">=</span> OptStatus.ERROR</span>
<span id="cb28-58"><a href="#cb28-58"></a>        </span>
<span id="cb28-59"><a href="#cb28-59"></a>        <span class="bu">print</span>(<span class="ss">f'Finish solving dual subproblem.'</span>)</span>
<span id="cb28-60"><a href="#cb28-60"></a>        <span class="bu">print</span>(<span class="st">'-'</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb28-61"><a href="#cb28-61"></a>        <span class="cf">return</span> status</span>
<span id="cb28-62"><a href="#cb28-62"></a></span>
<span id="cb28-63"><a href="#cb28-63"></a>    <span class="kw">def</span> update_objective(<span class="va">self</span>, opt_y: <span class="bu">dict</span>):</span>
<span id="cb28-64"><a href="#cb28-64"></a>        obj_expr <span class="op">=</span> [</span>
<span id="cb28-65"><a href="#cb28-65"></a>            <span class="va">self</span>._u.get(u_idx) <span class="op">*</span> (<span class="va">self</span>._b[u_idx] <span class="op">-</span> <span class="bu">sum</span>(<span class="va">self</span>._B[u_idx][j] <span class="op">*</span> opt_y.get(j) </span>
<span id="cb28-66"><a href="#cb28-66"></a>                                                    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(opt_y))))</span>
<span id="cb28-67"><a href="#cb28-67"></a>            <span class="cf">for</span> u_idx <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>._num_vars)</span>
<span id="cb28-68"><a href="#cb28-68"></a>        ]</span>
<span id="cb28-69"><a href="#cb28-69"></a>        <span class="va">self</span>._model.setObjective(gp.quicksum(obj_expr), GRB.MAXIMIZE)</span>
<span id="cb28-70"><a href="#cb28-70"></a>        <span class="bu">print</span>(<span class="ss">f'dual subproblem objective updated!'</span>)</span>
<span id="cb28-71"><a href="#cb28-71"></a>    </span>
<span id="cb28-72"><a href="#cb28-72"></a>    <span class="kw">def</span> clean_up(<span class="va">self</span>):</span>
<span id="cb28-73"><a href="#cb28-73"></a>        <span class="va">self</span>._model.dispose()</span>
<span id="cb28-74"><a href="#cb28-74"></a>        <span class="va">self</span>._env.dispose()</span>
<span id="cb28-75"><a href="#cb28-75"></a>        </span>
<span id="cb28-76"><a href="#cb28-76"></a>    <span class="at">@property</span></span>
<span id="cb28-77"><a href="#cb28-77"></a>    <span class="kw">def</span> opt_obj(<span class="va">self</span>):</span>
<span id="cb28-78"><a href="#cb28-78"></a>        <span class="cf">return</span> <span class="va">self</span>._opt_obj</span>
<span id="cb28-79"><a href="#cb28-79"></a>    </span>
<span id="cb28-80"><a href="#cb28-80"></a>    <span class="at">@property</span></span>
<span id="cb28-81"><a href="#cb28-81"></a>    <span class="kw">def</span> opt_u(<span class="va">self</span>):</span>
<span id="cb28-82"><a href="#cb28-82"></a>        <span class="cf">return</span> <span class="va">self</span>._opt_u</span>
<span id="cb28-83"><a href="#cb28-83"></a>    </span>
<span id="cb28-84"><a href="#cb28-84"></a>    <span class="at">@property</span></span>
<span id="cb28-85"><a href="#cb28-85"></a>    <span class="kw">def</span> extreme_ray(<span class="va">self</span>):</span>
<span id="cb28-86"><a href="#cb28-86"></a>        <span class="cf">return</span> <span class="va">self</span>._extreme_ray</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="130">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1"></a><span class="kw">class</span> GenericBendersSolver:</span>
<span id="cb29-2"><a href="#cb29-2"></a>    </span>
<span id="cb29-3"><a href="#cb29-3"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, master_solver, dual_subprob_solver):</span>
<span id="cb29-4"><a href="#cb29-4"></a>        <span class="va">self</span>._master_solver <span class="op">=</span> master_solver</span>
<span id="cb29-5"><a href="#cb29-5"></a>        <span class="va">self</span>._dual_subprob_solver <span class="op">=</span> dual_subprob_solver</span>
<span id="cb29-6"><a href="#cb29-6"></a>        </span>
<span id="cb29-7"><a href="#cb29-7"></a>    </span>
<span id="cb29-8"><a href="#cb29-8"></a>    <span class="kw">def</span> optimize(<span class="va">self</span>,) <span class="op">-&gt;</span> OptStatus:</span>
<span id="cb29-9"><a href="#cb29-9"></a>        eps <span class="op">=</span> <span class="fl">1.0e-5</span></span>
<span id="cb29-10"><a href="#cb29-10"></a>        lb <span class="op">=</span> <span class="op">-</span>np.inf</span>
<span id="cb29-11"><a href="#cb29-11"></a>        ub <span class="op">=</span> np.inf</span>
<span id="cb29-12"><a href="#cb29-12"></a>        </span>
<span id="cb29-13"><a href="#cb29-13"></a>        <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb29-14"><a href="#cb29-14"></a>            <span class="co"># solve master problem</span></span>
<span id="cb29-15"><a href="#cb29-15"></a>            master_status <span class="op">=</span> <span class="va">self</span>._master_solver.solve()</span>
<span id="cb29-16"><a href="#cb29-16"></a>            <span class="cf">if</span> master_status <span class="op">==</span> OptStatus.INFEASIBLE:</span>
<span id="cb29-17"><a href="#cb29-17"></a>                <span class="cf">return</span> OptStatus.INFEASIBLE</span>
<span id="cb29-18"><a href="#cb29-18"></a>            </span>
<span id="cb29-19"><a href="#cb29-19"></a>            <span class="co"># update lower bound</span></span>
<span id="cb29-20"><a href="#cb29-20"></a>            lb <span class="op">=</span> np.<span class="bu">max</span>([lb, <span class="va">self</span>._master_solver.opt_obj])</span>
<span id="cb29-21"><a href="#cb29-21"></a>            <span class="bu">print</span>(<span class="ss">f'Bounds: lb=</span><span class="sc">{</span>lb<span class="sc">:.2f}</span><span class="ss">, ub=</span><span class="sc">{</span>ub<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb29-22"><a href="#cb29-22"></a>            </span>
<span id="cb29-23"><a href="#cb29-23"></a>            opt_y <span class="op">=</span> <span class="va">self</span>._master_solver.opt_y</span>
<span id="cb29-24"><a href="#cb29-24"></a>            </span>
<span id="cb29-25"><a href="#cb29-25"></a>            <span class="co"># solve subproblem</span></span>
<span id="cb29-26"><a href="#cb29-26"></a>            <span class="va">self</span>._dual_subprob_solver.update_objective(opt_y)</span>
<span id="cb29-27"><a href="#cb29-27"></a>            dsp_status <span class="op">=</span> <span class="va">self</span>._dual_subprob_solver.solve()</span>
<span id="cb29-28"><a href="#cb29-28"></a>            </span>
<span id="cb29-29"><a href="#cb29-29"></a>            <span class="cf">if</span> dsp_status <span class="op">==</span> OptStatus.OPTIMAL:</span>
<span id="cb29-30"><a href="#cb29-30"></a>                <span class="co"># update upper bound</span></span>
<span id="cb29-31"><a href="#cb29-31"></a>                opt_obj <span class="op">=</span> <span class="va">self</span>._dual_subprob_solver.opt_obj</span>
<span id="cb29-32"><a href="#cb29-32"></a>                opt_obj_y <span class="op">=</span> <span class="va">self</span>._master_solver.opt_obj_y</span>
<span id="cb29-33"><a href="#cb29-33"></a>                ub <span class="op">=</span> np.<span class="bu">min</span>([ub, opt_obj_y <span class="op">+</span> opt_obj])</span>
<span id="cb29-34"><a href="#cb29-34"></a>                <span class="bu">print</span>(<span class="ss">f'Bounds: lb=</span><span class="sc">{</span>lb<span class="sc">:.2f}</span><span class="ss">, ub=</span><span class="sc">{</span>ub<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb29-35"><a href="#cb29-35"></a>                </span>
<span id="cb29-36"><a href="#cb29-36"></a>                <span class="cf">if</span> ub <span class="op">-</span> lb <span class="op">&lt;=</span> eps:</span>
<span id="cb29-37"><a href="#cb29-37"></a>                    <span class="cf">break</span></span>
<span id="cb29-38"><a href="#cb29-38"></a>                </span>
<span id="cb29-39"><a href="#cb29-39"></a>                opt_u <span class="op">=</span> <span class="va">self</span>._dual_subprob_solver.opt_u</span>
<span id="cb29-40"><a href="#cb29-40"></a>                <span class="va">self</span>._master_solver.add_optimality_cut(opt_u) </span>
<span id="cb29-41"><a href="#cb29-41"></a>            <span class="cf">elif</span> dsp_status <span class="op">==</span> OptStatus.UNBOUNDED:</span>
<span id="cb29-42"><a href="#cb29-42"></a>                extreme_ray <span class="op">=</span> <span class="va">self</span>._dual_subprob_solver.extreme_ray</span>
<span id="cb29-43"><a href="#cb29-43"></a>                <span class="va">self</span>._master_solver.add_feasibility_cut(extreme_ray) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="101">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1"></a><span class="im">import</span> gurobipy <span class="im">as</span> gp</span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="im">from</span> gurobipy <span class="im">import</span> GRB</span>
<span id="cb30-3"><a href="#cb30-3"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb30-4"><a href="#cb30-4"></a></span>
<span id="cb30-5"><a href="#cb30-5"></a>c <span class="op">=</span> np.array([<span class="dv">8</span>, <span class="dv">12</span>, <span class="dv">10</span>])</span>
<span id="cb30-6"><a href="#cb30-6"></a>f <span class="op">=</span> np.array([<span class="dv">15</span>, <span class="dv">18</span>])</span>
<span id="cb30-7"><a href="#cb30-7"></a>A <span class="op">=</span> np.array([</span>
<span id="cb30-8"><a href="#cb30-8"></a>    [<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>],</span>
<span id="cb30-9"><a href="#cb30-9"></a>    [<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">3</span>]</span>
<span id="cb30-10"><a href="#cb30-10"></a>])</span>
<span id="cb30-11"><a href="#cb30-11"></a>B <span class="op">=</span> np.array([</span>
<span id="cb30-12"><a href="#cb30-12"></a>    [<span class="dv">4</span>, <span class="dv">5</span>],</span>
<span id="cb30-13"><a href="#cb30-13"></a>    [<span class="dv">2</span>, <span class="dv">3</span>],</span>
<span id="cb30-14"><a href="#cb30-14"></a>])</span>
<span id="cb30-15"><a href="#cb30-15"></a>b <span class="op">=</span> np.array([<span class="dv">300</span>, <span class="dv">220</span>])</span>
<span id="cb30-16"><a href="#cb30-16"></a></span>
<span id="cb30-17"><a href="#cb30-17"></a>master_solver <span class="op">=</span> GenericLpMasterSolver(f, B, b)</span>
<span id="cb30-18"><a href="#cb30-18"></a>dual_subprob_solver <span class="op">=</span> GenericLpSubprobSolver(A, c, B, b)</span>
<span id="cb30-19"><a href="#cb30-19"></a></span>
<span id="cb30-20"><a href="#cb30-20"></a>benders_solver <span class="op">=</span> GenericBendersSolver(master_solver, dual_subprob_solver)</span>
<span id="cb30-21"><a href="#cb30-21"></a>benders_solver.optimize()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Set parameter Username
Set parameter LogFile to value "MasterEnv"
Set parameter Username
Set parameter LogFile to value "SubprobEnv"
--------------------------------------------------
Start solving master problem.
Minimize
  15.0 y[0] + 18.0 y[1] + g
Subject To
None
Gurobi Optimizer version 10.0.3 build v10.0.3rc0 (mac64[arm])

CPU model: Apple M1
Thread count: 8 physical cores, 8 logical processors, using up to 8 threads

Optimize a model with 0 rows, 3 columns and 0 nonzeros
Model fingerprint: 0xb00b2c2a
Coefficient statistics:
  Matrix range     [0e+00, 0e+00]
  Objective range  [1e+00, 2e+01]
  Bounds range     [0e+00, 0e+00]
  RHS range        [0e+00, 0e+00]
Presolve removed 0 rows and 3 columns
Presolve time: 0.00s
Presolve: All rows and columns removed
Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0    0.0000000e+00   0.000000e+00   0.000000e+00      0s

Solved in 0 iterations and 0.00 seconds (0.00 work units)
Optimal objective  0.000000000e+00
    master problem is optimal.
    opt_obj=0.00
    opt_g=0.00
    opt_y0=0.0
    opt_y1=0.0
Finish solving master problem.
--------------------------------------------------
Bounds: lb=0.00, ub=inf
dual subproblem objective updated!
--------------------------------------------------
Start solving dual subproblem.
    dual subproblem is optimal.
    opt_obj=1200.00
    opt_u0=4.0
    opt_u1=0.0
Finish solving dual subproblem.
--------------------------------------------------
Bounds: lb=0.00, ub=1200.00
Minimize
  15.0 y[0] + 18.0 y[1] + g
Subject To
  R0: -16.0 y[0] + -20.0 y[1] + -1.0 g &lt;= -1200
None
Benders optimality cut added!
--------------------------------------------------
Start solving master problem.
Minimize
  15.0 y[0] + 18.0 y[1] + g
Subject To
  R0: -16.0 y[0] + -20.0 y[1] + -1.0 g &lt;= -1200
None
Gurobi Optimizer version 10.0.3 build v10.0.3rc0 (mac64[arm])

CPU model: Apple M1
Thread count: 8 physical cores, 8 logical processors, using up to 8 threads

Optimize a model with 1 rows, 3 columns and 3 nonzeros
Coefficient statistics:
  Matrix range     [1e+00, 2e+01]
  Objective range  [1e+00, 2e+01]
  Bounds range     [0e+00, 0e+00]
  RHS range        [1e+03, 1e+03]
Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0    0.0000000e+00   1.500000e+02   0.000000e+00      0s
       1    1.0800000e+03   0.000000e+00   0.000000e+00      0s

Solved in 1 iterations and 0.00 seconds (0.00 work units)
Optimal objective  1.080000000e+03
    master problem is optimal.
    opt_obj=1080.00
    opt_g=0.00
    opt_y0=0.0
    opt_y1=60.0
Finish solving master problem.
--------------------------------------------------
Bounds: lb=1080.00, ub=1200.00
dual subproblem objective updated!
--------------------------------------------------
Start solving dual subproblem.
    dual subproblem is optimal.
    opt_obj=80.00
    opt_u0=0.0
    opt_u1=2.0
Finish solving dual subproblem.
--------------------------------------------------
Bounds: lb=1080.00, ub=1160.00
Minimize
  15.0 y[0] + 18.0 y[1] + g
Subject To
  R0: -16.0 y[0] + -20.0 y[1] + -1.0 g &lt;= -1200
  R1: -4.0 y[0] + -6.0 y[1] + -1.0 g &lt;= -440
None
Benders optimality cut added!
--------------------------------------------------
Start solving master problem.
Minimize
  15.0 y[0] + 18.0 y[1] + g
Subject To
  R0: -16.0 y[0] + -20.0 y[1] + -1.0 g &lt;= -1200
  R1: -4.0 y[0] + -6.0 y[1] + -1.0 g &lt;= -440
None
Gurobi Optimizer version 10.0.3 build v10.0.3rc0 (mac64[arm])

CPU model: Apple M1
Thread count: 8 physical cores, 8 logical processors, using up to 8 threads

Optimize a model with 2 rows, 3 columns and 6 nonzeros
Coefficient statistics:
  Matrix range     [1e+00, 2e+01]
  Objective range  [1e+00, 2e+01]
  Bounds range     [0e+00, 0e+00]
  RHS range        [4e+02, 1e+03]
Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0    1.0800000e+03   4.000000e+01   0.000000e+00      0s
       1    1.0914286e+03   0.000000e+00   0.000000e+00      0s

Solved in 1 iterations and 0.00 seconds (0.00 work units)
Optimal objective  1.091428571e+03
    master problem is optimal.
    opt_obj=1091.43
    opt_g=114.29
    opt_y0=0.0
    opt_y1=54.285714285714285
Finish solving master problem.
--------------------------------------------------
Bounds: lb=1091.43, ub=1160.00
dual subproblem objective updated!
--------------------------------------------------
Start solving dual subproblem.
    dual subproblem is optimal.
    opt_obj=114.29
    opt_u0=0.0
    opt_u1=2.0
Finish solving dual subproblem.
--------------------------------------------------
Bounds: lb=1091.43, ub=1091.43</code></pre>
</div>
</div>
<div class="cell" data-execution_count="105">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1"></a><span class="im">import</span> gurobipy <span class="im">as</span> gp</span>
<span id="cb32-2"><a href="#cb32-2"></a><span class="im">from</span> gurobipy <span class="im">import</span> GRB</span>
<span id="cb32-3"><a href="#cb32-3"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb32-4"><a href="#cb32-4"></a></span>
<span id="cb32-5"><a href="#cb32-5"></a>c <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>])</span>
<span id="cb32-6"><a href="#cb32-6"></a>f <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>])</span>
<span id="cb32-7"><a href="#cb32-7"></a>A <span class="op">=</span> np.array([</span>
<span id="cb32-8"><a href="#cb32-8"></a>    [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb32-9"><a href="#cb32-9"></a>])</span>
<span id="cb32-10"><a href="#cb32-10"></a>B <span class="op">=</span> np.array([</span>
<span id="cb32-11"><a href="#cb32-11"></a>    [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb32-12"><a href="#cb32-12"></a>])</span>
<span id="cb32-13"><a href="#cb32-13"></a>b <span class="op">=</span> np.array([<span class="dv">1</span>])</span>
<span id="cb32-14"><a href="#cb32-14"></a></span>
<span id="cb32-15"><a href="#cb32-15"></a>master_solver <span class="op">=</span> GenericLpMasterSolver(f, B, b)</span>
<span id="cb32-16"><a href="#cb32-16"></a>dual_subprob_solver <span class="op">=</span> GenericLpSubprobSolver(A, c, B, b)</span>
<span id="cb32-17"><a href="#cb32-17"></a></span>
<span id="cb32-18"><a href="#cb32-18"></a>benders_solver <span class="op">=</span> GenericBendersSolver(master_solver, dual_subprob_solver)</span>
<span id="cb32-19"><a href="#cb32-19"></a>benders_solver.optimize()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Set parameter Username
Set parameter LogFile to value "MasterEnv"
Set parameter Username
Set parameter LogFile to value "SubprobEnv"
--------------------------------------------------
Start solving master problem.
Minimize
  y[0] + y[1] + y[2] + y[3] + g
Subject To
None
Gurobi Optimizer version 10.0.3 build v10.0.3rc0 (mac64[arm])

CPU model: Apple M1
Thread count: 8 physical cores, 8 logical processors, using up to 8 threads

Optimize a model with 0 rows, 5 columns and 0 nonzeros
Model fingerprint: 0xbadf3d1d
Coefficient statistics:
  Matrix range     [0e+00, 0e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [0e+00, 0e+00]
  RHS range        [0e+00, 0e+00]
Presolve removed 0 rows and 5 columns
Presolve time: 0.00s
Presolve: All rows and columns removed
Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0    0.0000000e+00   0.000000e+00   0.000000e+00      0s

Solved in 0 iterations and 0.00 seconds (0.00 work units)
Optimal objective  0.000000000e+00
    master problem is optimal.
    opt_obj=0.00
    opt_g=0.00
    opt_y0=0.0
    opt_y1=0.0
    opt_y2=0.0
    opt_y3=0.0
Finish solving master problem.
--------------------------------------------------
Bounds: lb=0.00, ub=inf
dual subproblem objective updated!
--------------------------------------------------
Start solving dual subproblem.
    dual subproblem is optimal.
    opt_obj=1.00
    opt_u0=1.0
Finish solving dual subproblem.
--------------------------------------------------
Bounds: lb=0.00, ub=1.00
Minimize
  y[0] + y[1] + y[2] + y[3] + g
Subject To
  R0: -1.0 y[0] + -1.0 y[1] + -1.0 y[2] + -1.0 y[3] + -1.0 g &lt;= -1
None
Benders optimality cut added!
--------------------------------------------------
Start solving master problem.
Minimize
  y[0] + y[1] + y[2] + y[3] + g
Subject To
  R0: -1.0 y[0] + -1.0 y[1] + -1.0 y[2] + -1.0 y[3] + -1.0 g &lt;= -1
None
Gurobi Optimizer version 10.0.3 build v10.0.3rc0 (mac64[arm])

CPU model: Apple M1
Thread count: 8 physical cores, 8 logical processors, using up to 8 threads

Optimize a model with 1 rows, 5 columns and 5 nonzeros
Coefficient statistics:
  Matrix range     [1e+00, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [0e+00, 0e+00]
  RHS range        [1e+00, 1e+00]
Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0    0.0000000e+00   1.000000e+00   0.000000e+00      0s
       1    1.0000000e+00   0.000000e+00   0.000000e+00      0s

Solved in 1 iterations and 0.00 seconds (0.00 work units)
Optimal objective  1.000000000e+00
    master problem is optimal.
    opt_obj=1.00
    opt_g=0.00
    opt_y0=1.0
    opt_y1=0.0
    opt_y2=0.0
    opt_y3=0.0
Finish solving master problem.
--------------------------------------------------
Bounds: lb=1.00, ub=1.00
dual subproblem objective updated!
--------------------------------------------------
Start solving dual subproblem.
    dual subproblem is optimal.
    opt_obj=-0.00
    opt_u0=1.0
Finish solving dual subproblem.
--------------------------------------------------
Bounds: lb=1.00, ub=1.00</code></pre>
</div>
</div>
<div class="cell" data-execution_count="157">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1"></a><span class="im">import</span> gurobipy <span class="im">as</span> gp</span>
<span id="cb34-2"><a href="#cb34-2"></a><span class="im">from</span> gurobipy <span class="im">import</span> GRB</span>
<span id="cb34-3"><a href="#cb34-3"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb34-4"><a href="#cb34-4"></a><span class="im">import</span> scipy.sparse <span class="im">as</span> sp</span>
<span id="cb34-5"><a href="#cb34-5"></a></span>
<span id="cb34-6"><a href="#cb34-6"></a><span class="kw">class</span> GurobiLpSolver:</span>
<span id="cb34-7"><a href="#cb34-7"></a>    </span>
<span id="cb34-8"><a href="#cb34-8"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, c, f, A, B, b):</span>
<span id="cb34-9"><a href="#cb34-9"></a>        <span class="va">self</span>._env <span class="op">=</span> gp.Env(<span class="st">'GurobiEnv'</span>)</span>
<span id="cb34-10"><a href="#cb34-10"></a>        <span class="va">self</span>._model <span class="op">=</span> gp.Model(env<span class="op">=</span><span class="va">self</span>._env, name<span class="op">=</span><span class="st">'GurobiLpSolver'</span>)</span>
<span id="cb34-11"><a href="#cb34-11"></a>        </span>
<span id="cb34-12"><a href="#cb34-12"></a>        <span class="co"># prepare data</span></span>
<span id="cb34-13"><a href="#cb34-13"></a>        <span class="va">self</span>._obj_coeff <span class="op">=</span> np.concatenate((c, f))</span>
<span id="cb34-14"><a href="#cb34-14"></a>        <span class="bu">print</span>(<span class="va">self</span>._obj_coeff)</span>
<span id="cb34-15"><a href="#cb34-15"></a>        <span class="va">self</span>._constr_mat <span class="op">=</span> np.concatenate((A, B), axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb34-16"><a href="#cb34-16"></a>        <span class="bu">print</span>(<span class="va">self</span>._constr_mat)</span>
<span id="cb34-17"><a href="#cb34-17"></a>        <span class="va">self</span>._rhs <span class="op">=</span> b</span>
<span id="cb34-18"><a href="#cb34-18"></a>        <span class="va">self</span>._num_vars <span class="op">=</span> <span class="bu">len</span>(<span class="va">self</span>._obj_coeff)</span>
<span id="cb34-19"><a href="#cb34-19"></a>        <span class="va">self</span>._num_constrs <span class="op">=</span> <span class="bu">len</span>(b)</span>
<span id="cb34-20"><a href="#cb34-20"></a>        </span>
<span id="cb34-21"><a href="#cb34-21"></a>        <span class="co"># create decision variables</span></span>
<span id="cb34-22"><a href="#cb34-22"></a>        <span class="va">self</span>._vars <span class="op">=</span> <span class="va">self</span>._model.addMVar(<span class="va">self</span>._num_vars, vtype<span class="op">=</span>GRB.CONTINUOUS, lb<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb34-23"><a href="#cb34-23"></a>        </span>
<span id="cb34-24"><a href="#cb34-24"></a>        <span class="co"># create constraints</span></span>
<span id="cb34-25"><a href="#cb34-25"></a>        <span class="va">self</span>._constrs <span class="op">=</span> <span class="va">self</span>._model.addConstr(<span class="va">self</span>._constr_mat<span class="op">@</span>self._vars <span class="op">==</span> <span class="va">self</span>._rhs)</span>
<span id="cb34-26"><a href="#cb34-26"></a>        </span>
<span id="cb34-27"><a href="#cb34-27"></a>        <span class="co"># create objective</span></span>
<span id="cb34-28"><a href="#cb34-28"></a>        <span class="va">self</span>._model.setObjective(<span class="va">self</span>._obj_coeff <span class="op">@</span> <span class="va">self</span>._vars, GRB.MINIMIZE)</span>
<span id="cb34-29"><a href="#cb34-29"></a>    </span>
<span id="cb34-30"><a href="#cb34-30"></a>    <span class="kw">def</span> optimize(<span class="va">self</span>):</span>
<span id="cb34-31"><a href="#cb34-31"></a>        <span class="va">self</span>._model.update()</span>
<span id="cb34-32"><a href="#cb34-32"></a>        <span class="bu">print</span>(<span class="va">self</span>._model.display())</span>
<span id="cb34-33"><a href="#cb34-33"></a>        <span class="va">self</span>._model.optimize()</span>
<span id="cb34-34"><a href="#cb34-34"></a>        <span class="cf">pass</span></span>
<span id="cb34-35"><a href="#cb34-35"></a>    </span>
<span id="cb34-36"><a href="#cb34-36"></a>    <span class="kw">def</span> clean_up(<span class="va">self</span>):</span>
<span id="cb34-37"><a href="#cb34-37"></a>        </span>
<span id="cb34-38"><a href="#cb34-38"></a>        <span class="cf">pass</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="158">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1"></a><span class="im">import</span> gurobipy <span class="im">as</span> gp</span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="im">from</span> gurobipy <span class="im">import</span> GRB</span>
<span id="cb35-3"><a href="#cb35-3"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb35-4"><a href="#cb35-4"></a></span>
<span id="cb35-5"><a href="#cb35-5"></a>np.random.seed(<span class="dv">142</span>)</span>
<span id="cb35-6"><a href="#cb35-6"></a>c <span class="op">=</span> np.random.randint(<span class="dv">2</span>, <span class="dv">6</span>, size<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb35-7"><a href="#cb35-7"></a>f <span class="op">=</span> np.random.randint(<span class="dv">1</span>, <span class="dv">15</span>, size<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb35-8"><a href="#cb35-8"></a>A <span class="op">=</span> np.random.randint(<span class="dv">2</span>, <span class="dv">6</span>, size<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">20</span>))</span>
<span id="cb35-9"><a href="#cb35-9"></a>B <span class="op">=</span> np.random.randint(<span class="dv">2</span>, <span class="dv">26</span>, size<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">10</span>))</span>
<span id="cb35-10"><a href="#cb35-10"></a>b <span class="op">=</span> np.random.randint(<span class="dv">20</span>, <span class="dv">50</span>, size<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb35-11"><a href="#cb35-11"></a></span>
<span id="cb35-12"><a href="#cb35-12"></a>model <span class="op">=</span> GurobiLpSolver(c, f, A, B, b)</span>
<span id="cb35-13"><a href="#cb35-13"></a>model.optimize()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Set parameter Username
Set parameter LogFile to value "GurobiEnv"
[ 3  3  5  5  2  4  3  2  3  3  4  2  5  5  2  5  4  4  5  5  3  6  8 12
  3  5  4  4  9  3]
[[ 2  4  3  5  5  2  5  4  5  3  3  4  2  2  2  2  3  2  3  3 11 11 25 20
   9  5  7  8  9  2]
 [ 5  2  2  4  3  5  4  2  3  5  4  3  2  5  2  3  5  4  5  4 23 19 23 19
  12 12 13 15 19 19]
 [ 2  3  2  2  5  5  4  5  5  2  5  2  5  4  5  4  3  5  3  3 11 10  8 20
  17  9 25 25 10 12]
 [ 3  5  4  3  4  2  4  2  4  2  4  2  3  3  2  5  3  2  4  2 16 23 18 20
  20 25 14 10  2  6]
 [ 5  4  3  4  3  4  5  4  4  2  5  4  2  3  2  2  5  2  4  3  3  8 10  4
  22 25 11 15 15  9]
 [ 5  5  5  3  2  5  2  2  3  4  2  5  4  4  2  5  4  5  5  4 21 14 22 19
  15 19 16  8 22 23]
 [ 4  2  2  5  2  5  5  4  2  3  2  3  2  5  4  3  3  4  5  3 18  8 11  2
  19 23 23  8 18 25]
 [ 3  2  4  5  3  2  3  5  3  4  5  2  5  4  2  4  2  4  3  5 20 19 13 24
  19  7  4 15 24  3]
 [ 4  4  2  3  2  2  5  5  2  3  5  5  4  5  3  4  2  2  4  2 19  6 20 16
   5 14 20 18 19  6]
 [ 4  2  3  4  4  4  2  5  2  5  5  2  3  4  4  5  4  4  2  3 25 11 17 14
  15 12  6 23 24  6]
 [ 3  5  2  5  3  2  3  3  5  5  3  2  5  3  4  3  5  5  4  4  3 23  9 16
  22  3 14 16 12 16]
 [ 2  3  4  3  5  5  3  5  4  4  2  5  4  3  5  2  3  4  5  4 13 11  7  2
  15 24 13 16  4  6]
 [ 4  4  2  2  4  4  3  2  2  2  5  5  2  5  3  3  5  2  4  3  9 13 10 16
  25 16 24 21  6 16]
 [ 3  5  5  4  3  2  3  5  2  3  5  3  5  3  3  3  5  5  5  5  3 20  5 18
   8 19 25  2 17  7]
 [ 3  2  5  2  2  3  3  3  4  3  5  5  4  4  4  3  3  4  4  4  9 15  6 23
  14 21 21 22 18 22]
 [ 3  2  2  3  4  3  2  4  5  3  2  2  2  3  5  3  2  2  4  4 19 17 17 17
   4 22 12 18  4 18]
 [ 4  2  2  5  2  3  5  4  2  3  2  5  5  5  5  4  4  4  2  5  2 13 23  8
  22 17 10 24 20 23]
 [ 2  4  2  3  2  2  2  4  4  5  2  4  4  4  2  4  3  4  5  3 10  6 20 21
  16 15 13  3 24 16]
 [ 2  5  4  3  3  3  4  2  5  4  2  4  5  2  2  2  3  5  4  5 12 18 21  8
  19  8 11 20 21 21]
 [ 4  2  2  2  2  2  4  3  4  3  2  2  4  2  4  3  5  2  4  3 11  4  2  9
  13 20 23 16 16 14]]
Minimize
3.0 C0 + 3.0 C1 + 5.0 C2 + 5.0 C3 + 2.0 C4 + 4.0 C5 + 3.0 C6 + 2.0 C7 + 3.0 C8
+ 3.0 C9 + 4.0 C10 + 2.0 C11 + 5.0 C12 + 5.0 C13 + 2.0 C14 + 5.0 C15 + 4.0 C16 + 4.0 C17
+ 5.0 C18 + 5.0 C19 + 3.0 C20 + 6.0 C21 + 8.0 C22 + 12.0 C23 + 3.0 C24 + 5.0 C25
+ 4.0 C26 + 4.0 C27 + 9.0 C28 + 3.0 C29
Subject To
R0: 2.0 C0 + 4.0 C1 + 3.0 C2 + 5.0 C3 + 5.0 C4 + 2.0 C5 + 5.0 C6 + 4.0 C7 + 5.0 C8 +
3.0 C9 + 3.0 C10 + 4.0 C11 + 2.0 C12 + 2.0 C13 + 2.0 C14 + 2.0 C15 + 3.0 C16 + 2.0 C17 +
3.0 C18 + 3.0 C19 + 11.0 C20 + 11.0 C21 + 25.0 C22 + 20.0 C23 + 9.0 C24 + 5.0 C25 + 7.0
 C26 + 8.0 C27 + 9.0 C28 + 2.0 C29 = 21
R1: 5.0 C0 + 2.0 C1 + 2.0 C2 + 4.0 C3 + 3.0 C4 + 5.0 C5 + 4.0 C6 + 2.0 C7 + 3.0 C8 +
5.0 C9 + 4.0 C10 + 3.0 C11 + 2.0 C12 + 5.0 C13 + 2.0 C14 + 3.0 C15 + 5.0 C16 + 4.0 C17 +
5.0 C18 + 4.0 C19 + 23.0 C20 + 19.0 C21 + 23.0 C22 + 19.0 C23 + 12.0 C24 + 12.0 C25 +
 13.0 C26 + 15.0 C27 + 19.0 C28 + 19.0 C29 = 26
R2: 2.0 C0 + 3.0 C1 + 2.0 C2 + 2.0 C3 + 5.0 C4 + 5.0 C5 + 4.0 C6 + 5.0 C7 + 5.0 C8 +
2.0 C9 + 5.0 C10 + 2.0 C11 + 5.0 C12 + 4.0 C13 + 5.0 C14 + 4.0 C15 + 3.0 C16 + 5.0 C17 +
3.0 C18 + 3.0 C19 + 11.0 C20 + 10.0 C21 + 8.0 C22 + 20.0 C23 + 17.0 C24 + 9.0 C25 + 25.0
 C26 + 25.0 C27 + 10.0 C28 + 12.0 C29 = 38
R3: 3.0 C0 + 5.0 C1 + 4.0 C2 + 3.0 C3 + 4.0 C4 + 2.0 C5 + 4.0 C6 + 2.0 C7 + 4.0 C8 +
2.0 C9 + 4.0 C10 + 2.0 C11 + 3.0 C12 + 3.0 C13 + 2.0 C14 + 5.0 C15 + 3.0 C16 + 2.0 C17 +
4.0 C18 + 2.0 C19 + 16.0 C20 + 23.0 C21 + 18.0 C22 + 20.0 C23 + 20.0 C24 + 25.0 C25 +
 14.0 C26 + 10.0 C27 + 2.0 C28 + 6.0 C29 = 42
R4: 5.0 C0 + 4.0 C1 + 3.0 C2 + 4.0 C3 + 3.0 C4 + 4.0 C5 + 5.0 C6 + 4.0 C7 + 4.0 C8 +
2.0 C9 + 5.0 C10 + 4.0 C11 + 2.0 C12 + 3.0 C13 + 2.0 C14 + 2.0 C15 + 5.0 C16 + 2.0 C17 +
4.0 C18 + 3.0 C19 + 3.0 C20 + 8.0 C21 + 10.0 C22 + 4.0 C23 + 22.0 C24 + 25.0 C25 + 11.0
 C26 + 15.0 C27 + 15.0 C28 + 9.0 C29 = 35
R5: 5.0 C0 + 5.0 C1 + 5.0 C2 + 3.0 C3 + 2.0 C4 + 5.0 C5 + 2.0 C6 + 2.0 C7 + 3.0 C8 +
4.0 C9 + 2.0 C10 + 5.0 C11 + 4.0 C12 + 4.0 C13 + 2.0 C14 + 5.0 C15 + 4.0 C16 + 5.0 C17 +
5.0 C18 + 4.0 C19 + 21.0 C20 + 14.0 C21 + 22.0 C22 + 19.0 C23 + 15.0 C24 + 19.0 C25 +
 16.0 C26 + 8.0 C27 + 22.0 C28 + 23.0 C29 = 37
R6: 4.0 C0 + 2.0 C1 + 2.0 C2 + 5.0 C3 + 2.0 C4 + 5.0 C5 + 5.0 C6 + 4.0 C7 + 2.0 C8 +
3.0 C9 + 2.0 C10 + 3.0 C11 + 2.0 C12 + 5.0 C13 + 4.0 C14 + 3.0 C15 + 3.0 C16 + 4.0 C17 +
5.0 C18 + 3.0 C19 + 18.0 C20 + 8.0 C21 + 11.0 C22 + 2.0 C23 + 19.0 C24 + 23.0 C25 + 23.0
 C26 + 8.0 C27 + 18.0 C28 + 25.0 C29 = 28
R7: 3.0 C0 + 2.0 C1 + 4.0 C2 + 5.0 C3 + 3.0 C4 + 2.0 C5 + 3.0 C6 + 5.0 C7 + 3.0 C8 +
4.0 C9 + 5.0 C10 + 2.0 C11 + 5.0 C12 + 4.0 C13 + 2.0 C14 + 4.0 C15 + 2.0 C16 + 4.0 C17 +
3.0 C18 + 5.0 C19 + 20.0 C20 + 19.0 C21 + 13.0 C22 + 24.0 C23 + 19.0 C24 + 7.0 C25 + 4.0
 C26 + 15.0 C27 + 24.0 C28 + 3.0 C29 = 22
R8: 4.0 C0 + 4.0 C1 + 2.0 C2 + 3.0 C3 + 2.0 C4 + 2.0 C5 + 5.0 C6 + 5.0 C7 + 2.0 C8 +
3.0 C9 + 5.0 C10 + 5.0 C11 + 4.0 C12 + 5.0 C13 + 3.0 C14 + 4.0 C15 + 2.0 C16 + 2.0 C17 +
4.0 C18 + 2.0 C19 + 19.0 C20 + 6.0 C21 + 20.0 C22 + 16.0 C23 + 5.0 C24 + 14.0 C25 + 20.0
 C26 + 18.0 C27 + 19.0 C28 + 6.0 C29 = 39
R9: 4.0 C0 + 2.0 C1 + 3.0 C2 + 4.0 C3 + 4.0 C4 + 4.0 C5 + 2.0 C6 + 5.0 C7 + 2.0 C8 +
5.0 C9 + 5.0 C10 + 2.0 C11 + 3.0 C12 + 4.0 C13 + 4.0 C14 + 5.0 C15 + 4.0 C16 + 4.0 C17 +
2.0 C18 + 3.0 C19 + 25.0 C20 + 11.0 C21 + 17.0 C22 + 14.0 C23 + 15.0 C24 + 12.0 C25 +
 6.0 C26 + 23.0 C27 + 24.0 C28 + 6.0 C29 = 33
R10: 3.0 C0 + 5.0 C1 + 2.0 C2 + 5.0 C3 + 3.0 C4 + 2.0 C5 + 3.0 C6 + 3.0 C7 + 5.0 C8 +
5.0 C9 + 3.0 C10 + 2.0 C11 + 5.0 C12 + 3.0 C13 + 4.0 C14 + 3.0 C15 + 5.0 C16 + 5.0 C17 +
4.0 C18 + 4.0 C19 + 3.0 C20 + 23.0 C21 + 9.0 C22 + 16.0 C23 + 22.0 C24 + 3.0 C25 + 14.0
 C26 + 16.0 C27 + 12.0 C28 + 16.0 C29 = 28
R11: 2.0 C0 + 3.0 C1 + 4.0 C2 + 3.0 C3 + 5.0 C4 + 5.0 C5 + 3.0 C6 + 5.0 C7 + 4.0 C8 +
4.0 C9 + 2.0 C10 + 5.0 C11 + 4.0 C12 + 3.0 C13 + 5.0 C14 + 2.0 C15 + 3.0 C16 + 4.0 C17 +
5.0 C18 + 4.0 C19 + 13.0 C20 + 11.0 C21 + 7.0 C22 + 2.0 C23 + 15.0 C24 + 24.0 C25 + 13.0
 C26 + 16.0 C27 + 4.0 C28 + 6.0 C29 = 38
R12: 4.0 C0 + 4.0 C1 + 2.0 C2 + 2.0 C3 + 4.0 C4 + 4.0 C5 + 3.0 C6 + 2.0 C7 + 2.0 C8 +
2.0 C9 + 5.0 C10 + 5.0 C11 + 2.0 C12 + 5.0 C13 + 3.0 C14 + 3.0 C15 + 5.0 C16 + 2.0 C17 +
4.0 C18 + 3.0 C19 + 9.0 C20 + 13.0 C21 + 10.0 C22 + 16.0 C23 + 25.0 C24 + 16.0 C25 +
 24.0 C26 + 21.0 C27 + 6.0 C28 + 16.0 C29 = 47
R13: 3.0 C0 + 5.0 C1 + 5.0 C2 + 4.0 C3 + 3.0 C4 + 2.0 C5 + 3.0 C6 + 5.0 C7 + 2.0 C8 +
3.0 C9 + 5.0 C10 + 3.0 C11 + 5.0 C12 + 3.0 C13 + 3.0 C14 + 3.0 C15 + 5.0 C16 + 5.0 C17 +
5.0 C18 + 5.0 C19 + 3.0 C20 + 20.0 C21 + 5.0 C22 + 18.0 C23 + 8.0 C24 + 19.0 C25 + 25.0
 C26 + 2.0 C27 + 17.0 C28 + 7.0 C29 = 28
R14: 3.0 C0 + 2.0 C1 + 5.0 C2 + 2.0 C3 + 2.0 C4 + 3.0 C5 + 3.0 C6 + 3.0 C7 + 4.0 C8 +
3.0 C9 + 5.0 C10 + 5.0 C11 + 4.0 C12 + 4.0 C13 + 4.0 C14 + 3.0 C15 + 3.0 C16 + 4.0 C17 +
4.0 C18 + 4.0 C19 + 9.0 C20 + 15.0 C21 + 6.0 C22 + 23.0 C23 + 14.0 C24 + 21.0 C25 + 21.0
 C26 + 22.0 C27 + 18.0 C28 + 22.0 C29 = 45
R15: 3.0 C0 + 2.0 C1 + 2.0 C2 + 3.0 C3 + 4.0 C4 + 3.0 C5 + 2.0 C6 + 4.0 C7 + 5.0 C8 +
3.0 C9 + 2.0 C10 + 2.0 C11 + 2.0 C12 + 3.0 C13 + 5.0 C14 + 3.0 C15 + 2.0 C16 + 2.0 C17 +
4.0 C18 + 4.0 C19 + 19.0 C20 + 17.0 C21 + 17.0 C22 + 17.0 C23 + 4.0 C24 + 22.0 C25 +
 12.0 C26 + 18.0 C27 + 4.0 C28 + 18.0 C29 = 34
R16: 4.0 C0 + 2.0 C1 + 2.0 C2 + 5.0 C3 + 2.0 C4 + 3.0 C5 + 5.0 C6 + 4.0 C7 + 2.0 C8 +
3.0 C9 + 2.0 C10 + 5.0 C11 + 5.0 C12 + 5.0 C13 + 5.0 C14 + 4.0 C15 + 4.0 C16 + 4.0 C17 +
2.0 C18 + 5.0 C19 + 2.0 C20 + 13.0 C21 + 23.0 C22 + 8.0 C23 + 22.0 C24 + 17.0 C25 + 10.0
 C26 + 24.0 C27 + 20.0 C28 + 23.0 C29 = 46
R17: 2.0 C0 + 4.0 C1 + 2.0 C2 + 3.0 C3 + 2.0 C4 + 2.0 C5 + 2.0 C6 + 4.0 C7 + 4.0 C8 +
5.0 C9 + 2.0 C10 + 4.0 C11 + 4.0 C12 + 4.0 C13 + 2.0 C14 + 4.0 C15 + 3.0 C16 + 4.0 C17 +
5.0 C18 + 3.0 C19 + 10.0 C20 + 6.0 C21 + 20.0 C22 + 21.0 C23 + 16.0 C24 + 15.0 C25 +
 13.0 C26 + 3.0 C27 + 24.0 C28 + 16.0 C29 = 35
R18: 2.0 C0 + 5.0 C1 + 4.0 C2 + 3.0 C3 + 3.0 C4 + 3.0 C5 + 4.0 C6 + 2.0 C7 + 5.0 C8 +
4.0 C9 + 2.0 C10 + 4.0 C11 + 5.0 C12 + 2.0 C13 + 2.0 C14 + 2.0 C15 + 3.0 C16 + 5.0 C17 +
4.0 C18 + 5.0 C19 + 12.0 C20 + 18.0 C21 + 21.0 C22 + 8.0 C23 + 19.0 C24 + 8.0 C25 + 11.0
 C26 + 20.0 C27 + 21.0 C28 + 21.0 C29 = 46
R19: 4.0 C0 + 2.0 C1 + 2.0 C2 + 2.0 C3 + 2.0 C4 + 2.0 C5 + 4.0 C6 + 3.0 C7 + 4.0 C8 +
3.0 C9 + 2.0 C10 + 2.0 C11 + 4.0 C12 + 2.0 C13 + 4.0 C14 + 3.0 C15 + 5.0 C16 + 2.0 C17 +
4.0 C18 + 3.0 C19 + 11.0 C20 + 4.0 C21 + 2.0 C22 + 9.0 C23 + 13.0 C24 + 20.0 C25 + 23.0
 C26 + 16.0 C27 + 16.0 C28 + 14.0 C29 = 32
None
Gurobi Optimizer version 10.0.3 build v10.0.3rc0 (mac64[arm])

CPU model: Apple M1
Thread count: 8 physical cores, 8 logical processors, using up to 8 threads

Optimize a model with 20 rows, 30 columns and 600 nonzeros
Model fingerprint: 0x05cb70d4
Coefficient statistics:
  Matrix range     [2e+00, 2e+01]
  Objective range  [2e+00, 1e+01]
  Bounds range     [0e+00, 0e+00]
  RHS range        [2e+01, 5e+01]
Presolve time: 0.00s
Presolved: 20 rows, 30 columns, 600 nonzeros

Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0    3.3913043e+00   5.119565e+01   0.000000e+00      0s

Solved in 13 iterations and 0.01 seconds (0.00 work units)
Infeasible model</code></pre>
</div>
</div>
<div class="cell" data-execution_count="156">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1"></a><span class="im">import</span> gurobipy <span class="im">as</span> gp</span>
<span id="cb37-2"><a href="#cb37-2"></a><span class="im">from</span> gurobipy <span class="im">import</span> GRB</span>
<span id="cb37-3"><a href="#cb37-3"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb37-4"><a href="#cb37-4"></a></span>
<span id="cb37-5"><a href="#cb37-5"></a>np.random.seed(<span class="dv">142</span>)</span>
<span id="cb37-6"><a href="#cb37-6"></a>c <span class="op">=</span> np.random.randint(<span class="dv">2</span>, <span class="dv">6</span>, size<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb37-7"><a href="#cb37-7"></a>f <span class="op">=</span> np.random.randint(<span class="dv">1</span>, <span class="dv">15</span>, size<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb37-8"><a href="#cb37-8"></a>A <span class="op">=</span> np.random.randint(<span class="dv">2</span>, <span class="dv">6</span>, size<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">20</span>))</span>
<span id="cb37-9"><a href="#cb37-9"></a>B <span class="op">=</span> np.random.randint(<span class="dv">2</span>, <span class="dv">26</span>, size<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">10</span>))</span>
<span id="cb37-10"><a href="#cb37-10"></a>b <span class="op">=</span> np.random.randint(<span class="dv">20</span>, <span class="dv">50</span>, size<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb37-11"><a href="#cb37-11"></a></span>
<span id="cb37-12"><a href="#cb37-12"></a>master_solver <span class="op">=</span> GenericLpMasterSolver(f, B, b)</span>
<span id="cb37-13"><a href="#cb37-13"></a>dual_subprob_solver <span class="op">=</span> GenericLpSubprobSolver(A, c, B, b)</span>
<span id="cb37-14"><a href="#cb37-14"></a></span>
<span id="cb37-15"><a href="#cb37-15"></a>benders_solver <span class="op">=</span> GenericBendersSolver(master_solver, dual_subprob_solver)</span>
<span id="cb37-16"><a href="#cb37-16"></a>benders_solver.optimize()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Set parameter Username
Set parameter LogFile to value "MasterEnv"
Set parameter Username
Set parameter LogFile to value "SubprobEnv"
--------------------------------------------------
Start solving master problem.
Minimize
3.0 y[0] + 6.0 y[1] + 8.0 y[2] + 12.0 y[3] + 3.0 y[4] + 5.0 y[5] + 4.0 y[6] + 4.0 y[7]
+ 9.0 y[8] + 3.0 y[9] + g
Subject To
None
Gurobi Optimizer version 10.0.3 build v10.0.3rc0 (mac64[arm])

CPU model: Apple M1
Thread count: 8 physical cores, 8 logical processors, using up to 8 threads

Optimize a model with 0 rows, 11 columns and 0 nonzeros
Model fingerprint: 0xb01aa8a2
Coefficient statistics:
  Matrix range     [0e+00, 0e+00]
  Objective range  [1e+00, 1e+01]
  Bounds range     [0e+00, 0e+00]
  RHS range        [0e+00, 0e+00]
Presolve removed 0 rows and 11 columns
Presolve time: 0.00s
Presolve: All rows and columns removed
Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0    0.0000000e+00   0.000000e+00   0.000000e+00      0s

Solved in 0 iterations and 0.00 seconds (0.00 work units)
Optimal objective  0.000000000e+00
    master problem is optimal.
    opt_obj=0.00
    opt_g=0.00
Finish solving master problem.
--------------------------------------------------
Bounds: lb=0.00, ub=inf
dual subproblem objective updated!
--------------------------------------------------
Start solving dual subproblem.
    dual subproblem is optimal.
    opt_obj=28.16
Finish solving dual subproblem.
--------------------------------------------------
Bounds: lb=0.00, ub=28.16
Minimize
3.0 y[0] + 6.0 y[1] + 8.0 y[2] + 12.0 y[3] + 3.0 y[4] + 5.0 y[5] + 4.0 y[6] + 4.0 y[7]
+ 9.0 y[8] + 3.0 y[9] + g
Subject To
R0: -8.5625 y[0] + -9.859375 y[1] + -9.5625 y[2] + -7.9375 y[3] + -12.125 y[4] +
-11.828125 y[5] + -11.21875 y[6] + -11.46875 y[7] + -10.21875 y[8] + -10.5 y[9] + -1.0 g
 &lt;= -28.1562
None
Benders optimality cut added!
--------------------------------------------------
Start solving master problem.
Minimize
3.0 y[0] + 6.0 y[1] + 8.0 y[2] + 12.0 y[3] + 3.0 y[4] + 5.0 y[5] + 4.0 y[6] + 4.0 y[7]
+ 9.0 y[8] + 3.0 y[9] + g
Subject To
R0: -8.5625 y[0] + -9.859375 y[1] + -9.5625 y[2] + -7.9375 y[3] + -12.125 y[4] +
-11.828125 y[5] + -11.21875 y[6] + -11.46875 y[7] + -10.21875 y[8] + -10.5 y[9] + -1.0 g
 &lt;= -28.1562
None
Gurobi Optimizer version 10.0.3 build v10.0.3rc0 (mac64[arm])

CPU model: Apple M1
Thread count: 8 physical cores, 8 logical processors, using up to 8 threads

Optimize a model with 1 rows, 11 columns and 11 nonzeros
Coefficient statistics:
  Matrix range     [1e+00, 1e+01]
  Objective range  [1e+00, 1e+01]
  Bounds range     [0e+00, 0e+00]
  RHS range        [3e+01, 3e+01]
Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0    0.0000000e+00   1.759766e+00   0.000000e+00      0s
       1    6.9664948e+00   0.000000e+00   0.000000e+00      0s

Solved in 1 iterations and 0.00 seconds (0.00 work units)
Optimal objective  6.966494845e+00
    master problem is optimal.
    opt_obj=6.97
    opt_g=0.00
Finish solving master problem.
--------------------------------------------------
Bounds: lb=6.97, ub=28.16
dual subproblem objective updated!
--------------------------------------------------
Start solving dual subproblem.
    dual subproblem is optimal.
    opt_obj=11.82
Finish solving dual subproblem.
--------------------------------------------------
Bounds: lb=6.97, ub=18.78
Minimize
3.0 y[0] + 6.0 y[1] + 8.0 y[2] + 12.0 y[3] + 3.0 y[4] + 5.0 y[5] + 4.0 y[6] + 4.0 y[7]
+ 9.0 y[8] + 3.0 y[9] + g
Subject To
R0: -8.5625 y[0] + -9.859375 y[1] + -9.5625 y[2] + -7.9375 y[3] + -12.125 y[4] +
-11.828125 y[5] + -11.21875 y[6] + -11.46875 y[7] + -10.21875 y[8] + -10.5 y[9] + -1.0 g
 &lt;= -28.1562
R1: -8.76923076923077 y[0] + -6.153846153846153 y[1] + -8.307692307692307 y[2] +
-7.692307692307692 y[3] + -2.0 y[4] + -8.923076923076923 y[5] + -6.769230769230769 y[6]
+ -8.307692307692307 y[7] + -4.153846153846153 y[8] + -6.461538461538462 y[9] + -1.0 g
 &lt;= -16.4615
None
Benders optimality cut added!
--------------------------------------------------
Start solving master problem.
Minimize
3.0 y[0] + 6.0 y[1] + 8.0 y[2] + 12.0 y[3] + 3.0 y[4] + 5.0 y[5] + 4.0 y[6] + 4.0 y[7]
+ 9.0 y[8] + 3.0 y[9] + g
Subject To
R0: -8.5625 y[0] + -9.859375 y[1] + -9.5625 y[2] + -7.9375 y[3] + -12.125 y[4] +
-11.828125 y[5] + -11.21875 y[6] + -11.46875 y[7] + -10.21875 y[8] + -10.5 y[9] + -1.0 g
 &lt;= -28.1562
R1: -8.76923076923077 y[0] + -6.153846153846153 y[1] + -8.307692307692307 y[2] +
-7.692307692307692 y[3] + -2.0 y[4] + -8.923076923076923 y[5] + -6.769230769230769 y[6]
+ -8.307692307692307 y[7] + -4.153846153846153 y[8] + -6.461538461538462 y[9] + -1.0 g
 &lt;= -16.4615
None
Gurobi Optimizer version 10.0.3 build v10.0.3rc0 (mac64[arm])

CPU model: Apple M1
Thread count: 8 physical cores, 8 logical processors, using up to 8 threads

Optimize a model with 2 rows, 11 columns and 22 nonzeros
Coefficient statistics:
  Matrix range     [1e+00, 1e+01]
  Objective range  [1e+00, 1e+01]
  Bounds range     [0e+00, 0e+00]
  RHS range        [2e+01, 3e+01]
Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0    6.9664948e+00   7.385755e-01   0.000000e+00      0s
       1    7.9710765e+00   0.000000e+00   0.000000e+00      0s

Solved in 1 iterations and 0.00 seconds (0.00 work units)
Optimal objective  7.971076459e+00
    master problem is optimal.
    opt_obj=7.97
    opt_g=0.00
Finish solving master problem.
--------------------------------------------------
Bounds: lb=7.97, ub=18.78
dual subproblem objective updated!
--------------------------------------------------
Start solving dual subproblem.
    dual subproblem is optimal.
    opt_obj=14.74
Finish solving dual subproblem.
--------------------------------------------------
Bounds: lb=7.97, ub=18.78
Minimize
3.0 y[0] + 6.0 y[1] + 8.0 y[2] + 12.0 y[3] + 3.0 y[4] + 5.0 y[5] + 4.0 y[6] + 4.0 y[7]
+ 9.0 y[8] + 3.0 y[9] + g
Subject To
R0: -8.5625 y[0] + -9.859375 y[1] + -9.5625 y[2] + -7.9375 y[3] + -12.125 y[4] +
-11.828125 y[5] + -11.21875 y[6] + -11.46875 y[7] + -10.21875 y[8] + -10.5 y[9] + -1.0 g
 &lt;= -28.1562
R1: -8.76923076923077 y[0] + -6.153846153846153 y[1] + -8.307692307692307 y[2] +
-7.692307692307692 y[3] + -2.0 y[4] + -8.923076923076923 y[5] + -6.769230769230769 y[6]
+ -8.307692307692307 y[7] + -4.153846153846153 y[8] + -6.461538461538462 y[9] + -1.0 g
 &lt;= -16.4615
R2: -10.75 y[0] + -10.124999999999998 y[1] + -11.75 y[2] + -11.5 y[3] + -8.75 y[4] +
-12.874999999999998 y[5] + -10.25 y[6] + -8.25 y[7] + -5.5 y[8] + -3.7499999999999996
 y[9] + -1.0 g &lt;= -25.5
None
Benders optimality cut added!
--------------------------------------------------
Start solving master problem.
Minimize
3.0 y[0] + 6.0 y[1] + 8.0 y[2] + 12.0 y[3] + 3.0 y[4] + 5.0 y[5] + 4.0 y[6] + 4.0 y[7]
+ 9.0 y[8] + 3.0 y[9] + g
Subject To
R0: -8.5625 y[0] + -9.859375 y[1] + -9.5625 y[2] + -7.9375 y[3] + -12.125 y[4] +
-11.828125 y[5] + -11.21875 y[6] + -11.46875 y[7] + -10.21875 y[8] + -10.5 y[9] + -1.0 g
 &lt;= -28.1562
R1: -8.76923076923077 y[0] + -6.153846153846153 y[1] + -8.307692307692307 y[2] +
-7.692307692307692 y[3] + -2.0 y[4] + -8.923076923076923 y[5] + -6.769230769230769 y[6]
+ -8.307692307692307 y[7] + -4.153846153846153 y[8] + -6.461538461538462 y[9] + -1.0 g
 &lt;= -16.4615
R2: -10.75 y[0] + -10.124999999999998 y[1] + -11.75 y[2] + -11.5 y[3] + -8.75 y[4] +
-12.874999999999998 y[5] + -10.25 y[6] + -8.25 y[7] + -5.5 y[8] + -3.7499999999999996
 y[9] + -1.0 g &lt;= -25.5
None
Gurobi Optimizer version 10.0.3 build v10.0.3rc0 (mac64[arm])

CPU model: Apple M1
Thread count: 8 physical cores, 8 logical processors, using up to 8 threads

Optimize a model with 3 rows, 11 columns and 33 nonzeros
Coefficient statistics:
  Matrix range     [1e+00, 1e+01]
  Objective range  [1e+00, 1e+01]
  Bounds range     [0e+00, 0e+00]
  RHS range        [2e+01, 3e+01]
Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0    7.9710765e+00   9.214938e-01   0.000000e+00      0s
       1    8.3297685e+00   0.000000e+00   0.000000e+00      0s

Solved in 1 iterations and 0.00 seconds (0.00 work units)
Optimal objective  8.329768548e+00
    master problem is optimal.
    opt_obj=8.33
    opt_g=0.00
Finish solving master problem.
--------------------------------------------------
Bounds: lb=8.33, ub=18.78
dual subproblem objective updated!
--------------------------------------------------
Start solving dual subproblem.
    dual subproblem is optimal.
    opt_obj=5.92
Finish solving dual subproblem.
--------------------------------------------------
Bounds: lb=8.33, ub=14.25
Minimize
3.0 y[0] + 6.0 y[1] + 8.0 y[2] + 12.0 y[3] + 3.0 y[4] + 5.0 y[5] + 4.0 y[6] + 4.0 y[7]
+ 9.0 y[8] + 3.0 y[9] + g
Subject To
R0: -8.5625 y[0] + -9.859375 y[1] + -9.5625 y[2] + -7.9375 y[3] + -12.125 y[4] +
-11.828125 y[5] + -11.21875 y[6] + -11.46875 y[7] + -10.21875 y[8] + -10.5 y[9] + -1.0 g
 &lt;= -28.1562
R1: -8.76923076923077 y[0] + -6.153846153846153 y[1] + -8.307692307692307 y[2] +
-7.692307692307692 y[3] + -2.0 y[4] + -8.923076923076923 y[5] + -6.769230769230769 y[6]
+ -8.307692307692307 y[7] + -4.153846153846153 y[8] + -6.461538461538462 y[9] + -1.0 g
 &lt;= -16.4615
R2: -10.75 y[0] + -10.124999999999998 y[1] + -11.75 y[2] + -11.5 y[3] + -8.75 y[4] +
-12.874999999999998 y[5] + -10.25 y[6] + -8.25 y[7] + -5.5 y[8] + -3.7499999999999996
 y[9] + -1.0 g &lt;= -25.5
R3: -3.0 y[0] + -8.75 y[1] + -2.75 y[2] + -10.25 y[3] + -5.5 y[4] + -10.0 y[5] + -11.5
 y[6] + -6.0 y[7] + -8.75 y[8] + -7.25 y[9] + -1.0 g &lt;= -18.25
None
Benders optimality cut added!
--------------------------------------------------
Start solving master problem.
Minimize
3.0 y[0] + 6.0 y[1] + 8.0 y[2] + 12.0 y[3] + 3.0 y[4] + 5.0 y[5] + 4.0 y[6] + 4.0 y[7]
+ 9.0 y[8] + 3.0 y[9] + g
Subject To
R0: -8.5625 y[0] + -9.859375 y[1] + -9.5625 y[2] + -7.9375 y[3] + -12.125 y[4] +
-11.828125 y[5] + -11.21875 y[6] + -11.46875 y[7] + -10.21875 y[8] + -10.5 y[9] + -1.0 g
 &lt;= -28.1562
R1: -8.76923076923077 y[0] + -6.153846153846153 y[1] + -8.307692307692307 y[2] +
-7.692307692307692 y[3] + -2.0 y[4] + -8.923076923076923 y[5] + -6.769230769230769 y[6]
+ -8.307692307692307 y[7] + -4.153846153846153 y[8] + -6.461538461538462 y[9] + -1.0 g
 &lt;= -16.4615
R2: -10.75 y[0] + -10.124999999999998 y[1] + -11.75 y[2] + -11.5 y[3] + -8.75 y[4] +
-12.874999999999998 y[5] + -10.25 y[6] + -8.25 y[7] + -5.5 y[8] + -3.7499999999999996
 y[9] + -1.0 g &lt;= -25.5
R3: -3.0 y[0] + -8.75 y[1] + -2.75 y[2] + -10.25 y[3] + -5.5 y[4] + -10.0 y[5] + -11.5
 y[6] + -6.0 y[7] + -8.75 y[8] + -7.25 y[9] + -1.0 g &lt;= -18.25
None
Gurobi Optimizer version 10.0.3 build v10.0.3rc0 (mac64[arm])

CPU model: Apple M1
Thread count: 8 physical cores, 8 logical processors, using up to 8 threads

Optimize a model with 4 rows, 11 columns and 44 nonzeros
Coefficient statistics:
  Matrix range     [1e+00, 1e+01]
  Objective range  [1e+00, 1e+01]
  Bounds range     [0e+00, 0e+00]
  RHS range        [2e+01, 3e+01]
Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0    8.3297685e+00   3.701343e-01   0.000000e+00      0s
       1    8.9196232e+00   0.000000e+00   0.000000e+00      0s

Solved in 1 iterations and 0.00 seconds (0.00 work units)
Optimal objective  8.919623169e+00
    master problem is optimal.
    opt_obj=8.92
    opt_g=0.00
Finish solving master problem.
--------------------------------------------------
Bounds: lb=8.92, ub=14.25
dual subproblem objective updated!
--------------------------------------------------
Start solving dual subproblem.
    dual subproblem is optimal.
    opt_obj=6.12
Finish solving dual subproblem.
--------------------------------------------------
Bounds: lb=8.92, ub=14.25
Minimize
3.0 y[0] + 6.0 y[1] + 8.0 y[2] + 12.0 y[3] + 3.0 y[4] + 5.0 y[5] + 4.0 y[6] + 4.0 y[7]
+ 9.0 y[8] + 3.0 y[9] + g
Subject To
R0: -8.5625 y[0] + -9.859375 y[1] + -9.5625 y[2] + -7.9375 y[3] + -12.125 y[4] +
-11.828125 y[5] + -11.21875 y[6] + -11.46875 y[7] + -10.21875 y[8] + -10.5 y[9] + -1.0 g
 &lt;= -28.1562
R1: -8.76923076923077 y[0] + -6.153846153846153 y[1] + -8.307692307692307 y[2] +
-7.692307692307692 y[3] + -2.0 y[4] + -8.923076923076923 y[5] + -6.769230769230769 y[6]
+ -8.307692307692307 y[7] + -4.153846153846153 y[8] + -6.461538461538462 y[9] + -1.0 g
 &lt;= -16.4615
R2: -10.75 y[0] + -10.124999999999998 y[1] + -11.75 y[2] + -11.5 y[3] + -8.75 y[4] +
-12.874999999999998 y[5] + -10.25 y[6] + -8.25 y[7] + -5.5 y[8] + -3.7499999999999996
 y[9] + -1.0 g &lt;= -25.5
R3: -3.0 y[0] + -8.75 y[1] + -2.75 y[2] + -10.25 y[3] + -5.5 y[4] + -10.0 y[5] + -11.5
 y[6] + -6.0 y[7] + -8.75 y[8] + -7.25 y[9] + -1.0 g &lt;= -18.25
R4: -0.8 y[0] + -5.2 y[1] + -9.200000000000001 y[2] + -3.2 y[3] + -8.8 y[4] +
-6.800000000000001 y[5] + -4.0 y[6] + -9.600000000000001 y[7] + -8.0 y[8] +
 -9.200000000000001 y[9] + -1.0 g &lt;= -18.4
None
Benders optimality cut added!
--------------------------------------------------
Start solving master problem.
Minimize
3.0 y[0] + 6.0 y[1] + 8.0 y[2] + 12.0 y[3] + 3.0 y[4] + 5.0 y[5] + 4.0 y[6] + 4.0 y[7]
+ 9.0 y[8] + 3.0 y[9] + g
Subject To
R0: -8.5625 y[0] + -9.859375 y[1] + -9.5625 y[2] + -7.9375 y[3] + -12.125 y[4] +
-11.828125 y[5] + -11.21875 y[6] + -11.46875 y[7] + -10.21875 y[8] + -10.5 y[9] + -1.0 g
 &lt;= -28.1562
R1: -8.76923076923077 y[0] + -6.153846153846153 y[1] + -8.307692307692307 y[2] +
-7.692307692307692 y[3] + -2.0 y[4] + -8.923076923076923 y[5] + -6.769230769230769 y[6]
+ -8.307692307692307 y[7] + -4.153846153846153 y[8] + -6.461538461538462 y[9] + -1.0 g
 &lt;= -16.4615
R2: -10.75 y[0] + -10.124999999999998 y[1] + -11.75 y[2] + -11.5 y[3] + -8.75 y[4] +
-12.874999999999998 y[5] + -10.25 y[6] + -8.25 y[7] + -5.5 y[8] + -3.7499999999999996
 y[9] + -1.0 g &lt;= -25.5
R3: -3.0 y[0] + -8.75 y[1] + -2.75 y[2] + -10.25 y[3] + -5.5 y[4] + -10.0 y[5] + -11.5
 y[6] + -6.0 y[7] + -8.75 y[8] + -7.25 y[9] + -1.0 g &lt;= -18.25
R4: -0.8 y[0] + -5.2 y[1] + -9.200000000000001 y[2] + -3.2 y[3] + -8.8 y[4] +
-6.800000000000001 y[5] + -4.0 y[6] + -9.600000000000001 y[7] + -8.0 y[8] +
 -9.200000000000001 y[9] + -1.0 g &lt;= -18.4
None
Gurobi Optimizer version 10.0.3 build v10.0.3rc0 (mac64[arm])

CPU model: Apple M1
Thread count: 8 physical cores, 8 logical processors, using up to 8 threads

Optimize a model with 5 rows, 11 columns and 55 nonzeros
Coefficient statistics:
  Matrix range     [8e-01, 1e+01]
  Objective range  [1e+00, 1e+01]
  Bounds range     [0e+00, 0e+00]
  RHS range        [2e+01, 3e+01]
Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0    8.9196232e+00   3.825374e-01   0.000000e+00      0s
       1    9.5016530e+00   0.000000e+00   0.000000e+00      0s

Solved in 1 iterations and 0.00 seconds (0.00 work units)
Optimal objective  9.501652960e+00
    master problem is optimal.
    opt_obj=9.50
    opt_g=0.00
Finish solving master problem.
--------------------------------------------------
Bounds: lb=9.50, ub=14.25
dual subproblem objective updated!
--------------------------------------------------
Start solving dual subproblem.
    dual subproblem is optimal.
    opt_obj=2.23
Finish solving dual subproblem.
--------------------------------------------------
Bounds: lb=9.50, ub=11.73
Minimize
3.0 y[0] + 6.0 y[1] + 8.0 y[2] + 12.0 y[3] + 3.0 y[4] + 5.0 y[5] + 4.0 y[6] + 4.0 y[7]
+ 9.0 y[8] + 3.0 y[9] + g
Subject To
R0: -8.5625 y[0] + -9.859375 y[1] + -9.5625 y[2] + -7.9375 y[3] + -12.125 y[4] +
-11.828125 y[5] + -11.21875 y[6] + -11.46875 y[7] + -10.21875 y[8] + -10.5 y[9] + -1.0 g
 &lt;= -28.1562
R1: -8.76923076923077 y[0] + -6.153846153846153 y[1] + -8.307692307692307 y[2] +
-7.692307692307692 y[3] + -2.0 y[4] + -8.923076923076923 y[5] + -6.769230769230769 y[6]
+ -8.307692307692307 y[7] + -4.153846153846153 y[8] + -6.461538461538462 y[9] + -1.0 g
 &lt;= -16.4615
R2: -10.75 y[0] + -10.124999999999998 y[1] + -11.75 y[2] + -11.5 y[3] + -8.75 y[4] +
-12.874999999999998 y[5] + -10.25 y[6] + -8.25 y[7] + -5.5 y[8] + -3.7499999999999996
 y[9] + -1.0 g &lt;= -25.5
R3: -3.0 y[0] + -8.75 y[1] + -2.75 y[2] + -10.25 y[3] + -5.5 y[4] + -10.0 y[5] + -11.5
 y[6] + -6.0 y[7] + -8.75 y[8] + -7.25 y[9] + -1.0 g &lt;= -18.25
R4: -0.8 y[0] + -5.2 y[1] + -9.200000000000001 y[2] + -3.2 y[3] + -8.8 y[4] +
-6.800000000000001 y[5] + -4.0 y[6] + -9.600000000000001 y[7] + -8.0 y[8] +
 -9.200000000000001 y[9] + -1.0 g &lt;= -18.4
R5: -7.6000000000000005 y[0] + -2.4000000000000004 y[1] + -8.0 y[2] + -6.4 y[3] + -2.0
y[4] + -5.6000000000000005 y[5] + -8.0 y[6] + -7.2 y[7] + -7.6000000000000005 y[8] +
 -2.4000000000000004 y[9] + -1.0 g &lt;= -15.6
None
Benders optimality cut added!
--------------------------------------------------
Start solving master problem.
Minimize
3.0 y[0] + 6.0 y[1] + 8.0 y[2] + 12.0 y[3] + 3.0 y[4] + 5.0 y[5] + 4.0 y[6] + 4.0 y[7]
+ 9.0 y[8] + 3.0 y[9] + g
Subject To
R0: -8.5625 y[0] + -9.859375 y[1] + -9.5625 y[2] + -7.9375 y[3] + -12.125 y[4] +
-11.828125 y[5] + -11.21875 y[6] + -11.46875 y[7] + -10.21875 y[8] + -10.5 y[9] + -1.0 g
 &lt;= -28.1562
R1: -8.76923076923077 y[0] + -6.153846153846153 y[1] + -8.307692307692307 y[2] +
-7.692307692307692 y[3] + -2.0 y[4] + -8.923076923076923 y[5] + -6.769230769230769 y[6]
+ -8.307692307692307 y[7] + -4.153846153846153 y[8] + -6.461538461538462 y[9] + -1.0 g
 &lt;= -16.4615
R2: -10.75 y[0] + -10.124999999999998 y[1] + -11.75 y[2] + -11.5 y[3] + -8.75 y[4] +
-12.874999999999998 y[5] + -10.25 y[6] + -8.25 y[7] + -5.5 y[8] + -3.7499999999999996
 y[9] + -1.0 g &lt;= -25.5
R3: -3.0 y[0] + -8.75 y[1] + -2.75 y[2] + -10.25 y[3] + -5.5 y[4] + -10.0 y[5] + -11.5
 y[6] + -6.0 y[7] + -8.75 y[8] + -7.25 y[9] + -1.0 g &lt;= -18.25
R4: -0.8 y[0] + -5.2 y[1] + -9.200000000000001 y[2] + -3.2 y[3] + -8.8 y[4] +
-6.800000000000001 y[5] + -4.0 y[6] + -9.600000000000001 y[7] + -8.0 y[8] +
 -9.200000000000001 y[9] + -1.0 g &lt;= -18.4
R5: -7.6000000000000005 y[0] + -2.4000000000000004 y[1] + -8.0 y[2] + -6.4 y[3] + -2.0
y[4] + -5.6000000000000005 y[5] + -8.0 y[6] + -7.2 y[7] + -7.6000000000000005 y[8] +
 -2.4000000000000004 y[9] + -1.0 g &lt;= -15.6
None
Gurobi Optimizer version 10.0.3 build v10.0.3rc0 (mac64[arm])

CPU model: Apple M1
Thread count: 8 physical cores, 8 logical processors, using up to 8 threads

Optimize a model with 6 rows, 11 columns and 66 nonzeros
Coefficient statistics:
  Matrix range     [8e-01, 1e+01]
  Objective range  [1e+00, 1e+01]
  Bounds range     [0e+00, 0e+00]
  RHS range        [2e+01, 3e+01]
Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0    9.5016530e+00   2.782364e-01   0.000000e+00      0s
       1    9.6700817e+00   0.000000e+00   0.000000e+00      0s

Solved in 1 iterations and 0.01 seconds (0.00 work units)
Optimal objective  9.670081743e+00
    master problem is optimal.
    opt_obj=9.67
    opt_g=0.00
Finish solving master problem.
--------------------------------------------------
Bounds: lb=9.67, ub=11.73
dual subproblem objective updated!
--------------------------------------------------
Start solving dual subproblem.
    dual subproblem is optimal.
    opt_obj=2.23
Finish solving dual subproblem.
--------------------------------------------------
Bounds: lb=9.67, ub=11.73
Minimize
3.0 y[0] + 6.0 y[1] + 8.0 y[2] + 12.0 y[3] + 3.0 y[4] + 5.0 y[5] + 4.0 y[6] + 4.0 y[7]
+ 9.0 y[8] + 3.0 y[9] + g
Subject To
R0: -8.5625 y[0] + -9.859375 y[1] + -9.5625 y[2] + -7.9375 y[3] + -12.125 y[4] +
-11.828125 y[5] + -11.21875 y[6] + -11.46875 y[7] + -10.21875 y[8] + -10.5 y[9] + -1.0 g
 &lt;= -28.1562
R1: -8.76923076923077 y[0] + -6.153846153846153 y[1] + -8.307692307692307 y[2] +
-7.692307692307692 y[3] + -2.0 y[4] + -8.923076923076923 y[5] + -6.769230769230769 y[6]
+ -8.307692307692307 y[7] + -4.153846153846153 y[8] + -6.461538461538462 y[9] + -1.0 g
 &lt;= -16.4615
R2: -10.75 y[0] + -10.124999999999998 y[1] + -11.75 y[2] + -11.5 y[3] + -8.75 y[4] +
-12.874999999999998 y[5] + -10.25 y[6] + -8.25 y[7] + -5.5 y[8] + -3.7499999999999996
 y[9] + -1.0 g &lt;= -25.5
R3: -3.0 y[0] + -8.75 y[1] + -2.75 y[2] + -10.25 y[3] + -5.5 y[4] + -10.0 y[5] + -11.5
 y[6] + -6.0 y[7] + -8.75 y[8] + -7.25 y[9] + -1.0 g &lt;= -18.25
R4: -0.8 y[0] + -5.2 y[1] + -9.200000000000001 y[2] + -3.2 y[3] + -8.8 y[4] +
-6.800000000000001 y[5] + -4.0 y[6] + -9.600000000000001 y[7] + -8.0 y[8] +
 -9.200000000000001 y[9] + -1.0 g &lt;= -18.4
R5: -7.6000000000000005 y[0] + -2.4000000000000004 y[1] + -8.0 y[2] + -6.4 y[3] + -2.0
y[4] + -5.6000000000000005 y[5] + -8.0 y[6] + -7.2 y[7] + -7.6000000000000005 y[8] +
 -2.4000000000000004 y[9] + -1.0 g &lt;= -15.6
R6: -5.0 y[0] + -3.0 y[1] + -10.0 y[2] + -10.5 y[3] + -8.0 y[4] + -7.5 y[5] + -6.5 y[6]
 + -1.5 y[7] + -12.0 y[8] + -8.0 y[9] + -1.0 g &lt;= -17.5
None
Benders optimality cut added!
--------------------------------------------------
Start solving master problem.
Minimize
3.0 y[0] + 6.0 y[1] + 8.0 y[2] + 12.0 y[3] + 3.0 y[4] + 5.0 y[5] + 4.0 y[6] + 4.0 y[7]
+ 9.0 y[8] + 3.0 y[9] + g
Subject To
R0: -8.5625 y[0] + -9.859375 y[1] + -9.5625 y[2] + -7.9375 y[3] + -12.125 y[4] +
-11.828125 y[5] + -11.21875 y[6] + -11.46875 y[7] + -10.21875 y[8] + -10.5 y[9] + -1.0 g
 &lt;= -28.1562
R1: -8.76923076923077 y[0] + -6.153846153846153 y[1] + -8.307692307692307 y[2] +
-7.692307692307692 y[3] + -2.0 y[4] + -8.923076923076923 y[5] + -6.769230769230769 y[6]
+ -8.307692307692307 y[7] + -4.153846153846153 y[8] + -6.461538461538462 y[9] + -1.0 g
 &lt;= -16.4615
R2: -10.75 y[0] + -10.124999999999998 y[1] + -11.75 y[2] + -11.5 y[3] + -8.75 y[4] +
-12.874999999999998 y[5] + -10.25 y[6] + -8.25 y[7] + -5.5 y[8] + -3.7499999999999996
 y[9] + -1.0 g &lt;= -25.5
R3: -3.0 y[0] + -8.75 y[1] + -2.75 y[2] + -10.25 y[3] + -5.5 y[4] + -10.0 y[5] + -11.5
 y[6] + -6.0 y[7] + -8.75 y[8] + -7.25 y[9] + -1.0 g &lt;= -18.25
R4: -0.8 y[0] + -5.2 y[1] + -9.200000000000001 y[2] + -3.2 y[3] + -8.8 y[4] +
-6.800000000000001 y[5] + -4.0 y[6] + -9.600000000000001 y[7] + -8.0 y[8] +
 -9.200000000000001 y[9] + -1.0 g &lt;= -18.4
R5: -7.6000000000000005 y[0] + -2.4000000000000004 y[1] + -8.0 y[2] + -6.4 y[3] + -2.0
y[4] + -5.6000000000000005 y[5] + -8.0 y[6] + -7.2 y[7] + -7.6000000000000005 y[8] +
 -2.4000000000000004 y[9] + -1.0 g &lt;= -15.6
R6: -5.0 y[0] + -3.0 y[1] + -10.0 y[2] + -10.5 y[3] + -8.0 y[4] + -7.5 y[5] + -6.5 y[6]
 + -1.5 y[7] + -12.0 y[8] + -8.0 y[9] + -1.0 g &lt;= -17.5
None
Gurobi Optimizer version 10.0.3 build v10.0.3rc0 (mac64[arm])

CPU model: Apple M1
Thread count: 8 physical cores, 8 logical processors, using up to 8 threads

Optimize a model with 7 rows, 11 columns and 77 nonzeros
Coefficient statistics:
  Matrix range     [8e-01, 1e+01]
  Objective range  [1e+00, 1e+01]
  Bounds range     [0e+00, 0e+00]
  RHS range        [2e+01, 3e+01]
Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0    9.6700817e+00   1.396581e-01   0.000000e+00      0s
       1    9.8201416e+00   0.000000e+00   0.000000e+00      0s

Solved in 1 iterations and 0.00 seconds (0.00 work units)
Optimal objective  9.820141589e+00
    master problem is optimal.
    opt_obj=9.82
    opt_g=0.00
Finish solving master problem.
--------------------------------------------------
Bounds: lb=9.82, ub=11.73
dual subproblem objective updated!
--------------------------------------------------
Start solving dual subproblem.
    dual subproblem is optimal.
    opt_obj=1.40
Finish solving dual subproblem.
--------------------------------------------------
Bounds: lb=9.82, ub=11.22
Minimize
3.0 y[0] + 6.0 y[1] + 8.0 y[2] + 12.0 y[3] + 3.0 y[4] + 5.0 y[5] + 4.0 y[6] + 4.0 y[7]
+ 9.0 y[8] + 3.0 y[9] + g
Subject To
R0: -8.5625 y[0] + -9.859375 y[1] + -9.5625 y[2] + -7.9375 y[3] + -12.125 y[4] +
-11.828125 y[5] + -11.21875 y[6] + -11.46875 y[7] + -10.21875 y[8] + -10.5 y[9] + -1.0 g
 &lt;= -28.1562
R1: -8.76923076923077 y[0] + -6.153846153846153 y[1] + -8.307692307692307 y[2] +
-7.692307692307692 y[3] + -2.0 y[4] + -8.923076923076923 y[5] + -6.769230769230769 y[6]
+ -8.307692307692307 y[7] + -4.153846153846153 y[8] + -6.461538461538462 y[9] + -1.0 g
 &lt;= -16.4615
R2: -10.75 y[0] + -10.124999999999998 y[1] + -11.75 y[2] + -11.5 y[3] + -8.75 y[4] +
-12.874999999999998 y[5] + -10.25 y[6] + -8.25 y[7] + -5.5 y[8] + -3.7499999999999996
 y[9] + -1.0 g &lt;= -25.5
R3: -3.0 y[0] + -8.75 y[1] + -2.75 y[2] + -10.25 y[3] + -5.5 y[4] + -10.0 y[5] + -11.5
 y[6] + -6.0 y[7] + -8.75 y[8] + -7.25 y[9] + -1.0 g &lt;= -18.25
R4: -0.8 y[0] + -5.2 y[1] + -9.200000000000001 y[2] + -3.2 y[3] + -8.8 y[4] +
-6.800000000000001 y[5] + -4.0 y[6] + -9.600000000000001 y[7] + -8.0 y[8] +
 -9.200000000000001 y[9] + -1.0 g &lt;= -18.4
R5: -7.6000000000000005 y[0] + -2.4000000000000004 y[1] + -8.0 y[2] + -6.4 y[3] + -2.0
y[4] + -5.6000000000000005 y[5] + -8.0 y[6] + -7.2 y[7] + -7.6000000000000005 y[8] +
 -2.4000000000000004 y[9] + -1.0 g &lt;= -15.6
R6: -5.0 y[0] + -3.0 y[1] + -10.0 y[2] + -10.5 y[3] + -8.0 y[4] + -7.5 y[5] + -6.5 y[6]
 + -1.5 y[7] + -12.0 y[8] + -8.0 y[9] + -1.0 g &lt;= -17.5
R7: -1.2000000000000002 y[0] + -8.0 y[1] + -2.0 y[2] + -7.2 y[3] + -3.2 y[4] +
-7.6000000000000005 y[5] + -10.0 y[6] + -0.8 y[7] + -6.800000000000001 y[8] +
 -2.8000000000000003 y[9] + -1.0 g &lt;= -11.2
None
Benders optimality cut added!
--------------------------------------------------
Start solving master problem.
Minimize
3.0 y[0] + 6.0 y[1] + 8.0 y[2] + 12.0 y[3] + 3.0 y[4] + 5.0 y[5] + 4.0 y[6] + 4.0 y[7]
+ 9.0 y[8] + 3.0 y[9] + g
Subject To
R0: -8.5625 y[0] + -9.859375 y[1] + -9.5625 y[2] + -7.9375 y[3] + -12.125 y[4] +
-11.828125 y[5] + -11.21875 y[6] + -11.46875 y[7] + -10.21875 y[8] + -10.5 y[9] + -1.0 g
 &lt;= -28.1562
R1: -8.76923076923077 y[0] + -6.153846153846153 y[1] + -8.307692307692307 y[2] +
-7.692307692307692 y[3] + -2.0 y[4] + -8.923076923076923 y[5] + -6.769230769230769 y[6]
+ -8.307692307692307 y[7] + -4.153846153846153 y[8] + -6.461538461538462 y[9] + -1.0 g
 &lt;= -16.4615
R2: -10.75 y[0] + -10.124999999999998 y[1] + -11.75 y[2] + -11.5 y[3] + -8.75 y[4] +
-12.874999999999998 y[5] + -10.25 y[6] + -8.25 y[7] + -5.5 y[8] + -3.7499999999999996
 y[9] + -1.0 g &lt;= -25.5
R3: -3.0 y[0] + -8.75 y[1] + -2.75 y[2] + -10.25 y[3] + -5.5 y[4] + -10.0 y[5] + -11.5
 y[6] + -6.0 y[7] + -8.75 y[8] + -7.25 y[9] + -1.0 g &lt;= -18.25
R4: -0.8 y[0] + -5.2 y[1] + -9.200000000000001 y[2] + -3.2 y[3] + -8.8 y[4] +
-6.800000000000001 y[5] + -4.0 y[6] + -9.600000000000001 y[7] + -8.0 y[8] +
 -9.200000000000001 y[9] + -1.0 g &lt;= -18.4
R5: -7.6000000000000005 y[0] + -2.4000000000000004 y[1] + -8.0 y[2] + -6.4 y[3] + -2.0
y[4] + -5.6000000000000005 y[5] + -8.0 y[6] + -7.2 y[7] + -7.6000000000000005 y[8] +
 -2.4000000000000004 y[9] + -1.0 g &lt;= -15.6
R6: -5.0 y[0] + -3.0 y[1] + -10.0 y[2] + -10.5 y[3] + -8.0 y[4] + -7.5 y[5] + -6.5 y[6]
 + -1.5 y[7] + -12.0 y[8] + -8.0 y[9] + -1.0 g &lt;= -17.5
R7: -1.2000000000000002 y[0] + -8.0 y[1] + -2.0 y[2] + -7.2 y[3] + -3.2 y[4] +
-7.6000000000000005 y[5] + -10.0 y[6] + -0.8 y[7] + -6.800000000000001 y[8] +
 -2.8000000000000003 y[9] + -1.0 g &lt;= -11.2
None
Gurobi Optimizer version 10.0.3 build v10.0.3rc0 (mac64[arm])

CPU model: Apple M1
Thread count: 8 physical cores, 8 logical processors, using up to 8 threads

Optimize a model with 8 rows, 11 columns and 88 nonzeros
Coefficient statistics:
  Matrix range     [8e-01, 1e+01]
  Objective range  [1e+00, 1e+01]
  Bounds range     [0e+00, 0e+00]
  RHS range        [1e+01, 3e+01]
Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0    9.8201416e+00   8.763627e-02   0.000000e+00      0s
       1    9.8617265e+00   0.000000e+00   0.000000e+00      0s

Solved in 1 iterations and 0.00 seconds (0.00 work units)
Optimal objective  9.861726459e+00
    master problem is optimal.
    opt_obj=9.86
    opt_g=0.00
Finish solving master problem.
--------------------------------------------------
Bounds: lb=9.86, ub=11.22
dual subproblem objective updated!
--------------------------------------------------
Start solving dual subproblem.
    dual subproblem is optimal.
    opt_obj=0.00
Finish solving dual subproblem.
--------------------------------------------------
Bounds: lb=9.86, ub=9.86</code></pre>
</div>
</div>
<div class="cell" data-execution_count="123">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1"></a>c</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="123">
<pre><code>array([4, 5, 2, 4, 4, 5, 2, 2, 4, 3, 4, 4, 4, 4, 5, 2, 5, 5, 5, 4])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="111">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1"></a>np.random.randint(<span class="dv">1</span>, <span class="dv">5</span>, size<span class="op">=</span>(<span class="dv">2</span>, <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="111">
<pre><code>array([[4, 1, 4, 2, 2, 3, 2, 1, 4, 4],
       [4, 4, 2, 1, 1, 2, 2, 3, 4, 3]])</code></pre>
</div>
</div>
</section>
<section id="implementation-with-callbacks" class="level3" data-number="4.2.7">
<h3 data-number="4.2.7" class="anchored" data-anchor-id="implementation-with-callbacks"><span class="header-section-number">4.2.7</span> Implementation with callbacks</h3>
</section>
<section id="implementation-with-scip" class="level3" data-number="4.2.8">
<h3 data-number="4.2.8" class="anchored" data-anchor-id="implementation-with-scip"><span class="header-section-number">4.2.8</span> Implementation with SCIP</h3>
<div class="cell" data-execution_count="97">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1"></a><span class="im">from</span> pyscipopt <span class="im">import</span> Model</span>
<span id="cb43-2"><a href="#cb43-2"></a><span class="im">from</span> pyscipopt <span class="im">import</span> quicksum</span>
<span id="cb43-3"><a href="#cb43-3"></a><span class="im">from</span> pyscipopt <span class="im">import</span> SCIP_PARAMSETTING</span>
<span id="cb43-4"><a href="#cb43-4"></a></span>
<span id="cb43-5"><a href="#cb43-5"></a><span class="co"># Create a model</span></span>
<span id="cb43-6"><a href="#cb43-6"></a>model <span class="op">=</span> Model(<span class="st">"simple_lp"</span>)</span>
<span id="cb43-7"><a href="#cb43-7"></a></span>
<span id="cb43-8"><a href="#cb43-8"></a><span class="co"># Define variables</span></span>
<span id="cb43-9"><a href="#cb43-9"></a>x1 <span class="op">=</span> model.addVar(lb<span class="op">=</span><span class="dv">0</span>, vtype<span class="op">=</span><span class="st">"C"</span>, name<span class="op">=</span><span class="st">"x1"</span>)</span>
<span id="cb43-10"><a href="#cb43-10"></a>x2 <span class="op">=</span> model.addVar(lb<span class="op">=</span><span class="dv">0</span>, vtype<span class="op">=</span><span class="st">"C"</span>, name<span class="op">=</span><span class="st">"x2"</span>)</span>
<span id="cb43-11"><a href="#cb43-11"></a></span>
<span id="cb43-12"><a href="#cb43-12"></a><span class="co"># Set objective function</span></span>
<span id="cb43-13"><a href="#cb43-13"></a>model.setObjective(x1 <span class="op">+</span> x2, <span class="st">"maximize"</span>)</span>
<span id="cb43-14"><a href="#cb43-14"></a></span>
<span id="cb43-15"><a href="#cb43-15"></a><span class="co"># Add constraints</span></span>
<span id="cb43-16"><a href="#cb43-16"></a><span class="co"># model.addCons(2 * x1 + x2 &gt;= 1, "constraint1")</span></span>
<span id="cb43-17"><a href="#cb43-17"></a>model.addCons(x1 <span class="op">+</span> x2 <span class="op">&gt;=</span> <span class="dv">2</span>, <span class="st">"constraint2"</span>)</span>
<span id="cb43-18"><a href="#cb43-18"></a></span>
<span id="cb43-19"><a href="#cb43-19"></a><span class="co"># Solve the model</span></span>
<span id="cb43-20"><a href="#cb43-20"></a>model.setPresolve(SCIP_PARAMSETTING.OFF)</span>
<span id="cb43-21"><a href="#cb43-21"></a>model.setHeuristics(SCIP_PARAMSETTING.OFF)</span>
<span id="cb43-22"><a href="#cb43-22"></a>model.disablePropagation()</span>
<span id="cb43-23"><a href="#cb43-23"></a>model.optimize()</span>
<span id="cb43-24"><a href="#cb43-24"></a></span>
<span id="cb43-25"><a href="#cb43-25"></a><span class="co"># Print results</span></span>
<span id="cb43-26"><a href="#cb43-26"></a>status <span class="op">=</span> model.getStatus()</span>
<span id="cb43-27"><a href="#cb43-27"></a><span class="bu">print</span>(<span class="ss">f'status = </span><span class="sc">{</span>status<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb43-28"><a href="#cb43-28"></a><span class="cf">if</span> model.getStatus() <span class="op">==</span> <span class="st">"optimal"</span>:</span>
<span id="cb43-29"><a href="#cb43-29"></a>    <span class="bu">print</span>(<span class="st">"Optimal solution found."</span>)</span>
<span id="cb43-30"><a href="#cb43-30"></a>    <span class="bu">print</span>(<span class="ss">f"x1: </span><span class="sc">{</span>model<span class="sc">.</span>getVal(x1)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb43-31"><a href="#cb43-31"></a>    <span class="bu">print</span>(<span class="ss">f"x2: </span><span class="sc">{</span>model<span class="sc">.</span>getVal(x2)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb43-32"><a href="#cb43-32"></a>    <span class="bu">print</span>(<span class="ss">f"Objective value: </span><span class="sc">{</span>model<span class="sc">.</span>getObjVal()<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb43-33"><a href="#cb43-33"></a>    hasRay <span class="op">=</span> model.hasPrimaryRay()</span>
<span id="cb43-34"><a href="#cb43-34"></a>    <span class="bu">print</span>(hasRay)</span>
<span id="cb43-35"><a href="#cb43-35"></a><span class="cf">elif</span> model.getStatus() <span class="op">==</span> <span class="st">'unbounded'</span>:</span>
<span id="cb43-36"><a href="#cb43-36"></a>    hasRay <span class="op">=</span> model.hasPrimalRay()</span>
<span id="cb43-37"><a href="#cb43-37"></a>    <span class="bu">print</span>(<span class="ss">f'hasRay=</span><span class="sc">{</span>hasRay<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb43-38"><a href="#cb43-38"></a>    ray <span class="op">=</span> model.getPrimalRay()</span>
<span id="cb43-39"><a href="#cb43-39"></a>    <span class="bu">print</span>(<span class="ss">f'ray=</span><span class="sc">{</span>ray<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb43-40"><a href="#cb43-40"></a>    </span>
<span id="cb43-41"><a href="#cb43-41"></a><span class="cf">else</span>:</span>
<span id="cb43-42"><a href="#cb43-42"></a>    <span class="bu">print</span>(<span class="st">"Model could not be solved."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>status = unbounded
hasRay=True
ray=[0.5, 0.5]
presolving:
   (0.0s) symmetry computation started: requiring (bin +, int +, cont +), (fixed: bin -, int -, cont -)
   (0.0s) symmetry computation finished: 1 generators found (max: 1500, log10 of symmetry group size: 0.3) (symcode time: 0.00)
   (0.0s) no symmetry on binary variables present.
presolving (0 rounds: 0 fast, 0 medium, 0 exhaustive):
 0 deleted vars, 0 deleted constraints, 0 added constraints, 0 tightened bounds, 0 added holes, 0 changed sides, 0 changed coefficients
 0 implications, 0 cliques
presolved problem has 2 variables (0 bin, 0 int, 0 impl, 2 cont) and 2 constraints
      2 constraints of type &lt;linear&gt;
Presolving Time: 0.00

 time | node  | left  |LP iter|LP it/n|mem/heur|mdpt |vars |cons |rows |cuts |sepa|confs|strbr|  dualbound   | primalbound  |  gap   | compl. 
* 0.0s|     1 |     0 |     2 |     - |    LP  |   0 |   2 |   2 |   2 |   1 |  0 |   0 |   0 |      --      |      --      |   0.00%| unknown

SCIP Status        : problem is solved [unbounded]
Solving Time (sec) : 0.00
Solving Nodes      : 1
Primal Bound       : +1.00000000000000e+20 (1 solutions)
Dual Bound         : +1.00000000000000e+20
Gap                : 0.00 %</code></pre>
</div>
</div>
</section>
<section id="testing" class="level3" data-number="4.2.9">
<h3 data-number="4.2.9" class="anchored" data-anchor-id="testing"><span class="header-section-number">4.2.9</span> Testing</h3>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./env-setup.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Environment Setup</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->



</body></html>